

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Functions &mdash; Neural Network Libraries 1.0.17 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parametric Functions" href="parametric_function.html" />
    <link rel="prev" title="Variable" href="variable.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Neural Network Libraries
          

          
          </a>

          
            
            
              <div class="version">
                1.0.17
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../python.html">Python Package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Python Package Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html">Python API Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command_line_interface.html">Python Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Python API Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">Python API Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="common.html">Common</a></li>
<li class="toctree-l3"><a class="reference internal" href="nd_array.html">NdArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-nnabla.functions">List of Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parametric_function.html">Parametric Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="solver.html">Solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="communicator.html">Communicator API</a></li>
<li class="toctree-l3"><a class="reference internal" href="monitor.html">Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="ext.html">Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html">Pretrained Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="experimental.html">Experimental</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_exchange_file_format.html">Data exchange file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_format_converter/file_format_converter.html">File format converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Neural Network Libraries</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../python.html">Python Package</a> &raquo;</li>
        
          <li><a href="../api.html">Python API Reference</a> &raquo;</li>
        
      <li>Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/python/api/function.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="functions">
<span id="function"></span><h1>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h1>
<p>All NNabla functions are derived from the <a class="reference internal" href="#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.function.Function</span></code></a> class.</p>
<div class="section" id="id1">
<h2>Function<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-nnabla.function"></span><dl class="class">
<dt id="nnabla.function.Function">
<em class="property">class </em><code class="descclassname">nnabla.function.</code><code class="descname">Function</code><a class="headerlink" href="#nnabla.function.Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Function interface class.</p>
<p>Instances of <a class="reference internal" href="#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.function.Function</span></code></a> are not directly created by users. It is indirectly
created by the functions available in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a>. These functions
return <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a> (s) holding the created function instance as the
parent property.</p>
<dl class="method">
<dt id="nnabla.function.Function.backward">
<code class="descname">backward</code><span class="sig-paren">(</span><em>self</em>, <em>inputs</em>, <em>outputs</em>, <em>accum=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.backward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>self</em>, <em>inputs</em>, <em>outputs</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.grad_depends_output_data">
<code class="descname">grad_depends_output_data</code><span class="sig-paren">(</span><em>self</em>, <em>int i</em>, <em>int o</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.grad_depends_output_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="nnabla.function.Function.info">
<code class="descname">info</code><a class="headerlink" href="#nnabla.function.Function.info" title="Permalink to this definition">¶</a></dt>
<dd><p>object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">info</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.inplace_data">
<code class="descname">inplace_data</code><span class="sig-paren">(</span><em>self</em>, <em>int i</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.inplace_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.inplace_data_with">
<code class="descname">inplace_data_with</code><span class="sig-paren">(</span><em>self</em>, <em>int i</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.inplace_data_with" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.inplace_grad">
<code class="descname">inplace_grad</code><span class="sig-paren">(</span><em>self</em>, <em>int i</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.inplace_grad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.inplace_grad_with">
<code class="descname">inplace_grad_with</code><span class="sig-paren">(</span><em>self</em>, <em>int i</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.inplace_grad_with" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.min_outputs">
<code class="descname">min_outputs</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.min_outputs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nnabla.function.Function.setup">
<code class="descname">setup</code><span class="sig-paren">(</span><em>self</em>, <em>inputs</em>, <em>outputs</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.setup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="nnabla.function.Function.tags">
<code class="descname">tags</code><a class="headerlink" href="#nnabla.function.Function.tags" title="Permalink to this definition">¶</a></dt>
<dd><p>Experimental</p>
<p>Get tags of the function.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nnabla.functions">
<span id="list-of-functions"></span><span id="id2"></span><h2>List of Functions<a class="headerlink" href="#module-nnabla.functions" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> module provides various types of functions listed below.
These functions takes input <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a> (s) as its leading argument(s), followed by options
specific to each function.</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>The functions can also take <code class="xref py py-obj docutils literal notranslate"><span class="pre">NdArray</span></code> (s) as output(s) holding output values of the
operation. We call this “Imperative Mode” (NdArray + Functions).</dd>
</dl>
<div class="section" id="neural-network-layers">
<h3>Neural Network Layers<a class="headerlink" href="#neural-network-layers" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.affine">
<code class="descclassname">nnabla.functions.</code><code class="descname">affine</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Affine layer, also called as the fully connected layer. It calculates:</p>
<div class="math notranslate nohighlight">
\[{\mathbf y} = {\mathbf A} {\mathbf x} + {\mathbf b}.\]</div>
<p>where <span class="math notranslate nohighlight">\({\mathbf x}\)</span> is the input and <span class="math notranslate nohighlight">\({\mathbf y}\)</span> is the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times ... \times M_{B-1} \times D_B \times ... \times D_N\)</span>). Dimensions before and after base_axis are flattened as if it is a matrix.</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight matrix with shape (<span class="math notranslate nohighlight">\((D_B \times ... \times D_N) \times L\)</span>)
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(L\)</span>)
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Base axis of Affine operation. Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><span class="math notranslate nohighlight">\((B + 1)\)</span>-D array. (<span class="math notranslate nohighlight">\(M_0 \times ... \times M_{B-1} \times L\)</span>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.convolution">
<code class="descclassname">nnabla.functions.</code><code class="descname">convolution</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>pad=None</em>, <em>stride=None</em>, <em>dilation=None</em>, <em>group=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#convolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>N-D Convolution with bias.</p>
<p>See references for dilated convolution (a.k.a. atrous convolution).</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1606.00915">Chen et al., DeepLab: Semantic Image Segmentation with Deep Convolutional
Nets, Atrous Convolution, and Fully Connected CRFs.</a></li>
<li><a class="reference external" href="https://arxiv.org/abs/1511.07122">Yu et al., Multi-Scale Context Aggregation by Dilated Convolutions.</a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Convolution is a computationally intensive operation that
should preferrably be run with the <cite>cudnn</cite> backend. NNabla
then uses CuDNN library functions to determine and cache the
fastest algorithm for the given set of convolution parameters,
which results in additional memory consumption which may pose
a problem for GPUs with insufficient memory size. In that
case, the <cite>NNABLA_CUDNN_WORKSPACE_LIMIT</cite> environment variable
can be used to restrict the choice of algorithms to those that
fit the given workspace memory limit, expressed in bytes. In
some cases it may also be desired to restrict the automatic
search to algorithms that produce deterministic (reproducable)
results. This can be requested by setting the the environment
variable <cite>NNABLA_CUDNN_DETERMINISTIC</cite> to a non-zero value.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((2 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C' \times C \times K_1 \times ... \times K_N\)</span>).
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default=``1``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default=``(0,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i = \frac{L_i + 2 p_i - d_i (k_i - 1) - 1}{s_i} + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size, and <span class="math notranslate nohighlight">\(s_i\)</span> is the stride for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.depthwise_convolution">
<code class="descclassname">nnabla.functions.</code><code class="descname">depthwise_convolution</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>pad=None</em>, <em>stride=None</em>, <em>dilation=None</em>, <em>multiplier=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#depthwise_convolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.depthwise_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>N-D Depthwise Convolution with bias.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1610.02357">F. Chollet: Chollet, Francois. “Xception: Deep Learning with Depthwise Separable Convolutions.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C \times K_1 \times ... \times K_N\)</span>).
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C\)</span>).
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default=``1``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default=``(0,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>multiplier</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of output feature maps per input feature map.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>The output map size <span class="math notranslate nohighlight">\(C'\)</span> is <span class="math notranslate nohighlight">\(C\)</span> multiplied by <span class="math notranslate nohighlight">\(m\)</span></p>
<div class="math notranslate nohighlight">
\[C' =  m \times C,\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the multiplier.</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i = \frac{L_i + 2 p_i - d_i (k_i - 1) - 1}{s_i} + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size, and <span class="math notranslate nohighlight">\(s_i\)</span> is the stride for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.deconvolution">
<code class="descclassname">nnabla.functions.</code><code class="descname">deconvolution</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>pad=None</em>, <em>stride=None</em>, <em>dilation=None</em>, <em>group=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#deconvolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.deconvolution" title="Permalink to this definition">¶</a></dt>
<dd><p>N-D deconvolution, also known as transposed convolution, with bias operates backward convolution (derivative of the output w.r.t. the input) plus channel-wise learned bias.</p>
<p>The weights are specified in the same manner as <a class="reference internal" href="#nnabla.functions.convolution" title="nnabla.functions.convolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convolution()</span></code></a> , as if it was an ordinary convolution function.
The forward operation of <a class="reference internal" href="#nnabla.functions.deconvolution" title="nnabla.functions.deconvolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deconvolution()</span></code></a> will then be operationally equivalent to the backward pass of <a class="reference internal" href="#nnabla.functions.convolution" title="nnabla.functions.convolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convolution()</span></code></a> .
Therefore, the number of input channels (can be seen as output channels of forward convolution) is specified in the first dimension, and the number of the output channels divided by the number of groups is specified in the second dimension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((2 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C' \times C \times K_1 \times ... \times K_N\)</span>).
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default=``1``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default=``(0,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i =s_i (L_i - 1) - 2 p_i + d_i (k_i - 1) + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(s_i\)</span> is the stride, <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, and <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.depthwise_deconvolution">
<code class="descclassname">nnabla.functions.</code><code class="descname">depthwise_deconvolution</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>pad=None</em>, <em>stride=None</em>, <em>dilation=None</em>, <em>divisor=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#depthwise_deconvolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.depthwise_deconvolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Depthwise deconvolution computes the transposed depthwise convolution with bias for one-dimensional and two-dimensional input data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C \times K_1 \times ... \times K_N\)</span>).
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C\)</span>).
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default=``1``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default=``(0,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>divisor</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of input feature maps per output feature map.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>The output map size <span class="math notranslate nohighlight">\(C'\)</span> is <span class="math notranslate nohighlight">\(C\)</span> multiplied by <span class="math notranslate nohighlight">\(m\)</span></p>
<div class="math notranslate nohighlight">
\[C' =  \frac{C}{d},\]</div>
<p>where <span class="math notranslate nohighlight">\(d\)</span> is the divisor.</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i =s_i (L_i - 1) - 2 p_i + d_i (k_i - 1) + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(s_i\)</span> is the stride, <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, and <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.max_pooling">
<code class="descclassname">nnabla.functions.</code><code class="descname">max_pooling</code><span class="sig-paren">(</span><em>x</em>, <em>kernel</em>, <em>stride=None</em>, <em>ignore_border=True</em>, <em>pad=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#max_pooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.max_pooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Max pooling. It pools the maximum values inside the scanning kernel:</p>
<div class="math notranslate nohighlight">
\[y_{i_1, i_2} = \max_{k_1, k_2 \in K} (x_{i_1 + k_1, i_2 + k_2})\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i_1 + k_1, i_2 + k_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{i_1, i_2}\)</span> is the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</li>
<li><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Subsampling factors for each spatial axis.
[default=``kernel``]</li>
<li><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If false, kernels covering borders are also considered for the output.
[default=``True``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default=``(0,) * len(kernel)``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Maximum values variable</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.average_pooling">
<code class="descclassname">nnabla.functions.</code><code class="descname">average_pooling</code><span class="sig-paren">(</span><em>x</em>, <em>kernel</em>, <em>stride=None</em>, <em>ignore_border=True</em>, <em>pad=None</em>, <em>including_pad=True</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#average_pooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.average_pooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Average pooling. It pools the averaged values inside the scanning kernel:</p>
<div class="math notranslate nohighlight">
\[y_{i_1, i_2} = \frac{1}{K_1 K_2} \sum_{k1} \sum_{k2} x_{i_1 + k_1, i_2 + k_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i_1 + k_1, i_2 + k_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{i_1, i_2}\)</span> is the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</li>
<li><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Subsampling factors for each spatial axis.
[default=``kernel``]</li>
<li><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If false, kernels covering borders are also considered for the output.
[default=``True``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default=``(0,) * len(kernel)``]</li>
<li><strong>including_pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, border padding values are considered for the output.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Average values variable</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.global_average_pooling">
<code class="descclassname">nnabla.functions.</code><code class="descname">global_average_pooling</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#global_average_pooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.global_average_pooling" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function is experimental support, so please do not actively use it.</p>
</div>
<p>Global average pooling. It pools an averaged value from the whole image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Average values variable</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sum_pooling">
<code class="descclassname">nnabla.functions.</code><code class="descname">sum_pooling</code><span class="sig-paren">(</span><em>x</em>, <em>kernel</em>, <em>stride=None</em>, <em>ignore_border=True</em>, <em>pad=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sum_pooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sum_pooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum pooling. It pools the summed values inside the scanning kernel:</p>
<div class="math notranslate nohighlight">
\[y_{i_1, i_2} = \sum_{k1} \sum_{k2} x_{i_1 + k_1, i_2 + k_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i_1 + k_1, i_2 + k_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{i_1, i_2}\)</span> is the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</li>
<li><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Subsampling factors for each spatial axis.
[default=``kernel``]</li>
<li><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If false, kernels covering borders are also considered for the output.
[default=``True``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default=``(0,) * len(kernel)``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Summed values variable</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.unpooling">
<code class="descclassname">nnabla.functions.</code><code class="descname">unpooling</code><span class="sig-paren">(</span><em>x</em>, <em>kernel</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#unpooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.unpooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse operation of pooling. It spreads the input values:</p>
<div class="math notranslate nohighlight">
\[y_{k_1 i_1 + j_1, k_2 i_2 + j_2} = x_{i_1, i_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(_{i_1, i_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{k_1 i_1 + j_1, k_2 i_2 + j_2}\)</span> is the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</li>
<li><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Spread values variable</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.embed">
<code class="descclassname">nnabla.functions.</code><code class="descname">embed</code><span class="sig-paren">(</span><em>x0</em>, <em>w</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#embed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.embed" title="Permalink to this definition">¶</a></dt>
<dd><p>Embed slices of a matrix/tensor with indexing array/tensor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Indices with shape <span class="math notranslate nohighlight">\((I_0, ..., I_N)\)</span></li>
<li><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weights with shape <span class="math notranslate nohighlight">\((W_0, ..., W_M)\)</span>
[parameter]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output with shape <span class="math notranslate nohighlight">\((I_0, ..., I_N, W_1, ..., W_M)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.rnn">
<code class="descclassname">nnabla.functions.</code><code class="descname">rnn</code><span class="sig-paren">(</span><em>x</em>, <em>h</em>, <em>weight_l0</em>, <em>weight=None</em>, <em>bias=None</em>, <em>num_layers=1</em>, <em>nonlinearity=None</em>, <em>dropout=None</em>, <em>bidirectional=False</em>, <em>training=True</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rnn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.rnn" title="Permalink to this definition">¶</a></dt>
<dd><p>RNN function implements Elman RNN with nonlineraity to input sequence.
RNN function is defined as following:</p>
<div class="math notranslate nohighlight">
\[{\mathbf h_t} = {\mathbf \tanh}( {\mathbf w_{ih}} *{\mathbf x_t} + {\mathbf b_{ih}} + {\mathbf w_{hh}}* {\mathbf h_{(t-1)}} + {\mathbf b_{hh}}).\]</div>
<p>We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(T\)</span>: sequcne length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(I\)</span>: input size, <span class="math notranslate nohighlight">\(L\)</span>: number of layers, <span class="math notranslate nohighlight">\(D\)</span>: number of directions, can be either 1 or 2, <span class="math notranslate nohighlight">\(H\)</span>: hidden size.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://crl.ucsd.edu/~elman/Papers/fsit.pdf">Jeffrey Elman, Finding Structure in Time.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((T, B, I)\)</span>.</li>
<li><strong>h</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</li>
<li><strong>weight_l0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((D, H, I + H)\)</span>.
[parameter]</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L-1, D, H, D * H + H)\)</span>.
[optional][parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, H)\)</span>.
[optional][parameter]</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of layers in the network. If set to 1, only the weights for the first layer will be invoked. Default is 1.
[default=``1``]</li>
<li><strong>nonlinearity</strong> (<em>string</em>) – Type of nonlinearity applied to input sequcne. Must be either tanh or relu. Default is tanh.
[default=``tanh``]</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Dropout ratio applied to parameters. Default is 0.0.
[default=``0.0``]</li>
<li><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, bidirectional computation will be performed in each layer. Default is False.
[default=``False``]</li>
<li><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Backpropagation will be performed only when it is true. Default is True.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((T, B, D * H)\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.lstm">
<code class="descclassname">nnabla.functions.</code><code class="descname">lstm</code><span class="sig-paren">(</span><em>x</em>, <em>h</em>, <em>c</em>, <em>weight_l0</em>, <em>weight=None</em>, <em>bias=None</em>, <em>num_layers=1</em>, <em>dropout=None</em>, <em>bidirectional=False</em>, <em>training=True</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#lstm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.lstm" title="Permalink to this definition">¶</a></dt>
<dd><p>N-Step LSTM layer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\mathbf f_t} = {\mathbf \sigma}( {\mathbf W_f} *{\mathbf x_t} + {\mathbf U_f}* {\mathbf h_{(t-1)}} + {\mathbf b_f})\\
{\mathbf i_t} = {\mathbf \sigma}( {\mathbf W_i} *{\mathbf x_t} + {\mathbf U_i}* {\mathbf h_{(t-1)}} + {\mathbf b_i})\\
{\mathbf o_t} = {\mathbf \sigma}( {\mathbf W_o} *{\mathbf x_t} + {\mathbf U_o}* {\mathbf h_{(t-1)}} + {\mathbf b_o})\\
{\mathbf c_t} = {\mathbf f_t}\odot {mathbf c_{(t-1)}} + {\mathbf i_t}\odot {\mathbf \tanh}({\mathbf W_c}*{\mathbf x_t} + {\mathbf U_c} *{\mathbf h_{(t-1)}} + {\mathbf b_c})\\
{\mathbf h_t} = {\mathbf o_t} \odot {\mathbf \tanh}({\mathbf c_t}).\end{split}\]</div>
<p>We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(T\)</span>: sequcne length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(I\)</span>: input size, <span class="math notranslate nohighlight">\(L\)</span>: number of layers, <span class="math notranslate nohighlight">\(D\)</span>: number of directions, can be either 1 or 2, <span class="math notranslate nohighlight">\(H\)</span>: hidden size.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://www.bioinf.jku.at/publications/older/2604.pdf">S. Hochreiter and J. Schmidhuber, Long Short-Term Memory.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((T, B, I)\)</span>.</li>
<li><strong>h</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</li>
<li><strong>c</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</li>
<li><strong>weight_l0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the first layer. Shape is <span class="math notranslate nohighlight">\((D, 4, H, I + H)\)</span>.
[parameter]</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the second layer and above. Shape is <span class="math notranslate nohighlight">\((L-1, D, 4, H, D * H + H)\)</span>.
[optional][parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(L\)</span>). Shape is <span class="math notranslate nohighlight">\((L, D, 4, H)\)</span>.
[optional][parameter]</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of layers in the network. If set to 1, only the weights for the first layer will be invoked. Default is 1.
[default=``1``]</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Dropout ratio applied to parameters. Default is 0.0.
[default=``0.0``]</li>
<li><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, bidirecitonal computation will be performed in each layer. Default is False.
[default=``False``]</li>
<li><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Backpropagation will be performed only when it is True. Default is True.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((T, B, D * H)\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(c_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.gru">
<code class="descclassname">nnabla.functions.</code><code class="descname">gru</code><span class="sig-paren">(</span><em>x</em>, <em>h</em>, <em>weight_l0</em>, <em>weight=None</em>, <em>bias=None</em>, <em>num_layers=1</em>, <em>dropout=None</em>, <em>bidirectional=False</em>, <em>training=True</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#gru"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.gru" title="Permalink to this definition">¶</a></dt>
<dd><p>N-Step GRU layer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\mathbf r_t} = {\mathbf \sigma}( {\mathbf W_r} *{\mathbf x_t} + {\mathbf U_r}* {\mathbf h_{(t-1)}} + {\mathbf b_r})\\
  {\mathbf z_t} = {\mathbf \sigma}( {\mathbf W_z} *{\mathbf x_t} + {\mathbf U_z}* {\mathbf h_{(t-1)}} + {\mathbf b_z})\\
{\mathbf n_t} = {\mathbf \tanh}( {\mathbf W_n}{\mathbf x_t}+ {\mathbf b_{in}}+ {\mathbf r_n}( {\mathbf U_n}{\mathbf h_{t-1}}+ {\mathbf b_{hn}})) \\
{\mathbf h_t} = (1- {\mathbf z_t})\odot {\mathbf n_t} + {\mathbf z_t}{\mathbf h_{t-1}}.\end{split}\]</div>
<p>We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(T\)</span>: sequcne length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(I\)</span>: input size, <span class="math notranslate nohighlight">\(L\)</span>: number of layers, <span class="math notranslate nohighlight">\(D\)</span>: number of directions, can be either 1 or 2, <span class="math notranslate nohighlight">\(H\)</span>: hidden size.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://www.aclweb.org/anthology/D14-1179">K. cho et al., Learning Phrases Representations using RNN Encoder-Decoder for Statistical Machine Translation.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((T, B, I)\)</span>.</li>
<li><strong>h</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</li>
<li><strong>weight_l0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the first layer. Shape is <span class="math notranslate nohighlight">\((D, 3, H, I + H)\)</span>.
[parameter]</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the second layer and above. Shape is <span class="math notranslate nohighlight">\((L-1, D, 3, H, D * H + H)\)</span>.
[optional][parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(L\)</span>). Shape is <span class="math notranslate nohighlight">\((L, D, 4, H)\)</span>.
[optional][parameter]</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of layers in the network. If set to 1, only the weights for the first layer will be invoked. Default is 1.
[default=``1``]</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Dropout ratio applied to parameters. Default is 0.0.
[default=``0.0``]</li>
<li><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, bidirecitonal computation will be performed in each layer. Default is False.
[default=``False``]</li>
<li><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Backpropagation will be performed only when it is True. Default is True.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((T, B, D * H)\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="neural-network-activation">
<h3>Neural Network Activation<a class="headerlink" href="#neural-network-activation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.sigmoid">
<code class="descclassname">nnabla.functions.</code><code class="descname">sigmoid</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise sigmoid function.</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{1}{1 + \exp(-x)},\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Output</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.swish">
<code class="descclassname">nnabla.functions.</code><code class="descname">swish</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#swish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.swish" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise swish function, by Ramachandran et al. (2017).</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{x_i}{1 + \exp(-x_i)},\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1710.05941">Prajit Ramachandran, Barret Zoph, and Quoc V. Le, Swish: a Self-Gated Activation Function, arXiv:1710.05941 [cs.NE]</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Output</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.tanh">
<code class="descclassname">nnabla.functions.</code><code class="descname">tanh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tanh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise hyperbolic tangent (tanh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \tanh (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.relu">
<code class="descclassname">nnabla.functions.</code><code class="descname">relu</code><span class="sig-paren">(</span><em>x</em>, <em>inplace=False</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#relu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.relu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Rectified Linear Unit (ReLU) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \max (0, x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – The output array is shared with the input array if True.
[default=``False``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.softmax">
<code class="descclassname">nnabla.functions.</code><code class="descname">softmax</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Softmax normalization. Calculates</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{\exp(x_i)}{\sum_j \exp(x_j)}\]</div>
<p>along the dimension specified by <cite>axis</cite>, where <span class="math notranslate nohighlight">\(y_i\)</span> is the input and <span class="math notranslate nohighlight">\(x_i\)</span> is the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default=``len(x.shape) - 1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.elu">
<code class="descclassname">nnabla.functions.</code><code class="descname">elu</code><span class="sig-paren">(</span><em>x</em>, <em>alpha=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#elu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.elu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Exponential Linear Unit (ELU) function.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \left\{
\begin{array}{ll}
x_i &amp; (x &gt; 0)\\
\alpha (\exp(x_i) - 1) &amp; (x \leq 0)
\end{array} \right..\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://arxiv.org/abs/1511.07289">Clevart et al., Fast and Accurate Deep Network Learning by Exponential Linear Units (ELUs).</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Coefficient for negative outputs. <span class="math notranslate nohighlight">\(\alpha\)</span> in definition
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.selu">
<code class="descclassname">nnabla.functions.</code><code class="descname">selu</code><span class="sig-paren">(</span><em>x</em>, <em>scale=1.05070098735548</em>, <em>alpha=1.673263242354377</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#selu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.selu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Scaled Exponential Linear Unit (SELU) function by Klambauer et al. (2017).</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \lambda \left\{
\begin{array}{ll}
x_i &amp; (x &gt; 0)\\
\alpha (\exp(x_i) - 1) &amp; (x \leq 0)
\end{array} \right..\end{split}\]</div>
<p>The coefficients <span class="math notranslate nohighlight">\(\lambda\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> default to the following values <span class="math notranslate nohighlight">\(\lambda_{01}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{01}\)</span>, respectively, provided by Klambauer et al. (2017):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
  \lambda_{01} &amp;=&amp;  \left(  1 - \operatorname{erfc}\left( \frac{1}{\sqrt{2}} \right) \sqrt{e}  \right)
              \sqrt{2 \pi} \\
             &amp;&amp; \left(
                  2 \operatorname{erfc} \left( \sqrt{2} \right) e^2
                  + \pi \operatorname{erfc}\left( \frac{1}{\sqrt{2}} \right)^2 e
                  \right. \\
             &amp;&amp; \left.
                  - 2(2 + \pi) \operatorname{erfc} \left( \frac{1}{\sqrt{2}} \right) \sqrt{e}
                  + \pi + 2
             \right)^{-1/2}  \\
          &amp;\approx&amp; 1.0507 \\
  \alpha_{01} &amp;=&amp;  - \frac
                {\sqrt {\frac {2}{\pi}}}
                {\operatorname{erfc} \left( \frac{1}{\sqrt{2}} \right) \exp \left(\frac {1} {2} \right) - 1} \\
          &amp;\approx&amp; 1.67326
\end{array}\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1706.02515">Klambauer, G., Unterthiner, T., Mayr, A., &amp; Hochreiter, S. (2017).
Self-Normalizing Neural Networks. In Advances in Neural Information
Processing Systems (NIPS).</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The coefficient <span class="math notranslate nohighlight">\(\lambda\)</span> in the definition.
[default=``1.05070098735548``]</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The coefficient <span class="math notranslate nohighlight">\(\alpha\)</span> in the definition.
[default=``1.673263242354377``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.crelu">
<code class="descclassname">nnabla.functions.</code><code class="descname">crelu</code><span class="sig-paren">(</span><em>x</em>, <em>axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#crelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.crelu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Concatenated Rectified Linear Unit (CReLU) function.
This function calculates the ReLU of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(-x\)</span> , then concatenates the results together at a specified axis,
and returns the resulting array.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1603.05201">Wenling Shang, Kihyuk Sohn, Diogo Almeida, Honglak Lee.
Understanding and Improving Convolutional Neural Networks
via Concatenated Rectified Linear Units.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The ReLU activations of positive inputs and negative inputs are concatenated at axis.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array where axis dimension is doubled by concatenating.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.celu">
<code class="descclassname">nnabla.functions.</code><code class="descname">celu</code><span class="sig-paren">(</span><em>x</em>, <em>alpha=1.0</em>, <em>axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#celu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.celu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Concatenated Exponential Linear Unit (CELU) function.
Concatenates ELU outputs of positive and negative inputs together at specified axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Coefficient for negative outputs. <span class="math notranslate nohighlight">\(\alpha\)</span> in definition.
[default=``1.0``]</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The ELU activations of positive inputs and negative inputs are concatenated at axis.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array where axis dimension is doubled by concatenating.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.gelu">
<code class="descclassname">nnabla.functions.</code><code class="descname">gelu</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#gelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.gelu" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian Error Unit (GELU) function.</p>
<div class="math notranslate nohighlight">
\[GELU(x) = xP(X \leq  x) = x \Phi (x)\]</div>
<p>which is approximated by</p>
<div class="math notranslate nohighlight">
\[GELU(x) = 0.5x (1 + \tanh ( \sqrt(2/\pi)(x + 0.044715x^3) ))\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1606.08415">Dan Hendrycks and Kevin Gimpel.
Gaussian Error Linera Units (GELUs).</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.prelu">
<code class="descclassname">nnabla.functions.</code><code class="descname">prelu</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>base_axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#prelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.prelu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Parametrized Rectified Linear Unit function. Calculates:</p>
<div class="math notranslate nohighlight">
\[y_i = \max(0, x_i) + w_i \min(0, -x_i)\]</div>
<p>where negative slope <span class="math notranslate nohighlight">\(w\)</span> is learned and can vary across channels (an
axis specified with <cite>base_axis</cite>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – (N-D array) Input</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – (N-D array) Weights</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.leaky_relu">
<code class="descclassname">nnabla.functions.</code><code class="descname">leaky_relu</code><span class="sig-paren">(</span><em>x</em>, <em>alpha=0.1</em>, <em>inplace=False</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#leaky_relu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.leaky_relu" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Leaky Rectified Linear Unit (ReLU) function.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[y_i = \alpha * \min(0, x_i) + \max (0, x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The slope value multiplied to negative numbers. <span class="math notranslate nohighlight">\(\alpha\)</span> in the definition.
[default=``0.1``]</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – The output array is shared with the input array if True.
[default=``False``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.relu6">
<code class="descclassname">nnabla.functions.</code><code class="descname">relu6</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#relu6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.relu6" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise ReLU6 function.
Capping ReLU activation to 6 is often observed to learn sparse features earlier.</p>
<div class="math notranslate nohighlight">
\[ReLU6(x) = \min(\max(0,x,),6)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.hard_sigmoid">
<code class="descclassname">nnabla.functions.</code><code class="descname">hard_sigmoid</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#hard_sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.hard_sigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment-wise linear approximation of sigmoid.
Preferable when speed of computation is more important than precision.
Returns <span class="math notranslate nohighlight">\(0\)</span> if <span class="math notranslate nohighlight">\(x &lt; -2.5\)</span>.
Returns <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(x&gt; 2.5\)</span>.
Returns <span class="math notranslate nohighlight">\(0.2x + 0.5\)</span> if <span class="math notranslate nohighlight">\(-2.5 &lt;= x &lt;= 2.5\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.hard_tanh">
<code class="descclassname">nnabla.functions.</code><code class="descname">hard_tanh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#hard_tanh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.hard_tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise HardTanh function.
Computationally cheaper than Tanh function.
Returns <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(x &gt; 1\)</span>.
Returns <span class="math notranslate nohighlight">\(-1\)</span> if <span class="math notranslate nohighlight">\(x &lt; -1\)</span>.
Returns <span class="math notranslate nohighlight">\(x\)</span> otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.log_sigmoid">
<code class="descclassname">nnabla.functions.</code><code class="descname">log_sigmoid</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#log_sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.log_sigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise LogSigmoid function.</p>
<div class="math notranslate nohighlight">
\[LogSigmoid(x) = \log(1/(1+\exp(-x_i)))\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.softplus">
<code class="descclassname">nnabla.functions.</code><code class="descname">softplus</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softplus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.softplus" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise SoftPlus function.
Unlike Sigmoid and Tanh that have upper and lower bound, SoftPlus is only lower-bounded by 0.</p>
<div class="math notranslate nohighlight">
\[SoftPlus(x) = \log(1+\exp(x_i))\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.softsign">
<code class="descclassname">nnabla.functions.</code><code class="descname">softsign</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softsign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.softsign" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise SoftSign.
Can be used in place of Tanh function.
While Tanh converges exponentially, SoftSign converges polynomially.</p>
<div class="math notranslate nohighlight">
\[SoftSign(x) = x/(1+|x|)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.tanh_shrink">
<code class="descclassname">nnabla.functions.</code><code class="descname">tanh_shrink</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tanh_shrink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.tanh_shrink" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wies TanhShrink function.</p>
<div class="math notranslate nohighlight">
\[TanhShrink(x) = x - \tanh(x)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sinc">
<code class="descclassname">nnabla.functions.</code><code class="descname">sinc</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sinc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sinc" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Sinc function.
Unlike other popular activation functions, it has rises and falls.
returns <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(x = 0\)</span>.
returns <span class="math notranslate nohighlight">\(\sin(x)/x\)</span> otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="normalization">
<h3>Normalization<a class="headerlink" href="#normalization" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.batch_normalization">
<code class="descclassname">nnabla.functions.</code><code class="descname">batch_normalization</code><span class="sig-paren">(</span><em>x, beta, gamma, mean, variance, axes=[1], decay_rate=0.9, eps=1e-05, batch_stat=True, output_stat=False, n_outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#batch_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.batch_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch normalization.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu &amp;=&amp; \frac{1}{M} \sum x_i \\
  \sigma^2 &amp;=&amp; \frac{1}{M} \sum \left(x_i - \mu\right)^2 \\
  \hat{x}_i &amp;=&amp; \frac{x_i - \mu}{\sqrt{\sigma^2 + \epsilon}} \\
  y_i &amp;=&amp; \hat{x}_i \gamma + \beta.
\end{eqnarray}\end{split}\]</div>
<p>At testing time, the mean and variance values used are those that were computed during training by moving average.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1502.03167">Ioffe and Szegedy, Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</li>
<li><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of beta which is learned.</li>
<li><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of gamma which is learned.</li>
<li><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running mean (modified during forward execution).</li>
<li><strong>variance</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running variance (modified during forward execution).</li>
<li><strong>axes</strong> (<em>repeated int64</em>) – Axes mean and variance are taken.</li>
<li><strong>decay_rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Decay rate of running mean and variance.</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</li>
<li><strong>batch_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use mini-batch statistics rather than running ones.</li>
<li><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – It true, the batch statistics of mean and variance,
will be returned as Variables. They are also differentiable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Returns batch normalization output as <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">output_stat=True</span></code>, it also returns the mean and variance
of the mini-batch</p>
<ul class="simple">
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Output of the batch normalization</li>
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <a href="#id3"><span class="problematic" id="id4">``</span></a>output_stat=True`)</li>
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Variance (if <a href="#id5"><span class="problematic" id="id6">``</span></a>output_stat=True`)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.batch_normalization</span></code>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sync_batch_normalization">
<code class="descclassname">nnabla.functions.</code><code class="descname">sync_batch_normalization</code><span class="sig-paren">(</span><em>x, beta, gamma, mean, variance, comm, group='world', axes=[1], decay_rate=0.9, eps=1e-05, batch_stat=True, output_stat=False, n_outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#sync_batch_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sync_batch_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Synchronized batch normalization.</p>
<p>For some tasks (e.g., semantic segmentation), batch size will be too small and BatchNormalization layer might not work well.
SyncBatchNorlization layer solves these problems by synchronizing batch stats (mean and var) between multiple processes.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu &amp;=&amp; \frac{1}{M} \sum x_i \\
  \sigma^2 &amp;=&amp; \frac{1}{M} \left(\sum x_i - \mu\right)^2 \\
  \hat{x}_i &amp;=&amp; \frac{x_i - \mu}{\sqrt{\sigma^2 + \epsilon}} \\
  y_i &amp;=&amp; \hat{x}_i \gamma + \beta.
\end{eqnarray}\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li>Implementing Synchronized Multi-GPU Batch Normalization <a class="reference external" href="https://hangzhang.org/PyTorch-Encoding/notes/syncbn.html">https://hangzhang.org/PyTorch-Encoding/notes/syncbn.html</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</li>
<li><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of beta which is learned.</li>
<li><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of gamma which is learned.</li>
<li><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running mean (modified during forward execution).</li>
<li><strong>variance</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running variance (modified during forward execution).</li>
<li><strong>comm</strong> (<a class="reference internal" href="communicator.html#nnabla.communicators.Communicator" title="nnabla.communicators.Communicator"><em>Communicator</em></a>) – The communicator</li>
<li><strong>group</strong> (<em>string</em>) – The name of the communicator group</li>
<li><strong>axes</strong> (<em>repeated int64</em>) – Axes mean and variance are taken.</li>
<li><strong>decay_rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Decay rate of running mean and variance.</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</li>
<li><strong>batch_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use mini-batch statistics rather than running ones.</li>
<li><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – It true, the batch statistics of mean and variance,
will be returned as Variables. They are also differentiable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Returns batch normalization output as <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">output_stat=True</span></code>, it also returns the mean and variance
of the mini-batch</p>
<ul class="simple">
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Output of the batch normalization</li>
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <a href="#id7"><span class="problematic" id="id8">``</span></a>output_stat=True`)</li>
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Variance (if <a href="#id9"><span class="problematic" id="id10">``</span></a>output_stat=True`)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.batch_normalization</span></code>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.mean_subtraction">
<code class="descclassname">nnabla.functions.</code><code class="descname">mean_subtraction</code><span class="sig-paren">(</span><em>x</em>, <em>mean</em>, <em>t</em>, <em>base_axis=1</em>, <em>update_running_mean=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#mean_subtraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.mean_subtraction" title="Permalink to this definition">¶</a></dt>
<dd><p>It subtracts the mean of the elements of the input array,
and normalizes it to <span class="math notranslate nohighlight">\(0\)</span>. Preprocessing arrays with this function has the effect of improving accuracy
in various tasks such as image classification.</p>
<p>At training time, this function is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu &amp;=&amp; \frac{1}{M} \sum x_i \\
  y_i &amp;=&amp; x_i - \mu
\end{eqnarray}\end{split}\]</div>
<p>At testing time, the mean values used are those that were computed during training by moving average.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The backward performs an approximated differentiation that takes into account only the latest mini-batch.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</li>
<li><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running mean (modified during forward execution).</li>
<li><strong>t</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Scalar of num of iteration of running mean (modified during forward execution).</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Base axis of Mean Subtraction operation. Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
<li><strong>update_running_mean</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Update running mean during forward execution.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.mean_subtraction</span></code>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.clip_by_value">
<code class="descclassname">nnabla.functions.</code><code class="descname">clip_by_value</code><span class="sig-paren">(</span><em>x</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#clip_by_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.clip_by_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip inputs by values.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y = \begin{cases}
        max &amp; (x &gt; max) \\
        x &amp; (otherwise) \\
        min &amp; (x &lt; min)
    \end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>min</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A min variable by which <cite>x</cite> is clipped. Note that the shape of <cite>min</cite> must be the same as <cite>x</cite>’s.</li>
<li><strong>max</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A max variable by which <cite>x</cite> is clipped. Note that the shape of <cite>max</cite> must be the same as <cite>x</cite>’s</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.clip_grad_by_value">
<code class="descclassname">nnabla.functions.</code><code class="descname">clip_grad_by_value</code><span class="sig-paren">(</span><em>x</em>, <em>min</em>, <em>max</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#clip_grad_by_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.clip_grad_by_value" title="Permalink to this definition">¶</a></dt>
<dd><p>In forward pass, the function behaves as the identity.</p>
<p>In backward pass,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}g_x = \begin{cases}
    max &amp; (g_y &gt; max) \\
    g_y &amp; (otherwise) \\
    min &amp; (g_y &lt; min)
   \end{cases}.\end{split}\]</div>
</div></blockquote>
<p>A typical case for use is to prevent the gradient explosion through a whole computational graph.
For example, if you want to clip gradient values for each feature map,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="nb">min</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="nb">max</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">clip_grad_by_value</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="nb">max</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</li>
<li><strong>min</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of minimum input value by which the gradients of the <cite>y</cite> are clipped. Note that the shape of <cite>min</cite> must be the same as <cite>x</cite>’s and the backward to <cite>min</cite> is not performed.</li>
<li><strong>max</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of maximum input value by which the gradients of the <cite>y</cite> are clipped. Note that the shape of <cite>max</cite> must be the same as <cite>x</cite>’s and the backward to <cite>max</cite> is not performed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.clip_by_norm">
<code class="descclassname">nnabla.functions.</code><code class="descname">clip_by_norm</code><span class="sig-paren">(</span><em>x</em>, <em>clip_norm</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#clip_by_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.clip_by_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip inputs by its L2 norm when the L2 norm is larger than the threshold value (defined by clip_norm).
If it is less than the threshold, inputs are not modified. If it is applied, the operation is represented as</p>
<div class="math notranslate nohighlight">
\[y = N \times \frac{x}{\|x\|_2}.\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> is the input, <span class="math notranslate nohighlight">\(y\)</span> is the output,
and <span class="math notranslate nohighlight">\(N\)</span> is <cite>clip_norm</cite>. this is the case that <cite>axes</cite> is not set.
When <cite>axes</cite> is set, the norm is computed over <cite>axes</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>clip_norm</strong> (<cite>Variable</cite> or <cite>float</cite>) – An input scalar variable or float value. Must be positive.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>tuple of ints</em>) – Axis or axes along which the reduction is performed. Passing the default value <cite>None</cite> will reduce all dimensions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.clip_grad_by_norm">
<code class="descclassname">nnabla.functions.</code><code class="descname">clip_grad_by_norm</code><span class="sig-paren">(</span><em>x</em>, <em>clip_norm=None</em>, <em>axes=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#clip_grad_by_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.clip_grad_by_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>In the forward pass, the function behaves like the identity.</p>
<p>In the backward pass,</p>
<div class="math notranslate nohighlight">
\[g_x = N \times \frac{g_y}{\|g_y\|_2}.\]</div>
<p>where <span class="math notranslate nohighlight">\(g_x\)</span> is the gradient w.r.t the input, <span class="math notranslate nohighlight">\(g_y\)</span> is the gradient w.r.t. the output,
and <span class="math notranslate nohighlight">\(N\)</span> is <cite>clip_norm</cite> where the norm of <span class="math notranslate nohighlight">\(g_y\)</span> becomes. this is the case that <cite>axes</cite> is not set.
When <cite>axes</cite> is set, the norm is computed over <cite>axes</cite>.</p>
<p>A typical case for use is to prevent the gradient explosion through a whole computational graph.
For example, if you want to normalize gradient values over feature axis,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">clip_grad_by_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">))</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</li>
<li><strong>clip_norm</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Clip to the norm of input to <cite>clip_norm</cite> in the backward pass.
[default=``1.0``]</li>
<li><strong>axes</strong> (<em>repeated int64</em>) – Axes to be reduced. If empty list is given, all dimensions are reduced to scalar. This is used in the forward pass.
[default=``range(x.ndim)``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="reduction">
<h3>Reduction<a class="headerlink" href="#reduction" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.sum">
<code class="descclassname">nnabla.functions.</code><code class="descname">sum</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em>, <em>keepdims=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction along axes with sum operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>tuple of ints</em>) – Axis or axes along which the sum is
calculated. Passing the default value <cite>None</cite> will reduce all dimensions.</li>
<li><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.mean">
<code class="descclassname">nnabla.functions.</code><code class="descname">mean</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em>, <em>keepdims=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction along axes with mean operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>tuple of ints</em>) – Axis or axes along which mean is
calculated. Passing the default value <cite>None</cite> will reduce all dimensions.</li>
<li><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.max">
<code class="descclassname">nnabla.functions.</code><code class="descname">max</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em>, <em>keepdims=False</em>, <em>with_index=False</em>, <em>only_index=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the input N-D array <cite>x</cite> along the given <cite>axis</cite> using the max
operation. The <cite>axis</cite> argument may be a single integer to reduce
over one axis, a tuple of integers to reduce over multiple axes,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> to reduce over all axes. If <cite>keepdims</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the output will keep all reduced dimensions with size 1. If
<cite>with_index</cite> is True, result is a tuple <code class="docutils literal notranslate"><span class="pre">(sorted,</span> <span class="pre">indices)</span></code> or
only <code class="docutils literal notranslate"><span class="pre">indices</span></code> if <cite>only_index</cite> is True. Setting <cite>only_index</cite> to
True implies that <cite>with_index</cite> is also True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">maxval</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">maxval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">maxval</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">maxval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">only_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>tuple of ints</em>) – Axis or axes along which max is
calculated. The default value <cite>None</cite> will reduce all dimensions.</li>
<li><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Keep reduced axes as dimension with 1 element.</li>
<li><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return tuple of max values and index.</li>
<li><strong>only_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return only the index of max values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.min">
<code class="descclassname">nnabla.functions.</code><code class="descname">min</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em>, <em>keepdims=False</em>, <em>with_index=False</em>, <em>only_index=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the input N-D array <cite>x</cite> along the given <cite>axis</cite> using the min
operation. The <cite>axis</cite> argument may be a single integer to reduce
over one axis, a tuple of integers to reduce over multiple axes,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> to reduce over all axes. If <cite>keepdims</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the output will keep all reduced dimensions with size 1. If
<cite>with_index</cite> is True, result is a tuple <code class="docutils literal notranslate"><span class="pre">(sorted,</span> <span class="pre">indices)</span></code> or
only <code class="docutils literal notranslate"><span class="pre">indices</span></code> if <cite>only_index</cite> is True. Setting <cite>only_index</cite> to
True implies that <cite>with_index</cite> is also True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">minval</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">minval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">minval</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">minval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">only_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>tuple of ints</em>) – Axis or axes along which min is
calculated. The default value <cite>None</cite> will reduce all dimensions.</li>
<li><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Keep reduced axes as dimension with 1 element.</li>
<li><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return tuple of min values and index.</li>
<li><strong>only_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return only the index of min values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.prod">
<code class="descclassname">nnabla.functions.</code><code class="descname">prod</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em>, <em>keepdims=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#prod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.prod" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction along axes with product operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>tuple of ints</em>) – Axis or axes along which product is
calculated. Passing the default value <cite>None</cite> will reduce all dimensions.</li>
<li><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Backward computation is not accurate in a zero value input.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.reduce_sum">
<code class="descclassname">nnabla.functions.</code><code class="descname">reduce_sum</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reduce_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.reduce_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction along an axis with sum operation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is deprecated. Use <code class="docutils literal notranslate"><span class="pre">sum</span></code> instead.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.reduce_mean">
<code class="descclassname">nnabla.functions.</code><code class="descname">reduce_mean</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reduce_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.reduce_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction by mean along an axis.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is deprecated. Use <code class="docutils literal notranslate"><span class="pre">mean</span></code> instead.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="arithmetic">
<h3>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.add2">
<code class="descclassname">nnabla.functions.</code><code class="descname">add2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>inplace=False</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#add2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.add2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise addition.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i + x^{(1)}_i\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – The output array is shared with the 1st input array if True.
[default=``False``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sub2">
<code class="descclassname">nnabla.functions.</code><code class="descname">sub2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sub2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sub2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise subtraction.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i - x^{(1)}_i\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.mul2">
<code class="descclassname">nnabla.functions.</code><code class="descname">mul2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#mul2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.mul2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise multiplication.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i x^{(1)}_i\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.div2">
<code class="descclassname">nnabla.functions.</code><code class="descname">div2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#div2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.div2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise division.</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{x^{(0)}_i} {x^{(1)}_i}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.pow2">
<code class="descclassname">nnabla.functions.</code><code class="descname">pow2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pow2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.pow2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise power function.</p>
<div class="math notranslate nohighlight">
\[y_i = {(x^{(0)}_i)} ^ {x^{(1)}_i}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.add_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">add_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#add_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.add_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar addition.</p>
<div class="math notranslate nohighlight">
\[y_i = x_i + v\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.mul_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">mul_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#mul_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.mul_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar multiplication.</p>
<div class="math notranslate nohighlight">
\[y_i = v x_i\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.pow_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">pow_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pow_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.pow_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar power function.</p>
<div class="math notranslate nohighlight">
\[y_i = (x_i) ^ v\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.r_sub_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">r_sub_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#r_sub_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.r_sub_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar subtraction.</p>
<div class="math notranslate nohighlight">
\[y_i = v - x_i\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.r_div_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">r_div_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#r_div_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.r_div_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar division.</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{v}{x_i}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.r_pow_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">r_pow_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#r_pow_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.r_pow_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar power function.</p>
<div class="math notranslate nohighlight">
\[y_i = v ^ {x_i}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="logical">
<h3>Logical<a class="headerlink" href="#logical" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.equal">
<code class="descclassname">nnabla.functions.</code><code class="descname">equal</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise ‘equal’</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1 &amp; (x^{(0)}_i = x^{(1)}_i) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.equal_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">equal_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#equal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.equal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise ‘equal’ with a scalar</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    1 &amp; (x_i = v) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.greater">
<code class="descclassname">nnabla.functions.</code><code class="descname">greater</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.greater" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i &gt; x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i \leq x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.greater_equal">
<code class="descclassname">nnabla.functions.</code><code class="descname">greater_equal</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.greater_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i \geq x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i &lt; x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.greater_equal_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">greater_equal_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater_equal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.greater_equal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i \geq v \\
    0 &amp; (x^{(0)}_i &lt; v
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.greater_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">greater_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.greater_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i &gt; v \\
    0 &amp; (x^{(0)}_i \leq v
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.less">
<code class="descclassname">nnabla.functions.</code><code class="descname">less</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.less" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i &lt; x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i \geq x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.less_equal">
<code class="descclassname">nnabla.functions.</code><code class="descname">less_equal</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.less_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i \leq x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i &gt; x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.less_equal_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">less_equal_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less_equal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.less_equal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i \leq v) \\
    0 &amp; (x^{(0)}_i &gt; v)
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.less_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">less_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.less_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i &lt; v) \\
    0 &amp; (x^{(0)}_i \geq v)
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_and">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_and</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_and"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise logical AND.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1 &amp; (x^{(0)}_i \neq 0 \;\&amp;\; x^{(1)}_i \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_and_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_and_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_and_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_and_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise logical AND with scalar.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    1 &amp; (x_i \neq 0 \;\&amp;\; v \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – No Description</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_not">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_not</code><span class="sig-paren">(</span><em>x0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_not"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_not" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise logical NOT operation</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i) = \begin{cases}
    1 &amp; (x_i = 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_or">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_or</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_or"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise logical OR.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    0 &amp; (x^{(0)}_i = 0 \;\&amp;\; x^{(1)}_i = 0) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_or_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_or_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_or_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_or_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise logical OR with scalar.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    0 &amp; (x_i = 0 \;\&amp;\; v = 0) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – No Description</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_xor">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_xor</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_xor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_xor" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise logical XOR.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1 &amp; (x^{(0)}_i = 0 \;\&amp;\; x^{(1)}_i = 0) \\
    1 &amp; (x^{(0)}_i \neq 0 \;\&amp;\; x^{(1)}_i \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.logical_xor_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">logical_xor_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_xor_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.logical_xor_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise logical XOR with scalar.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    1 &amp; (x_i = 0 \;\&amp;\; v = 0) \\
    1 &amp; (x_i \neq 0 \;\&amp;\; v \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – No Description</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.not_equal">
<code class="descclassname">nnabla.functions.</code><code class="descname">not_equal</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#not_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.not_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise ‘not equal’</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    0 &amp; (x^{(0)}_i = x^{(1)}_i) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">No Description</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.not_equal_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">not_equal_scalar</code><span class="sig-paren">(</span><em>x0</em>, <em>val=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#not_equal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.not_equal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element wise ‘not equal’ with a scalar</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    0 &amp; (x_i = v) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sign">
<code class="descclassname">nnabla.functions.</code><code class="descname">sign</code><span class="sig-paren">(</span><em>x</em>, <em>alpha=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise sign function.</p>
<p>In the forward pass, it is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = \begin{cases}
    1  &amp; (x &gt; 0) \\
    -1 &amp; (x &lt; 0) \\
    \alpha &amp; (x = 0)
\end{cases}.\end{split}\]</div>
<p>In the backward pass, it is defined as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f(x)}{\partial x} = 1,\]</div>
<p>or in other words, it behaves as the identity function for the gradient in the backward pass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value in case of <span class="math notranslate nohighlight">\(x = 0\)</span>.
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.minimum2">
<code class="descclassname">nnabla.functions.</code><code class="descname">minimum2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#minimum2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.minimum2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise minimum.</p>
<div class="math notranslate nohighlight">
\[y_i = \min(x^{(0)}_i, x^{(1)}_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of min value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.maximum2">
<code class="descclassname">nnabla.functions.</code><code class="descname">maximum2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#maximum2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.maximum2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise maximum.</p>
<div class="math notranslate nohighlight">
\[y_i = \max(x^{(0)}_i, x^{(1)}_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of max value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.minimum_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">minimum_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#minimum_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.minimum_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar minimum.</p>
<div class="math notranslate nohighlight">
\[y_i = \min(x_i, v)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.maximum_scalar">
<code class="descclassname">nnabla.functions.</code><code class="descname">maximum_scalar</code><span class="sig-paren">(</span><em>x</em>, <em>val=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#maximum_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.maximum_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise scalar maximum.</p>
<div class="math notranslate nohighlight">
\[y_i = \max (x_i, v)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</li>
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="math">
<h3>Math<a class="headerlink" href="#math" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.constant">
<code class="descclassname">nnabla.functions.</code><code class="descname">constant</code><span class="sig-paren">(</span><em>val=0</em>, <em>shape=[]</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a constant-valued array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Constant value.
[default=``0``]</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of the output array.
[default=``[]``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array where all values are the specified constant.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.arange">
<code class="descclassname">nnabla.functions.</code><code class="descname">arange</code><span class="sig-paren">(</span><em>start</em>, <em>stop</em>, <em>step=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#arange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.arange" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a range of values within the half-open interval
<code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop)</span></code> (the interval including start but excluding
stop) with <cite>step</cite> increments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Start value.</li>
<li><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – End value.</li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Step value.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1-D array with the generated values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.abs">
<code class="descclassname">nnabla.functions.</code><code class="descname">abs</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise absolute value function.</p>
<div class="math notranslate nohighlight">
\[y_i = |x_i|\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Element-wise absolute variable</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.exp">
<code class="descclassname">nnabla.functions.</code><code class="descname">exp</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise natural exponential function.</p>
<div class="math notranslate nohighlight">
\[y_i = \exp(x_i).\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Element-wise exp variable</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.log">
<code class="descclassname">nnabla.functions.</code><code class="descname">log</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise natural logarithm function.</p>
<div class="math notranslate nohighlight">
\[y_i = \ln(x_i).\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Element-wise log variable</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.round">
<code class="descclassname">nnabla.functions.</code><code class="descname">round</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#round"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.round" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise round function.</p>
<p>In the forward pass, this function simply computes <cite>round</cite> to the nearest integer value.</p>
<div class="math notranslate nohighlight">
\[y_i = round(x_i).\]</div>
<p>In the backward pass, the simple Straight-Through Estimator (STE) is applied,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial y_i}{\partial x_i} = 1.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.ceil">
<code class="descclassname">nnabla.functions.</code><code class="descname">ceil</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#ceil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise ceil function.</p>
<p>In the forward pass, this function simply returns the smallest integer which is not less than the input.</p>
<div class="math notranslate nohighlight">
\[y_i = ceil(x_i).\]</div>
<p>In the backward pass, the simple Straight-Through Estimator (STE) is applied,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial y_i}{\partial x_i} = 1.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.floor">
<code class="descclassname">nnabla.functions.</code><code class="descname">floor</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#floor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.floor" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise floor function.</p>
<p>In the forward pass, this function simply returns the largest integer which is not greater than the input.</p>
<div class="math notranslate nohighlight">
\[y_i = floor(x_i).\]</div>
<p>In the backward pass, the simple Straight-Through Estimator (STE) is applied,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial y_i}{\partial x_i} = 1.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.identity">
<code class="descclassname">nnabla.functions.</code><code class="descname">identity</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#identity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Identity function.</p>
<div class="math notranslate nohighlight">
\[y = x\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.matrix_diag">
<code class="descclassname">nnabla.functions.</code><code class="descname">matrix_diag</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#matrix_diag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.matrix_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array where the last two dimensions consist of the diagonal matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N\)</span>).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N \times M_N\)</span>).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.matrix_diag_part">
<code class="descclassname">nnabla.functions.</code><code class="descname">matrix_diag_part</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#matrix_diag_part"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.matrix_diag_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array in which the values of the last dimension consist of the diagonal
elements of the last two dimensions of an input array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N \times M_N\)</span>).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N\)</span>).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.batch_matmul">
<code class="descclassname">nnabla.functions.</code><code class="descname">batch_matmul</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>transpose_a=False</em>, <em>transpose_b=False</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#batch_matmul"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.batch_matmul" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch matrix multiplication.</p>
<p>Two of batchs of matrices are multiplied for each sample in a batch. A batch of matrices is composed as […, P, Q] where the last two dimensions compose matrix dimensions, and the first dimensions up to the third last dimension are considered as batch samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with &gt;= 2-dim. The last two dimensions will be treated as a matrix.</li>
<li><strong>b</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with &gt;= 2-dim. The last two dimensions will be treated as a matrix. The product of the size of 0-th dimension through the size of the third last dimension must be same as that of the input <code class="docutils literal notranslate"><span class="pre">a</span></code>.</li>
<li><strong>transpose_a</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Transpose the last two axes of <code class="docutils literal notranslate"><span class="pre">a</span></code> in matrix multiplication.
[default=``False``]</li>
<li><strong>transpose_b</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Transpose the last two axes of <code class="docutils literal notranslate"><span class="pre">b</span></code> in matrix multiplication.
[default=``False``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output of sample-wise matrix multiplication in a batch. When <code class="docutils literal notranslate"><span class="pre">a</span></code> is of a shape of [N, P, Q], <code class="docutils literal notranslate"><span class="pre">b</span></code> is of a shape of [N, Q, R], and transpose options are all False, the output will be a shape of [N, P, R].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sin">
<code class="descclassname">nnabla.functions.</code><code class="descname">sin</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sin" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise sine (sin) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \sin (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.cos">
<code class="descclassname">nnabla.functions.</code><code class="descname">cos</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#cos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.cos" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise cosine (cos) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \cos (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.tan">
<code class="descclassname">nnabla.functions.</code><code class="descname">tan</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.tan" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise tangent (tan) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \tan (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sinh">
<code class="descclassname">nnabla.functions.</code><code class="descname">sinh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sinh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise hyperbolic sine (sinh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \sinh (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.cosh">
<code class="descclassname">nnabla.functions.</code><code class="descname">cosh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#cosh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.cosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise hyperbolic cosine (cosh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \cosh (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">nnabla.functions.</code><code class="descname">tanh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tanh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Element-wise hyperbolic tangent (tanh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \tanh (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.asin">
<code class="descclassname">nnabla.functions.</code><code class="descname">asin</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#asin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.asin" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise arcsine (asin) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \arcsin (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.acos">
<code class="descclassname">nnabla.functions.</code><code class="descname">acos</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#acos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.acos" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise arccosine (acos) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \arccos (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.atan">
<code class="descclassname">nnabla.functions.</code><code class="descname">atan</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#atan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.atan" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise arctangent (atan) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \arctan (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.atan2">
<code class="descclassname">nnabla.functions.</code><code class="descname">atan2</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#atan2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise arctangent (atan) function with 2 input variables.</p>
<div class="math notranslate nohighlight">
\[y_i = \arctan2 (x_{i1}, x_{i2})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as input variables</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.asinh">
<code class="descclassname">nnabla.functions.</code><code class="descname">asinh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#asinh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.asinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise hyperbolic arcsine (asinh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{arcsinh} (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.acosh">
<code class="descclassname">nnabla.functions.</code><code class="descname">acosh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#acosh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.acosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise hyperbolic arccosine (acosh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{arccosh} (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.atanh">
<code class="descclassname">nnabla.functions.</code><code class="descname">atanh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#atanh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.atanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise hyperbolic arctangent (atanh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{arctanh} (x_i)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array with the same shape as x</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="array-manipulation">
<h3>Array Manipulation<a class="headerlink" href="#array-manipulation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.concatenate">
<code class="descclassname">nnabla.functions.</code><code class="descname">concatenate</code><span class="sig-paren">(</span><em>*x</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#concatenate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate a variable number of input arrays along the specified axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D arrays.
[variadic]</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis
[default=``len(x[0].shape) - 1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Concatenate variable</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.split">
<code class="descclassname">nnabla.functions.</code><code class="descname">split</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split arrays at the specified axis.</p>
<p>It returns a number corresponding the size of the given
axis (i.e <code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span></code>) of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> s.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: A <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> s</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal notranslate"><span class="pre">nnabla.function_bases.split()</span></code>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.stack">
<code class="descclassname">nnabla.functions.</code><code class="descname">stack</code><span class="sig-paren">(</span><em>*x</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Joins two or more arrays on a new axis.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unlike <a class="reference internal" href="#nnabla.functions.concatenate" title="nnabla.functions.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nnabla.functions.concatenate()</span></code></a> , which joins arrays on an existing axis,
Stack joins arrays on a new axis.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D arrays. The sizes of all the arrays to be stacked must be the same.
[variadic]</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The axis on which to concatenate arrays. Axis indices take on values 0, 1, 2, and so on from the left. For example, to stack four (3,28,28) inputs on the second axis, specify 1. In this case, the output size will be (3,4,28,28).
[default=``0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.slice">
<code class="descclassname">nnabla.functions.</code><code class="descname">slice</code><span class="sig-paren">(</span><em>x</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice arrays along specified axis. This function
complies with python slice wherre <cite>slice(None, None, -1)</cite> and
<cite>slice(-1, None, -1)</cite> are the special case, which flips the
input array and results in the output array from the end to the beginning
of the input array along the corresponding dimension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>start</strong> (<em>repeated int64</em>) – Start indices for each axis
[default=``(0,) * len(x.shape)``]</li>
<li><strong>stop</strong> (<em>repeated int64</em>) – Stop indices for each axis
[default=``tuple(x.shape)``]</li>
<li><strong>step</strong> (<em>repeated int64</em>) – Step indices for each axis
[default=``(1,) * len(x.shape)``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sliced N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.gather_nd">
<code class="descclassname">nnabla.functions.</code><code class="descname">gather_nd</code><span class="sig-paren">(</span><em>data</em>, <em>indices</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#gather_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.gather_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Gather elements or slices from <cite>data</cite> according to <cite>indices</cite>, which must
be at least two-dimensional with the first dimension <span class="math notranslate nohighlight">\(M\)</span> being less or
equal to the <span class="math notranslate nohighlight">\(N\)</span> dimensions of <cite>data</cite>. Given <cite>data</cite> with shape
<span class="math notranslate nohighlight">\((X_0, X_1, ..., X_{N-1})\)</span> and indices with shape <span class="math notranslate nohighlight">\((M, Y_0, ...,
Y_{K-1})\)</span> output has shape <span class="math notranslate nohighlight">\((Y_0, ..., Y_{K-1}, X_M, ..., X_{N-1})\)</span>.
If <span class="math notranslate nohighlight">\(M == N\)</span>, output shape is simply <span class="math notranslate nohighlight">\((Y_0, ..., Y_{K-1})\)</span>.</p>
<p>The forward of <a class="reference internal" href="#nnabla.functions.gather_nd" title="nnabla.functions.gather_nd"><code class="xref py py-func docutils literal notranslate"><span class="pre">gather_nd()</span></code></a> is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="n">tmp_index</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">tmp_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="p">(</span><span class="bp">Ellipsis</span><span class="p">,)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">new_index</span><span class="p">))</span>
    <span class="n">out_shape</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">tmp_index</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">out_shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[ 1.  2.  3.  4.  5.]</span>
<span class="go"> [ 6.  7.  8.  9. 10.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[6. 7. 1.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[ 6.  7.  8.  9. 10.]</span>
<span class="go"> [ 6.  7.  8.  9. 10.]</span>
<span class="go"> [ 1.  2.  3.  4.  5.]]</span>
</pre></div>
</div>
<p>When <cite>indices</cite> is provided as a <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> it will be possible
to change the actual index values after function creation. It is important
to note that out-of-bound indices raise errors when running on CPU but are
ignored when using an accelerated computation context.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[1.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[10.]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>NdArray</em>) – input data</li>
<li><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a><em>, </em><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>NdArray</em>) – gather indices</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: ~nnabla.Variable or ~nnabla.NdArray of gathered elements.</p>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.pad">
<code class="descclassname">nnabla.functions.</code><code class="descname">pad</code><span class="sig-paren">(</span><em>x</em>, <em>pad_width</em>, <em>mode='constant'</em>, <em>constant_value=0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad the input N-D array <cite>x</cite> over the number of dimensions given
by half the length of the <cite>pad_width</cite> iterable, where every two
values in <cite>pad_width</cite> determine the before and after pad size of
an axis. The <cite>pad_width</cite> iterable must hold an even number of
positive values which may cover all or fewer dimensions of the
input variable <cite>x</cite>. If <cite>pad_width</cite> covers fewer dimensions then
it applies to the innermost dimensions of <cite>x</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>Padding is performed according to the requested <cite>mode</cite>:</p>
<dl class="docutils">
<dt>constant</dt>
<dd><p class="first">Pads with a value given by the keyword argument <cite>constant_value</cite>.</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</dd>
<dt>reflect</dt>
<dd><p class="first">Pads with the reflection of the vector mirrored on the first
and last values of the vector along each axis.</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>pad_width</strong> (<em>repeated int64</em>) – Iterable of <em>before</em> and <em>after</em> pad values.</li>
<li><strong>mode</strong> (<em>string</em>) – Padding mode string.
[default=``’constant’<a href="#id11"><span class="problematic" id="id12">``</span></a>]</li>
<li><strong>constant_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Fill value if mode is <cite>constant</cite>.
[default=``0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>Padded N-D array with the same number of dimensions as the input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># a shape like (B, C, H, W)</span>
<span class="c1"># 1-D padding: last dim by 1 left and 2 on the right side</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># 2-D padding: last dim by (1, 1) and 2nd to last by (2, 2)</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># 3-D padding: dims C by (0, 1), H by (2, 1), and W by (3, 3)</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.transpose">
<code class="descclassname">nnabla.functions.</code><code class="descname">transpose</code><span class="sig-paren">(</span><em>x</em>, <em>axes</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Transposes tensor dimensions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>axes</strong> (<em>repeated int64</em>) – Source axis indices for each axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Transposed N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.broadcast">
<code class="descclassname">nnabla.functions.</code><code class="descname">broadcast</code><span class="sig-paren">(</span><em>x</em>, <em>shape</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#broadcast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.broadcast" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcasting ND-array to the specified shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape broadcasted to. The size must be the same in axis where <code class="docutils literal notranslate"><span class="pre">x</span></code>’s shape is not 1.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Broadcasted N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.broadcast_to">
<code class="descclassname">nnabla.functions.</code><code class="descname">broadcast_to</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>axis=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#broadcast_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.broadcast_to" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function is experimental support, so please do not actively use it.</p>
</div>
<p>Broadcasting ND-array to the specified buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>y</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Target axis to start broadcasting. If this is not set, broadcast will try to fit y to x starting from the last dimension
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Broadcasted N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.tile">
<code class="descclassname">nnabla.functions.</code><code class="descname">tile</code><span class="sig-paren">(</span><em>x</em>, <em>reps</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#tile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.tile" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward <cite>x</cite> repeated the number of times given by <cite>reps</cite>. If <cite>reps</cite> is
a sequence, the output has dimension of <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">max(len(reps),</span> <span class="pre">x.ndim)</span></code> and
either <cite>x</cite> is promoted to be d-dimensional by prepending new axes or <cite>reps</cite>
is promoted to x.ndim by prepending 1’s.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array.</li>
<li><strong>reps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>sequence of int</em>) – Repetitions of <cite>x</cite> along each axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># reps is promoted to [1, 3]</span>
<span class="go">(2, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># x is promoted to shape (1, 3)</span>
<span class="go">(2, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[1. 2. 3. 1. 2. 3. 1. 2. 3.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[1. 2. 3. 1. 2. 3. 1. 2. 3.]</span>
<span class="go"> [1. 2. 3. 1. 2. 3. 1. 2. 3.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[1. 3. 1. 3. 1. 3.]</span>
<span class="go"> [2. 4. 2. 4. 2. 4.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[1. 3. 1. 3. 1. 3.]</span>
<span class="go"> [2. 4. 2. 4. 2. 4.]</span>
<span class="go"> [1. 3. 1. 3. 1. 3.]</span>
<span class="go"> [2. 4. 2. 4. 2. 4.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.flip">
<code class="descclassname">nnabla.functions.</code><code class="descname">flip</code><span class="sig-paren">(</span><em>x</em>, <em>axes=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#flip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the order of elements of the specified dimension of an array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>axes</strong> (<em>repeated int64</em>) – The index of the dimension to reverse the order of the elements. Axis indices take on values 0, 1, 2, and so on from the left. For example, to flip a 32 (W) by 24 (H) 100 RGB image (100,3,24,32) vertically and horizontally, specify (2,3).
[default=``[len(x.shape) - 1]``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.shift">
<code class="descclassname">nnabla.functions.</code><code class="descname">shift</code><span class="sig-paren">(</span><em>x</em>, <em>shifts=None</em>, <em>border_mode='nearest'</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the array elements by the specified amount.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>shifts</strong> (<em>repeated int64</em>) – The amount to shift elements. For example, to shift image data to the right by 2 pixels and up 3 pixels, specify (-3,2).
[default=``(0,) * len(x.shape)``]</li>
<li><strong>border_mode</strong> (<em>string</em>) – Specify how to process the ends of arrays whose values will be undetermined as a result of shifting. nearest: The data at the ends of the original      array is copied and used. reflect: Original data reflected      at the ends of the original array is used.
[default=``’nearest’<a href="#id13"><span class="problematic" id="id14">``</span></a>]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sort">
<code class="descclassname">nnabla.functions.</code><code class="descname">sort</code><span class="sig-paren">(</span><em>x</em>, <em>axis=-1</em>, <em>reverse=False</em>, <em>with_index=False</em>, <em>only_index=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the elements of <cite>x</cite> along a given <cite>axis</cite> in ascending order
by value. A negative <cite>axis</cite> counts from the last dimension of <cite>x</cite>,
so the default of -1 sorts along the last dimension. If <cite>reverse</cite>
is True, then the elements are soreted in descending order.</p>
<p>If <cite>with_index</cite> is True, result is a tuple <code class="docutils literal notranslate"><span class="pre">(sorted,</span> <span class="pre">indices)</span></code>
or only <code class="docutils literal notranslate"><span class="pre">indices</span></code> if <cite>only_index</cite> is True. Setting <cite>only_index</cite>
to True implies that <cite>with_index</cite> is also True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="nb">sorted</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sorted</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>

<span class="nb">sorted</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">with_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sorted</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">only_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis along which to sort.</li>
<li><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Sort in descending order.</li>
<li><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return sorted values and index.</li>
<li><strong>only_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return only the sort index.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: ~nnabla.Variable <cite>sorted</cite> or ~nnabla.Variable <cite>indices</cite> or (~nnabla.Variable <cite>sorted</cite>, ~nnabla.Variable <cite>indices</cite>)</p>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.reshape">
<code class="descclassname">nnabla.functions.</code><code class="descname">reshape</code><span class="sig-paren">(</span><em>x</em>, <em>shape</em>, <em>inplace=True</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reshape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes the input variable in-place. It does not create a copy of the variable.
The output variable (y) has a new shape but points to the same data as the input variable (x).
This means that if the data in the output variable (y) is modified, the data in the input
variable (x) also gets modified since the reshape was done in-place.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function has the same behavior as the <a class="reference internal" href="variable.html#nnabla.Variable.reshape" title="nnabla.Variable.reshape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nnabla.Variable.reshape()</span></code></a> method.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dimensions for each axis. <code class="docutils literal notranslate"><span class="pre">-1</span></code> can be specified only in one shape dimension. The value is calculated from the size of the array and remaining dimensions.</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – The output array is shared with the input array if True.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Reshaped N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.one_hot">
<code class="descclassname">nnabla.functions.</code><code class="descname">one_hot</code><span class="sig-paren">(</span><em>x</em>, <em>shape</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates one-hot vector based on input indices.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 1)</span>

<span class="n">num_class</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_class</span><span class="p">,</span> <span class="p">))</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 10)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># [[0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]</span>
<span class="c1">#  [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]</span>

<span class="c1"># Can also be used for ndarray.</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 2)</span>

<span class="n">num_class_1</span><span class="p">,</span> <span class="n">num_class_2</span>  <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_class_1</span><span class="p">,</span> <span class="n">num_class_2</span><span class="p">))</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 10, 8)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># [[[0. 0. 0. 0. 0. 0. 0. 0.]          [[0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 1.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 1. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]    ...    [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]],         [0. 0. 0. 0. 0. 0. 0. 0.]]]</span>
</pre></div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array representing label’s indice.</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of classes. Note that it must be exactly the same as the number of classes included in label data. Passing incorrect numbers might cause an unexpected error and currently this function doesn’t check if the input is valid or not. Also, when nd-labels are given, dimensions must match. See the example above.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array one-hot vector/tensor.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.assign">
<code class="descclassname">nnabla.functions.</code><code class="descname">assign</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#assign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign source array to destination array just like <cite>tf.assign</cite>.
This is useful to synchronize or manually update parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dst</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">assign</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>

<span class="n">assign</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> <span class="c1"># dst and src have identical values.</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">assign</span><span class="o">.</span><span class="n">d</span> <span class="n">dst</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> <span class="c1"># returned Variable is also identical to dst.</span>
</pre></div>
</div>
<p>Unlike TensorFlow, the returned Variable has a backward path to <cite>dst</cite>:</p>
<div class="math notranslate nohighlight">
\[g_{dst} = g_{y}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dst</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A destination N-D array</li>
<li><strong>src</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A source N-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An assigned array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="stochasticity">
<h3>Stochasticity<a class="headerlink" href="#stochasticity" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.rand">
<code class="descclassname">nnabla.functions.</code><code class="descname">rand</code><span class="sig-paren">(</span><em>low=0</em>, <em>high=1</em>, <em>shape=[]</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.rand" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples numbers from a uniform distribution <span class="math notranslate nohighlight">\(x \sim U(low, high)\)</span>
given lowest value <span class="math notranslate nohighlight">\(low\)</span>, upper bound <span class="math notranslate nohighlight">\(high\)</span>,
and shape of the returned Variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(low\)</span> in definition.
[default=``0``]</li>
<li><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(high\)</span> in definition.
[default=``1``]</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default=``[]``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Variable with the shape specified in the argument.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.randint">
<code class="descclassname">nnabla.functions.</code><code class="descname">randint</code><span class="sig-paren">(</span><em>low=0</em>, <em>high=1</em>, <em>shape=[]</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#randint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.randint" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples integer numbers from a uniform distribution <span class="math notranslate nohighlight">\(x \sim U(low, high)\)</span>
given lowest value <span class="math notranslate nohighlight">\(low\)</span>, upper bound <span class="math notranslate nohighlight">\(high\)</span>,
and shape of the returned Variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(low\)</span> in definition.
[default=``0``]</li>
<li><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(high\)</span> in definition.
[default=``1``]</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default=``[]``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Variable with the shape specified in the argument. The dtype is int32.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.randn">
<code class="descclassname">nnabla.functions.</code><code class="descname">randn</code><span class="sig-paren">(</span><em>mu=0</em>, <em>sigma=1</em>, <em>shape=[]</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#randn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.randn" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples numbers from a normal distribution <span class="math notranslate nohighlight">\(x \sim N(\mu, \sigma)\)</span>
given mean <span class="math notranslate nohighlight">\(\mu\)</span>, standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>,
and shape of the returned Variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\mu\)</span> in definition.
[default=``0``]</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\sigma\)</span> in definition.
[default=``1``]</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default=``[]``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Variable with the shape specified in the argument.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.dropout">
<code class="descclassname">nnabla.functions.</code><code class="descname">dropout</code><span class="sig-paren">(</span><em>x</em>, <em>p=0.5</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Dropout.
Samples a number <span class="math notranslate nohighlight">\(u\)</span> from a uniform distribution in <span class="math notranslate nohighlight">\([0, 1]\)</span> ,
and ignores the input if <span class="math notranslate nohighlight">\(u \leq p\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y = \left\{
\begin{array}{ll}
  \frac{x}{1 - p} &amp; (u &gt; p) \\
  0 &amp; ({\rm otherwise})
\end{array} \right.\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Usually dropout only applied during training as below
(except <a class="reference external" href="https://arxiv.org/abs/1506.02142">Bayesian dropout</a>).</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_hidden</span><span class="p">)</span>
<span class="k">if</span> <span class="n">train</span><span class="p">:</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(p\)</span> in definition.
[default=``0.5``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.top_k_data">
<code class="descclassname">nnabla.functions.</code><code class="descname">top_k_data</code><span class="sig-paren">(</span><em>x</em>, <em>k</em>, <em>abs=False</em>, <em>reduce=True</em>, <em>base_axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#top_k_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.top_k_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the <cite>k</cite> largest values from each sample in <cite>x</cite> to
propagate unmodified and set all other values to 0. If <cite>abs</cite> is
True, the <cite>k</cite> largest values are selected by magnitude. If
<cite>reduce</cite> is True (the default), all feature dimensions are
reduced to a single dimension of size <cite>k</cite> that propagates only
the <cite>k</cite> largest values. Otherwise, if <cite>reduce</cite> is False, input
and output dimensions are identical. Dimensions before
<cite>base_axis</cite> are treated as number of sample dimensions and <cite>k</cite>
values get selected from all elements of a sample (dimensions
from <cite>base_axis</cite>) regardless of shape.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">top_k_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 5, 6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">top_k_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">top_k_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">base_axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 5, 3)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of largest data values to propagate.</li>
<li><strong>abs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Determine largest data values by magnitude.
[default=``False``]</li>
<li><strong>reduce</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Reduce feature size to one dimension of size <cite>k</cite>.
[default=``True``]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – First dimension of the sample shape.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.top_k_grad">
<code class="descclassname">nnabla.functions.</code><code class="descname">top_k_grad</code><span class="sig-paren">(</span><em>x</em>, <em>k</em>, <em>abs=False</em>, <em>base_axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#top_k_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.top_k_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the <cite>k</cite> largest gradients for each sample in <cite>x</cite> to
back-propagate unmodified and set all other gradients to 0. If
<cite>abs</cite> is True, the <cite>k</cite> largest gradients are selected by
magnitude. Dimensions before <cite>base_axis</cite> are treated as number
of sample dimensions and <cite>k</cite> gradients get selected from all
gradients of a sample (dimensions from <cite>base_axis</cite>) regardless
of shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of largest gradients to propagate.</li>
<li><strong>abs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Determine largest gradients by magnitude.
[default=``False``]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – First dimension of the sample shape.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with same shape and data as <cite>x</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.random_choice">
<code class="descclassname">nnabla.functions.</code><code class="descname">random_choice</code><span class="sig-paren">(</span><em>x</em>, <em>w</em>, <em>shape=[]</em>, <em>replace=True</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_choice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.random_choice" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random samples from population <cite>x</cite> with selection probabilities
determined by the relative weights <cite>w</cite>. The number of samples to draw is
given by the product of <cite>shape`s dimensions, and the samples are returned
with the given `shape</cite>. By default, samples are drawn with replacement,
i.e. selection of a specific population member is solely determined by
its associated weight. Sampling without replacement, where any population
member may be drawn only once, is used if <cite>replace</cite> is set to False.</p>
<p>For both <cite>x</cite> and <cite>w</cite> the innermost dimension corresponds to the individual
populations and their weights from which samples are returned with the
requested <cite>shape</cite> following all outermost dimensions of the input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># x holds two populations</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">330</span><span class="p">]]))</span>
<span class="c1"># w holds the weights for each population</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]))</span>

<span class="c1"># draw one sample from each population</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">random_choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>  <span class="c1"># y.shape =&gt; (2, 1)</span>

<span class="c1"># draw 12 samples with shape (3, 4) from each population</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">random_choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># y.shape =&gt; (2, 3, 4)</span>
</pre></div>
</div>
<p>Note that weights must not be less than zero and for each population the
sum of weights must be greater than zero. Additionally, sampling without
replacement requires that the number of non-zero weights is not less than
the number of samples to be drawn. These conditions are verified in “cpu”
computation context but not when using “cuda” or “cudnn” acceleration
(this would require additional device synchronization steps penalizing
performance).</p>
<p>Random sampling from an implicit array of index values (like categorical
or multinomial) can be realized with input <cite>x</cite> constructed as indices.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">random_choice</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array from which a random sample is generated.</li>
<li><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of associated weights of elements in <cite>x</cite>.</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number and shape of generated samples.
[default=``[]``]</li>
<li><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether sampling is with or without replacement.
[default=``True``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.random_crop">
<code class="descclassname">nnabla.functions.</code><code class="descname">random_crop</code><span class="sig-paren">(</span><em>x</em>, <em>shape=None</em>, <em>base_axis=1</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_crop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.random_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>RandomCrop randomly extracts a portion of an array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The data size to extract. For example, to randomly extract a portion of the image (3,48,48) from a 3,64,64 image, specify (3,48,48).
[default=``x.shape``]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – No Description
[default=``1``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.random_flip">
<code class="descclassname">nnabla.functions.</code><code class="descname">random_flip</code><span class="sig-paren">(</span><em>x</em>, <em>axes=None</em>, <em>base_axis=1</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_flip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.random_flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the order of elements of the specified dimension of an array at 50% probability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>axes</strong> (<em>repeated int64</em>) – The index of the axis to reverse the order of the elements. Axis indices take on values 0, 1, 2, and so on from the left. For example, to flip a 32 (W) by 24 (H) 100 RGB images (100, 3,24,32) vertically and horizontally at random, specify (2,3).
[default=``[len(x.shape) - 1]``]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – No Description
[default=``1``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.random_shift">
<code class="descclassname">nnabla.functions.</code><code class="descname">random_shift</code><span class="sig-paren">(</span><em>x</em>, <em>shifts=None</em>, <em>border_mode='nearest'</em>, <em>base_axis=1</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.random_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly shifts the array elements within the specified range.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>shifts</strong> (<em>repeated int64</em>) – Max absolute amount to shift elements. For example, to shift image data horizontally by <span class="math notranslate nohighlight">\(\pm 2\)</span> pixels and vertically by <span class="math notranslate nohighlight">\(\pm 3\)</span> pixels, specify (3,2).
[default=``(0,) * len(x.shape)``]</li>
<li><strong>border_mode</strong> (<em>string</em>) – Specify how to process the ends of arrays whose values will be undetermined as a result of shifting. nearest: The data at the ends of the   original array is copied and used. reflect: Original data reflected at   the ends of the original array is used.
[default=``’nearest’<a href="#id15"><span class="problematic" id="id16">``</span></a>]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – No Description
[default=``1``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.image_augmentation">
<code class="descclassname">nnabla.functions.</code><code class="descname">image_augmentation</code><span class="sig-paren">(</span><em>x</em>, <em>shape=None</em>, <em>pad=(0</em>, <em>0)</em>, <em>min_scale=1.0</em>, <em>max_scale=1.0</em>, <em>angle=0.0</em>, <em>aspect_ratio=1.0</em>, <em>distortion=0.0</em>, <em>flip_lr=False</em>, <em>flip_ud=False</em>, <em>brightness=0.0</em>, <em>brightness_each=False</em>, <em>contrast=1.0</em>, <em>contrast_center=0.0</em>, <em>contrast_each=False</em>, <em>noise=0.0</em>, <em>seed=-1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#image_augmentation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.image_augmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>ImageAugmentation randomly alters the input image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The output image data size.
[default=``x.shape``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default=``(0, 0)``]</li>
<li><strong>min_scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The minimum scale ratio when randomly scaling the image. For example, to scale down to 0.8 times the size of the original image, specify “0.8”. To not apply random scaling, set both min_scale and max_scale to “1.0”.
[default=``1.0``]</li>
<li><strong>max_scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The maximum scale ratio when randomly scaling the image. For example, to scale down to 2 times the size of the original image, specify “2.0”.
[default=``1.0``]</li>
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The rotation angle range in radians when randomly rotating the image. The image is randomly rotated in the -Angle to +Angle range. For example, to rotate in a +-15 degree range, specify “0.26” (15 degrees/360 degrees * 2PI). To not apply random rotation, specify “0.0”.
[default=``0.0``]</li>
<li><strong>aspect_ratio</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The aspect ratio range when randomly deforming the image. For example, to deform aspect ratio of image from 1:1.3 to 1.3:1, specify “1.3”. To not apply random deforming, specify “1.0”.
[default=``1.0``]</li>
<li><strong>distortion</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The distortion range when randomly distorting the image. To not apply distortion, specify “0.0”.
[default=``0.0``]</li>
<li><strong>flip_lr</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to randomly flip the image horizontally at 50% probability.
[default=``False``]</li>
<li><strong>flip_ud</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to randomly flip the image vertically at 50% probability.
[default=``False``]</li>
<li><strong>brightness</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The absolute range of values to randomly add to the brightness. A random value in the -Brightness to +Brightness range is added to the brightness. For example, to vary the brightness in the -0.05 to +0.05 range, specify “0.05”. To not apply random addition to brightness, specify “0.0”.
[default=``0.0``]</li>
<li><strong>brightness_each</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to apply the random addition to brightness (as specified by brightness) to each color channel. True: brightness is added based on a different random number for each channel. False: brightness is added based on a random number common to all channels.
[default=``False``]</li>
<li><strong>contrast</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The range in which to randomly vary the image contrast. The contrast is varied in the 1/Contrast times to Contrast times range. The output brightness is equal to (input - contrast_center) * contrast + contrast_center. For example, to vary the contrast in the 0.91 times to 1.1 times range, specify “1.1”. To not apply random contrast variation, specify “1.0”.
[default=``1.0``]</li>
<li><strong>contrast_center</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Intensity center used for applying contrast.
[default=``0.0``]</li>
<li><strong>contrast_each</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to apply the random contrast variation (as specified by contrast) to each color channel. True: contrast is varied based on a different random number for each channel. False: contrast is varied based on a random number common to all channels.
[default=``False``]</li>
<li><strong>noise</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Sigma of normal random number to be added.
[default=``0.0``]</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default=``-1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="loss-functions">
<h3>Loss Functions<a class="headerlink" href="#loss-functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.sigmoid_cross_entropy">
<code class="descclassname">nnabla.functions.</code><code class="descname">sigmoid_cross_entropy</code><span class="sig-paren">(</span><em>x</em>, <em>target</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sigmoid_cross_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sigmoid_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise cross entropy between <cite>x</cite> and the target variables, passed to a sigmoid function.</p>
<div class="math notranslate nohighlight">
\[y_i = - \left(x^{(1)}_i \ln \left(\sigma \left(x^{(0)}_i \right)\right) + \
\left(1 - x^{(1)}_i\right) \ln \left(1 - \sigma \left(x^{(0)}_i \
\right)\right)\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma(s)=\frac{1}{1+\exp(-s)}\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SigmoidCrossEntropy is equivalent to Sigmoid+BinaryCrossEntropy, but computing them at once has the effect of reducing computational error.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score. The value lies in <span class="math notranslate nohighlight">\([-\infty, \infty]\)</span>
[parameter]</li>
<li><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. Only 0 or 1 value is allowed.
[parameter]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of element-wise losses.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.binary_cross_entropy">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_cross_entropy</code><span class="sig-paren">(</span><em>x</em>, <em>target</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_cross_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise cross entropy between <cite>x</cite> and the target variables.</p>
<div class="math notranslate nohighlight">
\[y_i = - \left(x^{(1)}_i * \ln \left(x^{(0)}_i\right) + \left(1 - \
x^{(1)}_i\right) * \ln \left(1 - x^{(0)}_i\right)\right).\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Probabilities N-D array. <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>.</li>
<li><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. Usually set as 0 or 1, but, unlike SigmoidCrossEntropy, it allows probability (0 to 1) as inputs and backpropagation can be done.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of element-wise losses.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.softmax_cross_entropy">
<code class="descclassname">nnabla.functions.</code><code class="descname">softmax_cross_entropy</code><span class="sig-paren">(</span><em>x</em>, <em>target</em>, <em>axis=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softmax_cross_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.softmax_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise cross entropy between the variables and the variables of a label given by a category index with Softmax normalization.</p>
<div class="math notranslate nohighlight">
\[y_{j} = -\ln \left(\frac{\exp(x_{j,t_j})}{\sum_{i'} \exp(x_{j,i'})}\right)\]</div>
<p>along dimension specified by axis (<span class="math notranslate nohighlight">\(i\)</span> is the axis where normalization is performed on).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SoftmaxCrossEntropy is equivalent to Softmax+CategoricalCrossEntropy, but computing them at once has the effect of reducing computational error.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score. <span class="math notranslate nohighlight">\((D_1 \times ... \times D_i \times ... \times D_N)\)</span>
[parameter]</li>
<li><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span>
[parameter]</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default=``len(x.shape) - 1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of element-wise losses. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.categorical_cross_entropy">
<code class="descclassname">nnabla.functions.</code><code class="descname">categorical_cross_entropy</code><span class="sig-paren">(</span><em>x</em>, <em>target</em>, <em>axis=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#categorical_cross_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.categorical_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise cross entropy between <cite>x</cite> and the target <cite>t</cite> where targets are given by a category index.</p>
<div class="math notranslate nohighlight">
\[y_{j} = -\ln \left( x_{j, t_j} \right)\]</div>
<p>along dimension specified by axis (<span class="math notranslate nohighlight">\(i\)</span> is the axis where normalization is performed on).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score. <span class="math notranslate nohighlight">\((D_1 \times ... \times D_i \times ... \times D_N)\)</span>
[parameter]</li>
<li><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span>
[parameter]</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default=``len(x.shape) - 1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of element-wise losses. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.squared_error">
<code class="descclassname">nnabla.functions.</code><code class="descname">squared_error</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#squared_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.squared_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise squared error</p>
<div class="math notranslate nohighlight">
\[y_i = \left(x^{(0)}_i - x^{(1)}_i\right)^2.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.absolute_error">
<code class="descclassname">nnabla.functions.</code><code class="descname">absolute_error</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#absolute_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.absolute_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise absolute error</p>
<div class="math notranslate nohighlight">
\[y_i = | x^{(0)}_i - x^{(1)}_i |.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.huber_loss">
<code class="descclassname">nnabla.functions.</code><code class="descname">huber_loss</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>delta=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#huber_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.huber_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Huber loss</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \left\{
\begin{array}{ll}
  d^2 &amp; (|d| &lt; \delta)\\
  \delta (2 |d| - \delta) &amp; ({\rm otherwise})
\end{array} \right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d = x^{(0)}_i - x^{(1)}_i\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Delta
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of element-wise losses.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.epsilon_insensitive_loss">
<code class="descclassname">nnabla.functions.</code><code class="descname">epsilon_insensitive_loss</code><span class="sig-paren">(</span><em>x0</em>, <em>x1</em>, <em>epsilon</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#epsilon_insensitive_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.epsilon_insensitive_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise Epsilon Insensitive Loss</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \left\{
\begin{array}{ll}
  | x^{(0)}_i - x^{(1)}_i | - \epsilon &amp; if \ \ | x^{(0)}_i - x^{(1)}_i | &gt; \epsilon \\
                0 &amp; otherwise
\end{array} \right.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</li>
<li><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Insensitive parameter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array of element-wise losses.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.kl_multinomial">
<code class="descclassname">nnabla.functions.</code><code class="descname">kl_multinomial</code><span class="sig-paren">(</span><em>p</em>, <em>q</em>, <em>base_axis=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#kl_multinomial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.kl_multinomial" title="Permalink to this definition">¶</a></dt>
<dd><p>The Kullback Leibler Divergence for multinomial distributions.</p>
<div class="math notranslate nohighlight">
\[D = \sum_i p_i \log \left( \frac{p_i}{q_i} \right)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of the source categorical probabilities</li>
<li><strong>q</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of the target categorical probabilities</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Kullback Leibler divergence <span class="math notranslate nohighlight">\(KL(p \parallel q)\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="signal-processing">
<h3>Signal Processing<a class="headerlink" href="#signal-processing" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.interpolate">
<code class="descclassname">nnabla.functions.</code><code class="descname">interpolate</code><span class="sig-paren">(</span><em>x</em>, <em>scale=None</em>, <em>output_size=None</em>, <em>mode='linear'</em>, <em>align_corners=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an ND array with interpolation.</p>
<p>Scaling factors for spatial dimensions are determined by either
<code class="docutils literal notranslate"><span class="pre">scale</span></code> or <code class="docutils literal notranslate"><span class="pre">output_size</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nd</span> <span class="pre">=</span> <span class="pre">len(scale)</span></code> or <code class="docutils literal notranslate"><span class="pre">nd</span> <span class="pre">=</span> <span class="pre">len(output_size)</span></code> determines the number of
spatial dimensions, and the last <code class="docutils literal notranslate"><span class="pre">nd</span></code> dimensions of the input <code class="docutils literal notranslate"><span class="pre">x</span></code> are
considered as the spatial dimensions to be resized.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">scale</span></code> is given, the <code class="docutils literal notranslate"><span class="pre">output_size</span></code> is calculated by
<code class="docutils literal notranslate"><span class="pre">output_size[i]</span> <span class="pre">=</span> <span class="pre">floor(scale[i]</span> <span class="pre">*</span> <span class="pre">x.shape[i</span> <span class="pre">-</span> <span class="pre">len(scale)])</span></code>.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>

<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>

<span class="c1"># Resize by scales</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (64, 3, 448, 448)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># Print output</span>

<span class="c1"># Resize to a size</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">257</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (64, 3, 320, 257)</span>
<span class="n">y2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># Print output</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with an arbitrary number of dimensions.</li>
<li><strong>scale</strong> (<em>tuple of ints</em>) – Scale factors along axes. The default is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, and if this is omitted, <code class="docutils literal notranslate"><span class="pre">output_size</span></code> must be specified.</li>
<li><strong>output_size</strong> (<em>tuple of ints</em>) – The output sizes for axes. If this is
given, the scale factors are determined by the output sizes and the
input sizes. The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, and if this is omitted,
<code class="docutils literal notranslate"><span class="pre">scale</span></code> must be specified.</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Interpolation mode chosen from (‘linear’|’nearest’).
The default is ‘linear’.</li>
<li><strong>align_corners</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, the corner pixels of input and output
arrays are aligned, such that the output corner pixels have the
same values with the input corner pixels.
The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, and it becomes <code class="docutils literal notranslate"><span class="pre">True</span></code> if mode is
‘linear’, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.fft">
<code class="descclassname">nnabla.functions.</code><code class="descname">fft</code><span class="sig-paren">(</span><em>x</em>, <em>signal_ndim</em>, <em>normalized=False</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Complex-to-complex Discrete Fourier Transform,</p>
<div class="math notranslate nohighlight">
\[X_{k_1, \ldots, k_d} = \sum_{n_1=0}^{N_1-1} \dots \sum_{n_d=0}^{N_d-1} x_{n_1, \ldots, n_d} \exp\left(-2 \pi j \left( \sum_{i=0}^{d} \frac{k_i n_i}{N_i} \right) \right),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[k_i = 0, \ldots, N_i - 1.\]</div>
<p>This function now supports 1-D, 2-D, and 3-D DFT with or without the leading batch dimension(s).</p>
<p>The input is expected to be complex-valued with at least signal_ndim + 1 dimensions.
The last dimension has a shape of two where x[…, 0] is the real part and x[…, 1] the imaginary part.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">nnabla.ext_utils</span> <span class="kn">import</span> <span class="n">get_extension_context</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">get_extension_context</span><span class="p">(</span><span class="s2">&quot;cudnn&quot;</span><span class="p">)</span>
<span class="n">nn</span><span class="o">.</span><span class="n">set_default_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

<span class="c1"># Example for a batched 2D-FFT and 2D-IFFT (batch-size: 2, data-size: 4x3)</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x_data</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">signal_ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">signal_ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">z</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1j</span><span class="o">*</span><span class="n">z</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_data</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</li>
<li><strong>signal_ndim</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of dimensions for each signal. It must be 1, 2, or 3.</li>
<li><strong>normalized</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use unitary normalization. If <cite>True</cite>, the normalization constant <span class="math notranslate nohighlight">\(\sqrt{\frac{1}{\prod_{i=1}^{d} N_i}}\)</span> is multiplied.
[default=``False``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">FFT transformed signal.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.ifft">
<code class="descclassname">nnabla.functions.</code><code class="descname">ifft</code><span class="sig-paren">(</span><em>x</em>, <em>signal_ndim</em>, <em>normalized=False</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#ifft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Complex-to-complex inverse Discrete Fourier Transform,</p>
<div class="math notranslate nohighlight">
\[X_{k_1, \ldots, k_d} = \frac{1}{\prod_{i=1}^{d} N_i} \sum_{n_1=0}^{N_1-1} \dots \sum_{n_d=0}^{N_d-1} x_{n_1, \ldots, n_d} \exp\left(2 \pi j \left( \sum_{i=0}^{d} \frac{k_i n_i}{N_i} \right) \right),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[k_i = 0, \ldots, N_i - 1.\]</div>
<p>This function now supports 1-D, 2-D, and 3-D DFT with or without the leading batch dimension(s).</p>
<p>The input is expected to be complex-valued with at least signal_ndim + 1 dimensions.
The last dimension has a shape of two where x[…, 0] is the real part and x[…, 1] the imaginary part.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</li>
<li><strong>signal_ndim</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of dimensions for each signal. It must be 1, 2, or 3.</li>
<li><strong>normalized</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use unitary normalization. If <cite>True</cite>, the normalization constant <span class="math notranslate nohighlight">\(\frac{1}{\prod_{i=1}^{d} N_i}\)</span> becomes <span class="math notranslate nohighlight">\(\sqrt{\frac{1}{\prod_{i=1}^{d} N_i}}\)</span>.
[default=``False``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">IFFT transformed signal.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.stft">
<code class="descclassname">nnabla.functions.</code><code class="descname">stft</code><span class="sig-paren">(</span><em>x</em>, <em>window_size</em>, <em>stride</em>, <em>fft_size</em>, <em>window_type='hanning'</em>, <em>center=True</em>, <em>pad_mode='reflect'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#stft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.stft" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the short-time Fourier transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Time domain sequence of size <cite>batch_size x sample_size</cite>.</li>
<li><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of STFT analysis window.</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of samples that we shift the window, also called <cite>hop size</cite>.</li>
<li><strong>fft_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of the FFT, the output will have <cite>fft_size // 2+ 1</cite> frequency bins.</li>
<li><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Analysis window, can be either <cite>hanning</cite> or <cite>hamming</cite>.</li>
<li><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <cite>True</cite>, then the signal <cite>x</cite> is padded by half the FFT size using reflection padding.</li>
<li><strong>pad_mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Padding mode, which can be <cite>‘constant’</cite> or <cite>‘reflect’</cite>. <cite>‘constant’</cite> pads with <cite>0</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Returns real and imaginary parts of STFT result.</p>
<ul class="simple">
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Real part of STFT of size <cite>batch_size x fft_size//2 + 1 x frame_size</cite>.</li>
<li><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Imaginary part of STFT of size <cite>batch x fft_size//2 + 1 x frame_size</cite>.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.istft">
<code class="descclassname">nnabla.functions.</code><code class="descname">istft</code><span class="sig-paren">(</span><em>y_r</em>, <em>y_i</em>, <em>window_size</em>, <em>stride</em>, <em>fft_size</em>, <em>window_type='hanning'</em>, <em>center=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#istft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.istft" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the inverse shoft-time Fourier transform</p>
<p>Note: We use a constant square inverse window for the reconstruction
of the time-domain signal, therefore, the first and last
<cite>window_size - stride</cite> are not perfectly reconstructed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_r</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Real part of STFT of size <cite>batch_size x fft_size//2 + 1 x frame_size</cite>.</li>
<li><strong>y_i</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Imaginary part of STFT of size <cite>batch_size x fft_size//2 + 1 x frame_size</cite>.</li>
<li><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of STFT analysis window.</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of samples that we shift the window, also called <cite>hop size</cite>.</li>
<li><strong>fft_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of the FFT, (STFT has <cite>fft_size // 2 + 1</cite> frequency bins).</li>
<li><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Analysis window, can be either <cite>hanning</cite> or <cite>hamming</cite>.</li>
<li><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <cite>True</cite>, then it is assumed that the time-domain signal has centered frames.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Time domain sequence of size <cite>batch_size x sample_size</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="quantized-neural-network-layers">
<h3>Quantized Neural Network Layers<a class="headerlink" href="#quantized-neural-network-layers" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.binary_sigmoid">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_sigmoid</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_sigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise binary sigmoid function. In the forward pass, it computes</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = \begin{cases}
    1 &amp; (x &gt; 0) \\
    0 &amp; ({\rm otherwise})\end{cases},\end{split}\]</div>
<p>but in the backward pass, a straight-through approximation of the gradient
is used, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial f(x)}{\partial x} =
\begin{cases}
    0 &amp; (|x| \geq 1) \\
    \frac{1}{2} &amp; ({\rm otherwise})
\end{cases}.\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1602.02830">Courbariaux, Matthieu, and Yoshua Bengio. Binarynet: Training deep
neural networks with weights and activations constrained to+ 1 or-1.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Output.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.binary_tanh">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_tanh</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_tanh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Element-wise binary tanh function. In the forward pass, it computes</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = \begin{cases}
    1 &amp; (x &gt; 0) \\
    -1 &amp; ({\rm otherwise})
\end{cases},\end{split}\]</div>
<p>but in the backward pass, a straight-through approximation of the gradient
is used, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial f(x)}{\partial x} =
\begin{cases}
    0 &amp; (|x| \geq 1) \\
    1 &amp; ({\rm otherwise}) \end{cases}.\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1602.02830">Courbariaux, Matthieu, and Yoshua Bengio. Binarynet: Training deep
neural networks with weights and activations constrained to+ 1 or-1.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Output.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.binary_connect_affine">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_connect_affine</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>binary_weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>quantize_zero_to=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_connect_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_connect_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>This function provides a BinaryConnect affine layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_j = \sum_{i} sign(w_{j,i}) x_i,\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{j,i}\)</span> are binarized to <span class="math notranslate nohighlight">\(sign(w_{j,i})\)</span> and,
hence, each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>. By this weight binarization, the
inner product computations do not require any multiplications anymore as
they turn into additions/subtractions.</p>
<p>This function should be used together with
<a class="reference internal" href="#nnabla.functions.batch_normalization" title="nnabla.functions.batch_normalization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">batch_normalization()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1) If you would like to share the binary weights between other
layers, please use the standard, floating value weights (<cite>weight</cite>)
and not the binary weights (<cite>binary_weight</cite>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once before
doing so, otherwise the weights and the binary weights will not be in sync.</p>
<p class="last">3) CPU and GPU implementations now use floating values for <cite>binary_weight</cite>,
since this function is for simulation purposes.</p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1511.00363">M. Courbariaux, Y. Bengio, and J.-P. David. BinaryConnect:
Training Deep Neural Networks with binary weights during propagations.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight .
[parameter]</li>
<li><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight .
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
<li><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.binary_connect_convolution">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_connect_convolution</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>binary_weight</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>pad=None</em>, <em>stride=None</em>, <em>dilation=None</em>, <em>group=1</em>, <em>quantize_zero_to=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_connect_convolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_connect_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>This function provides a BinaryConnect convolution layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_{n, a, b} = \sum_{m} \sum_{i} \sum_{j} sign(w_{n, m, i, j}) x_{m, a + i, b + j},\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{n, m, i, j}\)</span> are binarized to
<span class="math notranslate nohighlight">\(sign(w_{n, m, i, j})\)</span> and, hence,
each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>. By this weight binarization, the
inner product computations do not require any multiplications anymore as
they turn into additions/subtractions.</p>
<p>This function should be used together with <a class="reference internal" href="#nnabla.functions.batch_normalization" title="nnabla.functions.batch_normalization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">batch_normalization()</span></code></a>.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1511.00363">M. Courbariaux, Y. Bengio, and J.-P. David. BinaryConnect:
Training Deep Neural Networks with binary weights during propagations.</a></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1) If you would like to share the binary weights between other
layers, please use the standard, floating value weights (<cite>weight</cite>)
and not the binary weights (<cite>binary_weight</cite>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once before
doing so, otherwise the weights and the binary weights will not be in sync.</p>
<p class="last">3) CPU and GPU implementations now use floating values for <cite>binary_weight</cite>,
since this function is for simulation purposes.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</li>
<li><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight.
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default=``(0,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default=``1``]</li>
<li><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.binary_weight_affine">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_weight_affine</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>binary_weight</em>, <em>alpha</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>quantize_zero_to=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_weight_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_weight_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>This function provides a Binary Weight Network affine layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_j = \frac{1}{\|\mathbf{w}_j\|_{\ell_1}} \sum_{i} sign(w_{j,i}) x_i\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{j,i}\)</span> are binarized to <span class="math notranslate nohighlight">\(sign(w_{j,i})\)</span> and,
hence, each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>. By this weight binarization, the
inner product computations turn into additions/subtractions which are followed
by multiplication with the scaling factor
<span class="math notranslate nohighlight">\(\alpha_j = \frac{1}{\|\mathbf{w}_j\|_{\ell_1}}\)</span>.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1603.05279">Rastegari, Mohammad, et al. XNOR-Net: ImageNet Classification Using
Binary Convolutional Neural Networks.</a></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1) If you would like to share the binary weights with other layers, please
use the standard, floating value weights (<cite>weight</cite>) and not the binary
weights (<cite>binary_weight</cite>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once before
doing so, otherwise the weights and the binary weights will not be in sync.</p>
<p class="last">3) CPU and GPU implementations now use floating values for <cite>binary_weight</cite>,
since this function is for simulation purposes.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</li>
<li><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight.
[parameter]</li>
<li><strong>alpha</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Alpha.
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
<li><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.binary_weight_convolution">
<code class="descclassname">nnabla.functions.</code><code class="descname">binary_weight_convolution</code><span class="sig-paren">(</span><em>x</em>, <em>weight</em>, <em>binary_weight</em>, <em>alpha</em>, <em>bias=None</em>, <em>base_axis=1</em>, <em>pad=None</em>, <em>stride=None</em>, <em>dilation=None</em>, <em>group=1</em>, <em>quantize_zero_to=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_weight_convolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.binary_weight_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>This function provides a Binary Weight Network convolution layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_{n, a, b} = \frac{1}{\|\mathbf{w}_n\|_{\ell_1}} \sum_{m} \sum_{i} \sum_{j} sign(w_{n, m, i, j}) x_{m, a + i, b + j}.\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{n, m, i, j}\)</span> are binarized to
<span class="math notranslate nohighlight">\(sign(w_{n, m, i, j})\)</span> and, hence, each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>.
By this weight binarization, the inner product computations turn into
additions/subtractions which are followed by multiplication with the scaling
factor <span class="math notranslate nohighlight">\(\alpha_n = \frac{1}{\|\mathbf{w}_n\|_{\ell_1}}\)</span>.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1603.05279">Rastegari, Mohammad, et al. XNOR-Net: ImageNet Classification Using
Binary Convolutional Neural Networks.</a></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1) If you would like to share the binary weights between other standard layers, please
use the standard, floating value weights (<cite>weight</cite>)
and not the binary weights (<cite>binary_weight</cite>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once
before doing so, otherwise the weights and the binary weights will not be
in sync.</p>
<p class="last">3) CPU and GPU implementations now use floating values for <cite>binary_weight</cite>,
since this function is for simulation purposes.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</li>
<li><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</li>
<li><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight.
[parameter]</li>
<li><strong>alpha</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Alpha.
[parameter]</li>
<li><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
<li><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default=``(0,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default=``(1,) * (len(x.shape) - (base_axis+1))``]</li>
<li><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default=``1``]</li>
<li><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.fixed_point_quantize">
<code class="descclassname">nnabla.functions.</code><code class="descname">fixed_point_quantize</code><span class="sig-paren">(</span><em>x</em>, <em>sign=True</em>, <em>n=8</em>, <em>delta=0.0625</em>, <em>quantize=True</em>, <em>ste_fine_grained=True</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#fixed_point_quantize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.fixed_point_quantize" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed Point Quantize</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Indicate the signed number or the unsigned number. Default is true.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Bit width used. Note that <cite>sign</cite> consumes one bit. <span class="math notranslate nohighlight">\(n-1\)</span> is used for number representation in <cite>signed</cite> case.</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Step size.</li>
<li><strong>quantize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, quantize input, otherwise not.</li>
<li><strong>ste_fine_grained</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, STE is not 1.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.fixed_point_quantize</span></code>.</p>
</div>
<p>In the forward pass,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
    q_i= \left\{
       \begin{array}{ll}
            max &amp; if \ \ \ x_i &gt; max \\
            sign(x_i) \times floor(|x_i| \delta^{-1} + 2^{-1}) \times \delta &amp; if \ \ min \le x_i \le max \\
            min &amp; if \ \ x_i &lt; min \\
       \end{array} \right.,
\end{equation}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is the step size,
<span class="math notranslate nohighlight">\((min, max) :=(- (2^{n-1} - 1)\delta, (2^{n-1} - 1)\delta)\)</span> if <span class="math notranslate nohighlight">\(sign\)</span> is true,
<span class="math notranslate nohighlight">\((min, max) := (0, (2^n - 1) \delta)\)</span> otherwise, and
<span class="math notranslate nohighlight">\(n\)</span> is the total bit-width used.</p>
<p>In the backward pass when using <cite>ste_fine_grained</cite> as false,</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
    \frac{\partial q_i}{\partial x_i} = 1.
\end{equation}\]</div>
<p>In the backward pass when using <cite>ste_fine_grained</cite> as true,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
    \frac{\partial q_i}{\partial x_i}= \left\{
            \begin{array}{ll}
                        0 &amp; if \ \ \ x_i &gt; max \\
                    1 &amp; if \ \ min \le x_i \le max \\
                    0 &amp; if \ \ x_i &lt; min \\
            \end{array} \right..
\end{equation}\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Quantized values are stored as floating point number, since this function is for simulation purposes.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.pow2_quantize">
<code class="descclassname">nnabla.functions.</code><code class="descname">pow2_quantize</code><span class="sig-paren">(</span><em>x</em>, <em>sign=True</em>, <em>with_zero=True</em>, <em>n=8</em>, <em>m=1</em>, <em>quantize=True</em>, <em>ste_fine_grained=True</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#pow2_quantize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.pow2_quantize" title="Permalink to this definition">¶</a></dt>
<dd><p>Pow2 Quantize</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Indicate the signed number or the unsigned number. Default is true.</li>
<li><strong>with_zero</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Indicate using zero as a quantized value. Default is true. Note that <cite>zero</cite> consumes one bit.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Bit width used. Note that <cite>sign</cite> consumes one bit. <span class="math notranslate nohighlight">\(n-1\)</span> is used for number representation in <cite>signed</cite> case. Default is 8.</li>
<li><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(2^m\)</span> is the upper bound of the dynamic range and <span class="math notranslate nohighlight">\(-2^m\)</span> is the lower bound, <span class="math notranslate nohighlight">\(m \in \mathcal{Z}\)</span>. Default is 1.</li>
<li><strong>quantize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, quantize input, otherwise not.</li>
<li><strong>ste_fine_grained</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, STE is not 1.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.pow2_quantize</span></code>.</p>
</div>
<p>In the forward pass of <cite>signed</cite> case,</p>
<div class="math notranslate nohighlight">
\[\begin{split}q_i= \left\{
    \begin{array}{ll}
                 max_{+} &amp; if \ \ \overline{q_i} &gt; max_{+} \\
                 \overline{q_i} &amp; if \ \ min_{+} \le \overline{q_i} \le max_{+} \\
           min_{+} &amp; if \ \ 0 \le \overline{q_i} &lt; min_{+} \\
           min_{-} &amp; if \ \ min_{-} &lt; \overline{q_i} &lt; 0 \\
           \overline{q_i} &amp; if \ \ max_{-} \le \overline{q_i} \le min_{-}\\
         max_{-} &amp; if \ \ \overline{q_i} &lt; max_{-} \\
    \end{array} \right.,\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;&amp; max_{+} = 2^{m}, min_{+} = 2^{m - (2^{n-1} - 1)},\\
&amp;&amp; max_{-} = -2^{m}, min_{-} = -2^{m - (2^{n-1} - 1)},\\
&amp;&amp; \overline{q_i} = sign(x_i) \times 2^{round(\log_2 |x_i|)}.\end{split}\]</div>
<p>This quantization uses the geometric mean between two power-of-two numbers
as quantization threshold.</p>
<p>In the forward pass of <cite>unsigned</cite> case,</p>
<div class="math notranslate nohighlight">
\[\begin{split}q_i= \left\{
    \begin{array}{ll}
                 max &amp; if \ \ \overline{q_i} &gt; max \\
                 \overline{q_i} &amp; if \ \ min \le \overline{q_i} \le max \\
           min &amp; if \ \ 0 &lt; \overline{q_i} &lt; min \\
    \end{array} \right.,\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;&amp; max = 2^{m}, min = 2^{m - (2^{n} - 1)},\\
&amp;&amp; \overline{q_i} = 2^{int(\log_2 |x_i|)}.\end{split}\]</div>
<p>When using <cite>with_zero</cite> as true, a pruning threshold is used to round an input to
0 or <span class="math notranslate nohighlight">\(min\)</span>. The pruning threshold is defined in this function as the following,</p>
<div class="math notranslate nohighlight">
\[pruning\ threshold = min \times 2^{-\frac{1}{2}}.\]</div>
<p>If an absolute value of the input is lesser than this value, the input is rounded to 0, otherwise <span class="math notranslate nohighlight">\(min\)</span>.</p>
<p>In the backward pass when using ste_fine_grained as false,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial q_i}{\partial x_i} = 1.\]</div>
<p>In the backward pass when using ste_fine_grained as true,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial q_i}{\partial x_i}= \left\{
   \begin{array}{ll}
            0 &amp; if \ \ \overline{q_i} &gt; max_{+} \\
                1 &amp; if \ \ otherwise \\
        0 &amp; if \ \ \overline{q_i} &lt; max_{-} \\
   \end{array} \right..\end{split}\]</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.prune">
<code class="descclassname">nnabla.functions.</code><code class="descname">prune</code><span class="sig-paren">(</span><em>x</em>, <em>rate=0.9</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#prune"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune the input as the following equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}q_i = \left \{
  \begin{array}{ll}
  0   &amp; abs(x_i) &lt; threshold \\
  x_i &amp; otherwise
  \end{array}
  \right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(threshold\)</span> is determined by <cite>threshold = np.sort(np.abs(x))[int((x.size - 1) * rate)]</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</li>
<li><strong>rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Sparse rate, or pruning rate.
[default=``0.9``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array with the same shape as x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="unsupported-special-use">
<h3>Unsupported, Special Use<a class="headerlink" href="#unsupported-special-use" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.vat_noise">
<code class="descclassname">nnabla.functions.</code><code class="descname">vat_noise</code><span class="sig-paren">(</span><em>x</em>, <em>w</em>, <em>base_axis=1</em>, <em>eps=1.0</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#vat_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.vat_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Noise for virtual adversarial training.</p>
<p>This layer is a special layer for GUI network designing, specialized for getting
the noise of virtual adversarial training.</p>
<p>In the backward process, the weight parameter will be replaced with the gradient.</p>
<p>Forward</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{\epsilon x_i}{\sqrt{\sum_k x_k^2 + c}}\]</div>
<p>Backward</p>
<div class="math notranslate nohighlight">
\[\delta x_i = 0\]</div>
<div class="math notranslate nohighlight">
\[w_i = \epsilon \delta y_i\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This layer is a special layer for GUI network designing.</p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1507.00677">Miyato et.al, Distributional Smoothing with Virtual Adversarial Training.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of noise input. Noise is standard Gaussian noise initially, but the next step, fed back gradient variable.</li>
<li><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array for keep gradient values.</li>
<li><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default=``1``]</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Noise norm (l2) factor.
[default=``1.0``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">N-D array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.unlink">
<code class="descclassname">nnabla.functions.</code><code class="descname">unlink</code><span class="sig-paren">(</span><em>x</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#unlink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.unlink" title="Permalink to this definition">¶</a></dt>
<dd><p>This function behaves as an identity function on the forward pass,
and deletes the gradient for the background pass.</p>
<p>This layer is a special layer for GUI network designing, used for getting
zero backward operation by adding this layer.</p>
<p>Forward</p>
<div class="math notranslate nohighlight">
\[y_i = x_i\]</div>
<p>Backward</p>
<div class="math notranslate nohighlight">
\[\delta x_i = 0\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This layer is a special layer for GUI network designing.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N-D array.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="nnabla.functions.sink">
<code class="descclassname">nnabla.functions.</code><code class="descname">sink</code><span class="sig-paren">(</span><em>*x</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.sink" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dummy variable used to call forward or backward function
of multiple variables at one place.</p>
<p>This takes any numbers of input variables with any shape,
and creates a single 0-shape outputs.
The forward pass does nothing. The backward pass set ones
to the input grads if one_input_grad is set as true.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">sink</span></code> can only be called at the very end of the graph, and
<code class="docutils literal notranslate"><span class="pre">grad</span></code> of input variables are cleared</p>
<blockquote class="last">
<div>when <code class="docutils literal notranslate"><span class="pre">y.backward(clear_buffer=True)</span></code> is called.</div></blockquote>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Any number of inputs with any shape.
[variadic]</li>
<li><strong>one_input_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Set grads of inputs as one during backward. It is useful to set false if you want to set external gradients to the input variables.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dummy variable.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="image-object-detection">
<h3>Image Object Detection<a class="headerlink" href="#image-object-detection" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.nms_detection2d">
<code class="descclassname">nnabla.functions.</code><code class="descname">nms_detection2d</code><span class="sig-paren">(</span><em>x</em>, <em>thresh=None</em>, <em>nms=None</em>, <em>nms_per_class=None</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#nms_detection2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.nms_detection2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-Maximum Suppression (NMS) to 2D Object detector output.
The input is a 3-dimensional tensor with shape of <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">N,</span> <span class="pre">5</span> <span class="pre">+</span> <span class="pre">C)</span></code>
where <code class="docutils literal notranslate"><span class="pre">B</span></code> denotes batch size, <code class="docutils literal notranslate"><span class="pre">N</span></code> denotes the number of detection box
candidates, and <code class="docutils literal notranslate"><span class="pre">C</span></code> denotes the number of classes of object detection.
<code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">+</span> <span class="pre">C</span></code> consists of the box coordinates <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">w,</span> <span class="pre">h</span></code> in normalized
coordinates (size of each x and y are 1.0), objectness
(learned to predict IoU value to ground truth box), and the class</p>
<blockquote>
<div>probabilities of <code class="docutils literal notranslate"><span class="pre">C</span></code> classes.</div></blockquote>
<p>It outputs a tensor with the same dimensions as the input, where all
values are copied from the input to the output, except the class
probabilities are multiplied by objectness, and possibly suppressed to 0
by NMS.
During NMS, all of combination of pairs of bounding boxes is compared.
For each pair, the bounding box with a lower detection score
(described below) is suppressed if the overlap ratio (the IoU)
is greater than the value of <code class="docutils literal notranslate"><span class="pre">nms</span></code>.</p>
<p>There are two suppression modes for NMS.</p>
<p>1. Suppress by class probability (<code class="docutils literal notranslate"><span class="pre">nms_per_class</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>):
For each bounding box, the detection score is calculated by
<code class="docutils literal notranslate"><span class="pre">objectness</span> <span class="pre">*</span> <span class="pre">probability[class_id]</span></code> for each class.
The suppression is done for each class independently.</p>
<p>2. Suppress by objectness (<code class="docutils literal notranslate"><span class="pre">nms_per_class</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>):
The suppression is done for each bounding box using <code class="docutils literal notranslate"><span class="pre">objectness</span></code>
as a detection score. All class probabilities becomes 0 for
every suppressed boxes.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/abs/1612.08242">Joseph Redmon, Ali Farhadi, YOLO9000: Better, Faster, Stronger.</a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A 3-dimensional array.</li>
<li><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Detection score threshold.
[default=``0.5``]</li>
<li><strong>nms</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – IoU threshold for Non-maximum suppression (NMS).
[default=``0.45``]</li>
<li><strong>nms_per_class</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, NMS is applied for each class.
[default=``True``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A 3-dim array with the same dimensions with the input.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="validation">
<h3>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nnabla.functions.top_n_error">
<code class="descclassname">nnabla.functions.</code><code class="descname">top_n_error</code><span class="sig-paren">(</span><em>x</em>, <em>target</em>, <em>axis=None</em>, <em>n=1</em>, <em>n_outputs=-1</em>, <em>outputs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#top_n_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.functions.top_n_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Top N error along the dimension specified by the axis, the element of outputs is</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i = \left \{
\begin{array}{l}
1 \ (x_i \ is \ not \ within \ N-th \ place) \\
0 \ (x_i \ is \ within \ N-th \ place)
\end{array}
\right.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Probabilities N-D array. <span class="math notranslate nohighlight">\(D_1 \times ... \times D_i \times ... \times D_N\)</span></li>
<li><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. <span class="math notranslate nohighlight">\(D_1 \times ... \times 1 \times ... \times D_N\)</span></li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis on which the top N error is calculated.
[default=``len(x.shape) - 1``]</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – top N
[default=``1``]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Element-wise error N-D array. (<span class="math notranslate nohighlight">\(D_1 \times ... \times 1 \times ... \times D_N\)</span>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable">Variable</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parametric_function.html" class="btn btn-neutral float-right" title="Parametric Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="variable.html" class="btn btn-neutral float-left" title="Variable" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Sony Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>