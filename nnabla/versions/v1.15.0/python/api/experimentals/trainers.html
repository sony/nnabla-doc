

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trainers &mdash; Neural Network Libraries 1.15.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Mixed Precision Trainings" href="mixed_precision_trainings.html" />
    <link rel="prev" title="Graph Converters" href="graph_converters.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Neural Network Libraries
          

          
          </a>

          
            
            
              <div class="version">
                1.15.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../python.html">Python Package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation.html">Python Package Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial.html">Python API Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../command_line_interface.html">Python Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html">Python API Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../api.html">Python API Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../common.html">Common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nd_array.html">NdArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../variable.html">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation_graph.html">Computation Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../function.html">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../parametric_function.html">Parametric Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grad.html">Grad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../solver.html">Solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../communicator.html">Communicator API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitor.html">Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils.html">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ext.html">Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models.html">Pretrained Models</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../experimental.html">Experimental</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="viewers.html">Viewers</a></li>
<li class="toctree-l4"><a class="reference internal" href="graph_converters.html">Graph Converters</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Trainers</a></li>
<li class="toctree-l4"><a class="reference internal" href="mixed_precision_trainings.html">Mixed Precision Trainings</a></li>
<li class="toctree-l4"><a class="reference internal" href="parametric_function_classes.html">Parametric Function Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_exchange_file_format.html">Data exchange file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../file_format_converter/file_format_converter.html">File format converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support_status.html">Support Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Neural Network Libraries</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../python.html">Python Package</a> &raquo;</li>
        
          <li><a href="../../api.html">Python API Reference</a> &raquo;</li>
        
          <li><a href="../experimental.html">Experimental</a> &raquo;</li>
        
      <li>Trainers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/python/api/experimentals/trainers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trainers">
<h1>Trainers<a class="headerlink" href="#trainers" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="nnabla.experimental.trainers.Trainer">
<em class="property">class </em><code class="sig-prename descclassname">nnabla.experimental.trainers.</code><code class="sig-name descname">Trainer</code><span class="sig-paren">(</span><em class="sig-param">updater=None</em>, <em class="sig-param">evaluator=None</em>, <em class="sig-param">model_save_path=None</em>, <em class="sig-param">max_epoch=1</em>, <em class="sig-param">iter_per_epoch=None</em>, <em class="sig-param">callback_on_start=&lt;function Trainer.&lt;lambda&gt;&gt;</em>, <em class="sig-param">callback_on_finish=&lt;function Trainer.&lt;lambda&gt;&gt;</em>, <em class="sig-param">update_callback_on_start=&lt;function Trainer.&lt;lambda&gt;&gt;</em>, <em class="sig-param">update_callback_on_finish=&lt;function Trainer.&lt;lambda&gt;&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nnabla/experimental/trainers/trainer.html#Trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.experimental.trainers.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Trainer API</p>
<p>Trainer class is the very basic class for training neural network. You can composite this class to your own trainer class and delegate the train method of this class to your class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>updater</strong> (<a class="reference internal" href="#nnabla.experimental.trainers.Updater" title="nnabla.experimental.trainers.Updater"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Updater</span></code></a> or list of <a class="reference internal" href="#nnabla.experimental.trainers.Updater" title="nnabla.experimental.trainers.Updater"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Updater</span></code></a>) – Updater object.</p></li>
<li><p><strong>evaluator</strong> (<a class="reference internal" href="#nnabla.experimental.trainers.Evaluator" title="nnabla.experimental.trainers.Evaluator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Evaluator</span></code></a> or list of <a class="reference internal" href="#nnabla.experimental.trainers.Evaluator" title="nnabla.experimental.trainers.Evaluator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Evaluator</span></code></a>) – Evaluator object.</p></li>
<li><p><strong>model_save_path</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Model save path.</p></li>
<li><p><strong>max_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Max epoch to train.</p></li>
<li><p><strong>iter_per_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Iterations per one epoch.</p></li>
<li><p><strong>callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before the trainer.train.</p></li>
<li><p><strong>callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after the trainer.train.</p></li>
<li><p><strong>update_callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before the updater.update.</p></li>
<li><p><strong>update_callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after the updater.update.</p></li>
</ul>
</dd>
</dl>
<p>The following example is a complete snippet to use this base trainer.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">nnabla.parametric_functions</span> <span class="k">as</span> <span class="nn">PF</span>
<span class="kn">import</span> <span class="nn">nnabla.solvers</span> <span class="k">as</span> <span class="nn">S</span>

<span class="kn">from</span> <span class="nn">nnabla.monitor</span> <span class="kn">import</span> <span class="n">Monitor</span><span class="p">,</span> <span class="n">MonitorSeries</span><span class="p">,</span> <span class="n">MonitorTimeElapsed</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">nnabla.experimental.trainers</span> <span class="kn">import</span> <span class="n">Trainer</span><span class="p">,</span> <span class="n">Updater</span><span class="p">,</span> <span class="n">Evaluator</span>

<span class="c1"># Batch, channel, height, width</span>
<span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span>

<span class="c1"># Train Input</span>
<span class="n">tinput</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
<span class="n">tlabel</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>

<span class="c1"># Train Model and Loss</span>
<span class="n">tpred</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">training</span> <span class="n">model</span><span class="o">&gt;.</span><span class="n">apply</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tloss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">softmax_cross_entropy</span><span class="p">(</span><span class="n">tpred</span><span class="p">,</span> <span class="n">tlabel</span><span class="p">))</span>

<span class="c1"># Test Input</span>
<span class="n">vinput</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
<span class="n">vlabel</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>

<span class="c1"># Test Model and Error</span>
<span class="n">vpred</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">evaluation</span> <span class="n">model</span><span class="o">&gt;.</span><span class="n">apply</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vloss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">softmax_cross_entropy</span><span class="p">(</span><span class="n">vpred</span><span class="p">,</span> <span class="n">vlabel</span><span class="p">))</span>
<span class="n">verror</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">top_n_error</span><span class="p">(</span><span class="n">vpred</span><span class="o">.</span><span class="n">get_unlinked_variable</span><span class="p">(),</span> <span class="n">vlabel</span><span class="p">))</span>

<span class="c1"># Solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
<span class="n">solver</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">())</span>

<span class="c1"># DataIterator</span>
<span class="n">tdata</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">training_data_iterator</span><span class="o">&gt;</span>
<span class="n">vdata</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">validation_data_iterator</span><span class="o">&gt;</span>

<span class="c1"># Monitor</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">(</span><span class="o">&lt;</span><span class="n">monitor_path</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">monitor_loss</span> <span class="o">=</span> <span class="n">MonitorSeries</span><span class="p">(</span><span class="s2">&quot;Training loss&quot;</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">monitor_err</span> <span class="o">=</span> <span class="n">MonitorSeries</span><span class="p">(</span><span class="s2">&quot;Training error&quot;</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">monitor_time</span> <span class="o">=</span> <span class="n">MonitorTimeElapsed</span><span class="p">(</span><span class="s2">&quot;Training time&quot;</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">monitor_verr</span> <span class="o">=</span> <span class="n">MonitorSeries</span><span class="p">(</span><span class="s2">&quot;Valid error&quot;</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Updater</span>
<span class="k">def</span> <span class="nf">tdata_feeder</span><span class="p">():</span>
    <span class="n">tinput</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">tlabel</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">update_callback_on_finish</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">monitor_loss</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">tloss</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
    <span class="n">monitor_time</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">updater</span> <span class="o">=</span> <span class="n">Updater</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">tloss</span><span class="p">,</span>
                  <span class="n">data_feeder</span><span class="o">=</span><span class="n">tdata_feeder</span><span class="p">,</span>
                  <span class="n">update_callback_on_finish</span><span class="o">=</span><span class="n">update_callback_on_finish</span><span class="p">)</span>

<span class="c1"># Evaluator</span>
<span class="k">def</span> <span class="nf">vdata_feeder</span><span class="p">():</span>
    <span class="n">vinput</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">vlabel</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">vdata</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">eval_callback_on_finish</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ve</span><span class="p">):</span>
    <span class="n">monitor_verr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ve</span><span class="p">)</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">verror</span><span class="p">,</span>
                      <span class="n">data_feeder</span><span class="o">=</span><span class="n">vdata_feeder</span><span class="p">,</span>
                      <span class="n">val_iter</span><span class="o">=</span><span class="n">vdata</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="n">b</span><span class="p">,</span>
                      <span class="n">callback_on_finish</span><span class="o">=</span><span class="n">eval_callback_on_finish</span><span class="p">)</span>

<span class="c1"># Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">updater</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">model_save_path</span><span class="o">&gt;</span><span class="p">,</span>
                  <span class="n">max_epoch</span><span class="o">=&lt;</span><span class="n">max_epoch</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">iter_per_epoch</span><span class="o">=</span><span class="n">tdata</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="n">b</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nnabla.experimental.trainers.NaiveClassificationTrainer">
<em class="property">class </em><code class="sig-prename descclassname">nnabla.experimental.trainers.</code><code class="sig-name descname">NaiveClassificationTrainer</code><span class="sig-paren">(</span><em class="sig-param">solver</em>, <em class="sig-param">tinput=None</em>, <em class="sig-param">tlabel=None</em>, <em class="sig-param">tpred=None</em>, <em class="sig-param">tdata=None</em>, <em class="sig-param">vinput=None</em>, <em class="sig-param">vlabel=None</em>, <em class="sig-param">vpred=None</em>, <em class="sig-param">vdata=None</em>, <em class="sig-param">monitor_path=None</em>, <em class="sig-param">model_save_path=None</em>, <em class="sig-param">max_epoch=1</em>, <em class="sig-param">iter_per_epoch=None</em>, <em class="sig-param">val_iter=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nnabla/experimental/trainers/trainer.html#NaiveClassificationTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.experimental.trainers.NaiveClassificationTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Naive Classification Trainer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Solver</span></code>) – Solver object.</p></li>
<li><p><strong>tinput</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Input variable for input feature in training.</p></li>
<li><p><strong>tlabel</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Label variable for lable in training.</p></li>
<li><p><strong>tpred</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Root variable for prediction in the training graph.</p></li>
<li><p><strong>tdata</strong> (<a class="reference internal" href="../utils/data_iterator.html#nnabla.utils.data_iterator.DataIterator" title="nnabla.utils.data_iterator.DataIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.utils.data_iterator.DataIterator</span></code></a>) – DataIterator for training.</p></li>
<li><p><strong>vinput</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Input variable for input feature in evaluation.</p></li>
<li><p><strong>vlabel</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Label variable for label in evaluation.</p></li>
<li><p><strong>vpred</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Root variable for prediction in the evaluation graph.</p></li>
<li><p><strong>vdata</strong> (<a class="reference internal" href="../utils/data_iterator.html#nnabla.utils.data_iterator.DataIterator" title="nnabla.utils.data_iterator.DataIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataIterator</span></code></a>) – DataIterator for evaluation.</p></li>
<li><p><strong>monitor_path</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Monitor path.</p></li>
<li><p><strong>model_save_path</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Model save path.</p></li>
<li><p><strong>max_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Max epoch to train.</p></li>
<li><p><strong>iter_per_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Iterations per one epoch. If not set, this value are determined by <code class="xref any docutils literal notranslate"><span class="pre">tdata.size</span> <span class="pre">//</span> <span class="pre">tdata.batch_size</span></code>.</p></li>
<li><p><strong>val_iter</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Iterations for evaluation. If not set, this value are determined by <code class="xref any docutils literal notranslate"><span class="pre">vdata.size</span> <span class="pre">//</span> <span class="pre">vdata.batch_size</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>The following example is a complete snippet to use this base trainer.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">nnabla.parametric_functions</span> <span class="k">as</span> <span class="nn">PF</span>
<span class="kn">import</span> <span class="nn">nnabla.solvers</span> <span class="k">as</span> <span class="nn">S</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">nnabla.experimental.trainers</span> <span class="kn">import</span> <span class="n">NaiveClassificationTrainer</span>

<span class="c1"># Batch, channel, height, width</span>
<span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span>

<span class="c1"># Train Input</span>
<span class="n">tinput</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
<span class="n">tlabel</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>

<span class="c1"># Train Model and Loss</span>
<span class="n">tpred</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">training</span> <span class="n">model</span><span class="o">&gt;</span>

<span class="c1"># Test Input</span>
<span class="n">vinput</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>

<span class="c1"># Test Model</span>
<span class="n">vpred</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">evaluation</span> <span class="n">model</span><span class="o">&gt;</span>

<span class="c1"># Solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
<span class="n">solver</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">())</span>

<span class="c1"># DataIterator</span>
<span class="n">tdata</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">training_data_iterator</span><span class="o">&gt;</span>
<span class="n">vdata</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">validation_data_iterator</span><span class="o">&gt;</span>

<span class="c1"># Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">NaiveClassificationTrainer</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span>
                                     <span class="n">tinput</span><span class="p">,</span> <span class="n">tlabel</span><span class="p">,</span> <span class="n">tpred</span><span class="p">,</span> <span class="n">tdata</span><span class="p">,</span>
                                     <span class="n">vinput</span><span class="p">,</span> <span class="n">vlabel</span><span class="p">,</span> <span class="n">vpred</span><span class="p">,</span> <span class="n">vdata</span><span class="p">,</span>
                                     <span class="o">&lt;</span><span class="n">monitor_path</span><span class="o">&gt;</span><span class="p">,</span>
                                     <span class="o">&lt;</span><span class="n">model_save_path</span><span class="o">&gt;</span><span class="p">,</span>
                                     <span class="n">max_epoch</span><span class="o">=&lt;</span><span class="n">max_epoch</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nnabla.experimental.trainers.NaiveRegressionTrainer">
<em class="property">class </em><code class="sig-prename descclassname">nnabla.experimental.trainers.</code><code class="sig-name descname">NaiveRegressionTrainer</code><span class="sig-paren">(</span><em class="sig-param">solver</em>, <em class="sig-param">tinput=None</em>, <em class="sig-param">tlabel=None</em>, <em class="sig-param">tpred=None</em>, <em class="sig-param">tdata=None</em>, <em class="sig-param">vinput=None</em>, <em class="sig-param">vlabel=None</em>, <em class="sig-param">vpred=None</em>, <em class="sig-param">vdata=None</em>, <em class="sig-param">monitor_path=None</em>, <em class="sig-param">model_save_path=None</em>, <em class="sig-param">max_epoch=1</em>, <em class="sig-param">iter_per_epoch=None</em>, <em class="sig-param">val_iter=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nnabla/experimental/trainers/trainer.html#NaiveRegressionTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.experimental.trainers.NaiveRegressionTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Naive Regression Trainer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Solver</span></code>) – Solver object.</p></li>
<li><p><strong>tinput</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Input variable for input feature in training.</p></li>
<li><p><strong>tlabel</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Label variable for lable in training.</p></li>
<li><p><strong>tpred</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Root variable for prediction in the training graph.</p></li>
<li><p><strong>tdata</strong> (<a class="reference internal" href="../utils/data_iterator.html#nnabla.utils.data_iterator.DataIterator" title="nnabla.utils.data_iterator.DataIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.utils.data_iterator.DataIterator</span></code></a>) – DataIterator for training.</p></li>
<li><p><strong>vinput</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Input variable for input feature in evaluation.</p></li>
<li><p><strong>vlabel</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Label variable for label in evaluation.</p></li>
<li><p><strong>vpred</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Root variable for prediction in the evaluation graph.</p></li>
<li><p><strong>vdata</strong> (<a class="reference internal" href="../utils/data_iterator.html#nnabla.utils.data_iterator.DataIterator" title="nnabla.utils.data_iterator.DataIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataIterator</span></code></a>) – DataIterator for evaluation.</p></li>
<li><p><strong>monitor_path</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Monitor path.</p></li>
<li><p><strong>model_save_path</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Model save path.</p></li>
<li><p><strong>max_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Max epoch to train.</p></li>
<li><p><strong>iter_per_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Iterations per one epoch. If not set, this value are determined by <code class="xref any docutils literal notranslate"><span class="pre">tdata.size</span> <span class="pre">//</span> <span class="pre">tdata.batch_size</span></code>.</p></li>
<li><p><strong>val_iter</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Iterations for evaluation. If not set, this value are determined by <code class="xref any docutils literal notranslate"><span class="pre">vdata.size</span> <span class="pre">//</span> <span class="pre">vdata.batch_size</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">nnabla.parametric_functions</span> <span class="k">as</span> <span class="nn">PF</span>
<span class="kn">import</span> <span class="nn">nnabla.solvers</span> <span class="k">as</span> <span class="nn">S</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">nnabla.experimental.trainers</span> <span class="kn">import</span> <span class="n">NaiveRegressionTrainer</span>

<span class="c1"># Batch, channel, height, width</span>
<span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span>

<span class="c1"># Train Input</span>
<span class="n">tinput</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
<span class="n">tlabel</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>

<span class="c1"># Train Model and Loss</span>
<span class="n">tpred</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">training</span> <span class="n">model</span><span class="o">&gt;</span>

<span class="c1"># Test Input</span>
<span class="n">vinput</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
<span class="n">vlabel</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>

<span class="c1"># Test Model</span>
<span class="n">vpred</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">evaluation</span> <span class="n">model</span><span class="o">&gt;</span>

<span class="c1"># Solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
<span class="n">solver</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">())</span>

<span class="c1"># DataIterator</span>
<span class="n">tdata</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">training_data_iterator</span><span class="o">&gt;</span>
<span class="n">vdata</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">validation_data_iterator</span><span class="o">&gt;</span>

<span class="c1"># Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">NaiveRegressionTrainer</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span>
                                 <span class="n">tinput</span><span class="p">,</span> <span class="n">tlabel</span><span class="p">,</span> <span class="n">tpred</span><span class="p">,</span> <span class="n">tdata</span><span class="p">,</span>
                                 <span class="n">vinput</span><span class="p">,</span> <span class="n">vlabel</span><span class="p">,</span> <span class="n">vpred</span><span class="p">,</span> <span class="n">vdata</span><span class="p">,</span>
                                 <span class="o">&lt;</span><span class="n">monitor_path</span><span class="o">&gt;</span><span class="p">,</span>
                                 <span class="o">&lt;</span><span class="n">model_save_path</span><span class="o">&gt;</span><span class="p">,</span>
                                 <span class="n">max_epoch</span><span class="o">=&lt;</span><span class="n">max_epoch</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="nnabla.experimental.trainers.Updater">
<em class="property">class </em><code class="sig-prename descclassname">nnabla.experimental.trainers.</code><code class="sig-name descname">Updater</code><span class="sig-paren">(</span><em class="sig-param">solver=None</em>, <em class="sig-param">loss=None</em>, <em class="sig-param">data_feeder=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">forward_callback_on_start=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">forward_callback_on_finish=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">backward_callback_on_start=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">backward_callback_on_finish=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">comm_callback_on_start=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">comm_callback_on_finish=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">update_callback_on_start=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">update_callback_on_finish=&lt;function Updater.&lt;lambda&gt;&gt;</em>, <em class="sig-param">clear_buffer=True</em>, <em class="sig-param">accum_grad=1</em>, <em class="sig-param">comm=None</em>, <em class="sig-param">grads=[]</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nnabla/experimental/trainers/updater.html#Updater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.experimental.trainers.Updater" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> (<a class="reference internal" href="../solver.html#nnabla.solvers.Solver" title="nnabla.solvers.Solver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.solvers.Solver</span></code></a>) – Solver object. E.g., Momentum or Adam.</p></li>
<li><p><strong>loss</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>) – Loss variable from which the forward and the backward is called.</p></li>
<li><p><strong>data_feeder</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, or lambda) – Data feeder.</p></li>
<li><p><strong>forward_callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before forward function.</p></li>
<li><p><strong>forward_callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after forward function.</p></li>
<li><p><strong>backward_callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before backward function.</p></li>
<li><p><strong>backward_callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after backward function.</p></li>
<li><p><strong>comm_callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before comm.all_reduce.</p></li>
<li><p><strong>comm_callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after comm.all_reduce.</p></li>
<li><p><strong>update_callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before update function.</p></li>
<li><p><strong>update_callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after update function.</p></li>
<li><p><strong>clear_buffer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Clears the no longer referenced variables during backpropagation to save memory.</p></li>
<li><p><strong>accum_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Number of accumulation of gradients. Update method of the <a class="reference internal" href="../../tutorial/python_api.html#solver"><span class="std std-ref">Solver</span></a> is called after the <a class="reference internal" href="mixed_precision_trainings.html#nnabla.experimental.mixed_precision_training.DynamicLossScalingUpdater.accum_grad" title="nnabla.experimental.mixed_precision_training.DynamicLossScalingUpdater.accum_grad"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">accum_grad</span></code></a> number of the forward and backward is called. Default is 1.</p></li>
<li><p><strong>comm</strong> (<a class="reference internal" href="../communicator.html#nnabla.communicators.Communicator" title="nnabla.communicators.Communicator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.communicators.Communicator</span></code></a>, optional) – Communicator when to do distributed training. Default is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>grads</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="../nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.NdArray</span></code></a>, optional) – The list of gradients to be exchanged when to do distributed training. Default is the empty <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nnabla.experimental.trainers</span> <span class="kn">import</span> <span class="n">Updater</span>

<span class="n">solver</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Solver</span><span class="o">&gt;</span>
<span class="n">loss</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Loss</span> <span class="n">Variable</span> <span class="n">of</span> <span class="n">Network</span><span class="o">&gt;</span>

<span class="k">def</span> <span class="nf">tdata_feeder</span><span class="p">():</span>
    <span class="o">...</span>
<span class="k">def</span> <span class="nf">update_callback_on_finish</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">updater</span> <span class="o">=</span> <span class="n">Updater</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">tdata_feeder</span><span class="p">,</span> <span class="n">updater_callback_on_finish</span><span class="p">)</span>

<span class="c1"># Training iteration</span>
<span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">&lt;</span><span class="n">max_iter</span><span class="o">&gt;</span><span class="p">):</span>
    <span class="n">updater</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="nnabla.experimental.trainers.Updater.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nnabla/experimental/trainers/updater.html#Updater.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.experimental.trainers.Updater.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Monolithic update method.</p>
<p>This method calls the following methods with the dynamic loss scaling.</p>
<ol class="arabic simple">
<li><p>solver.zerograd</p></li>
<li><p>feed data</p></li>
<li><p>loss.forward</p></li>
<li><p>loss.backward</p></li>
<li><p>comm.all_reduce (if it is specified)</p></li>
<li><p>solver.update</p></li>
</ol>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nnabla.experimental.trainers.Evaluator">
<em class="property">class </em><code class="sig-prename descclassname">nnabla.experimental.trainers.</code><code class="sig-name descname">Evaluator</code><span class="sig-paren">(</span><em class="sig-param">vroot=None</em>, <em class="sig-param">data_feeder=None</em>, <em class="sig-param">val_iter=None</em>, <em class="sig-param">callback_on_start=&lt;function Evaluator.&lt;lambda&gt;&gt;</em>, <em class="sig-param">callback_on_finish=&lt;function Evaluator.&lt;lambda&gt;&gt;</em>, <em class="sig-param">clear_buffer=True</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nnabla/experimental/trainers/evaluator.html#Evaluator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nnabla.experimental.trainers.Evaluator" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vroot</strong> (<a class="reference internal" href="../variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>) – Root varible of the evaluation graph.</p></li>
<li><p><strong>data_feeder</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, or lambda) – Data feeder.</p></li>
<li><p><strong>val_iter</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Iterations for evaluation.</p></li>
<li><p><strong>callback_on_start</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called before the evaluator.evalute.</p></li>
<li><p><strong>callback_on_finish</strong> (callable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, function, lambda, or list of these, optional) – Callback called after the evaluator.evalute.</p></li>
<li><p><strong>clear_buffer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Clears the no longer referenced variables during backpropagation to save memory.</p></li>
<li><p><strong>comm</strong> (<a class="reference internal" href="../communicator.html#nnabla.communicators.Communicator" title="nnabla.communicators.Communicator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.communicators.Communicator</span></code></a>, optional) – Communicator when to do distributed training. Default is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nnabla.experimental.trainers</span> <span class="kn">import</span> <span class="n">Evaluator</span>

<span class="c1"># Evaluator</span>
<span class="k">def</span> <span class="nf">vdata_feeder</span><span class="p">():</span>
    <span class="o">...</span>
<span class="k">def</span> <span class="nf">eval_callback_on_finish</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ve</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">verror</span><span class="p">,</span>
                      <span class="n">data_feeder</span><span class="o">=</span><span class="n">vdata_feeder</span><span class="p">,</span>
                      <span class="n">val_iter</span><span class="o">=&lt;</span><span class="n">val_iter</span><span class="o">&gt;</span><span class="p">,</span>
                      <span class="n">callback_on_finish</span><span class="o">=</span><span class="n">eval_callback_on_finish</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mixed_precision_trainings.html" class="btn btn-neutral float-right" title="Mixed Precision Trainings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="graph_converters.html" class="btn btn-neutral float-left" title="Graph Converters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Sony Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>