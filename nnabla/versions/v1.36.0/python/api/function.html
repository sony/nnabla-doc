<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Functions &mdash; Neural Network Libraries 1.36.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parametric Functions" href="parametric_function.html" />
    <link rel="prev" title="Computation Graph" href="computation_graph.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Neural Network Libraries
          </a>
              <div class="version">
                1.36.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../python.html">Python Package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Python Package Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html">Python API Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command_line_interface.html">Python Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Python API Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">Python API Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="common.html">Common</a></li>
<li class="toctree-l3"><a class="reference internal" href="nd_array.html">NdArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="computation_graph.html">Computation Graph</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-nnabla.functions">List of Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parametric_function.html">Parametric Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="grad.html">Grad</a></li>
<li class="toctree-l3"><a class="reference internal" href="solver.html">Solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="communicator.html">Communicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="monitor.html">Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="ext.html">Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html">Pretrained Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="lms.html">Out-of-core execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="module.html">Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph_def.html">Graph Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="sequential.html">Sequential</a></li>
<li class="toctree-l3"><a class="reference internal" href="experimental.html">Experimental</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_exchange_file_format.html">Data exchange file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_format_converter/file_format_converter.html">File format converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support_status.html">Support Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Neural Network Libraries</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../python.html">Python Package</a></li>
          <li class="breadcrumb-item"><a href="../api.html">Python API Reference</a></li>
      <li class="breadcrumb-item active">Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/python/api/function.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="functions">
<span id="function"></span><h1>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h1>
<p>All NNabla functions are derived from the <a class="reference internal" href="#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.function.Function</span></code></a> class.</p>
<section id="id1">
<h2>Function<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<span class="target" id="module-nnabla.function"></span><dl class="py class">
<dt class="sig sig-object py" id="nnabla.function.Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnabla.function.</span></span><span class="sig-name descname"><span class="pre">Function</span></span><a class="headerlink" href="#nnabla.function.Function" title="Permalink to this definition"></a></dt>
<dd><p>Function interface class.</p>
<p>Instances of <a class="reference internal" href="#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.function.Function</span></code></a> are not directly created by users. It is indirectly
created by the functions available in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a>. These functions
return <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a> (s) holding the created function instance as the
parent property.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnabla.function.Function.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#nnabla.function.Function.args" title="Permalink to this definition"></a></dt>
<dd><p>Experimental</p>
<p>Get args of the function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.auto_grad_depends_input_data">
<span class="sig-name descname"><span class="pre">auto_grad_depends_input_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.auto_grad_depends_input_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.auto_grad_depends_output_data">
<span class="sig-name descname"><span class="pre">auto_grad_depends_output_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.auto_grad_depends_output_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.backward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.grad_depends_input_data">
<span class="sig-name descname"><span class="pre">grad_depends_input_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.grad_depends_input_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.grad_depends_output_data">
<span class="sig-name descname"><span class="pre">grad_depends_output_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.grad_depends_output_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnabla.function.Function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#nnabla.function.Function.info" title="Permalink to this definition"></a></dt>
<dd><p>object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>info</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.inplace_data">
<span class="sig-name descname"><span class="pre">inplace_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.inplace_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.inplace_data_with">
<span class="sig-name descname"><span class="pre">inplace_data_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.inplace_data_with" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.min_outputs">
<span class="sig-name descname"><span class="pre">min_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.min_outputs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.need_setup_recompute">
<span class="sig-name descname"><span class="pre">need_setup_recompute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.need_setup_recompute" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.recompute">
<span class="sig-name descname"><span class="pre">recompute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.recompute" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.set_active_input_mask">
<span class="sig-name descname"><span class="pre">set_active_input_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.set_active_input_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.setup" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.Function.setup_recompute">
<span class="sig-name descname"><span class="pre">setup_recompute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.Function.setup_recompute" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnabla.function.Function.tags">
<span class="sig-name descname"><span class="pre">tags</span></span><a class="headerlink" href="#nnabla.function.Function.tags" title="Permalink to this definition"></a></dt>
<dd><p>Experimental</p>
<p>Get tags of the function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnabla.function.</span></span><span class="sig-name descname"><span class="pre">PythonFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction" title="Permalink to this definition"></a></dt>
<dd><p>Creates a user-defined custom function in the subclsass.</p>
<p>To implement the naive multiplicaiton function of two variables using PythonFunction,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">nnabla.function</span> <span class="kn">import</span> <span class="n">PythonFunction</span>

<span class="k">class</span> <span class="nc">Mul2</span><span class="p">(</span><span class="n">PythonFunction</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Mul2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">def</span> <span class="nf">min_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">setup_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
        <span class="n">i0</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">i0</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">i1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;Shapes of inputs are different.&quot;</span>
        <span class="n">o0</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">o0</span><span class="o">.</span><span class="n">reset_shape</span><span class="p">(</span><span class="n">i0</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

        <span class="c1"># We can also write like, y.copy_from(x0 * x1)</span>
        <span class="n">y</span><span class="o">.</span><span class="n">copy_from</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">mul2</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">backward_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">propagate_down</span><span class="p">,</span> <span class="n">accum</span><span class="p">):</span>
        <span class="c1"># Data of inputs and outputs</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="c1"># Grads of inputs and outputs</span>
        <span class="n">dx0</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grad</span>
        <span class="n">dx1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grad</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grad</span>

        <span class="c1"># backward w.r.t. x0</span>
        <span class="k">if</span> <span class="n">propagate_down</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">accum</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">dx0</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">mul2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dx0</span><span class="o">.</span><span class="n">copy_from</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">mul2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>

        <span class="c1"># backward w.r.t. x1</span>
        <span class="k">if</span> <span class="n">propagate_down</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">accum</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">dx1</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">mul2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dx1</span><span class="o">.</span><span class="n">copy_from</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">mul2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">x0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">grad_depends_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">grad_depends_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">mul2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">Mul2</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ctx</strong> (<a class="reference internal" href="common.html#nnabla.Context" title="nnabla.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Context</span></code></a>) – Context used for the forward and backward pass. If not specified,
the current context is used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.backward_impl">
<span class="sig-name descname"><span class="pre">backward_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.backward_impl" title="Permalink to this definition"></a></dt>
<dd><p>Backward method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Inputs to the function.</p></li>
<li><p><strong>outputs</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Outputs from the function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.ctx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ctx</span></span><a class="headerlink" href="#nnabla.function.PythonFunction.ctx" title="Permalink to this definition"></a></dt>
<dd><p>Context
Return the context if the context is set in the constructor;
otherwise return the global context</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.forward_impl">
<span class="sig-name descname"><span class="pre">forward_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.forward_impl" title="Permalink to this definition"></a></dt>
<dd><p>Forward method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Inputs to the function.</p></li>
<li><p><strong>outputs</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Outputs from the function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.grad_depends_input_data">
<span class="sig-name descname"><span class="pre">grad_depends_input_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.grad_depends_input_data" title="Permalink to this definition"></a></dt>
<dd><p>Checking if i-th input’ gradient computation requires j-th input’s data or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Input variable index.</p></li>
<li><p><strong>i</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Input variable index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.grad_depends_output_data">
<span class="sig-name descname"><span class="pre">grad_depends_output_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.grad_depends_output_data" title="Permalink to this definition"></a></dt>
<dd><p>Checking if i-th input’ gradient computation requires o-th output’s data or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Input variable index.</p></li>
<li><p><strong>o</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Output variable index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.min_outputs">
<span class="sig-name descname"><span class="pre">min_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.min_outputs" title="Permalink to this definition"></a></dt>
<dd><p>Minimum number of outputs of the function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#nnabla.function.PythonFunction.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnabla.function.PythonFunction.setup_impl">
<span class="sig-name descname"><span class="pre">setup_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.function.PythonFunction.setup_impl" title="Permalink to this definition"></a></dt>
<dd><p>Setup method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Inputs to the function.</p></li>
<li><p><strong>outputs</strong> – (list of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>): Outputs from the function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-nnabla.functions">
<span id="list-of-functions"></span><span id="id2"></span><h2>List of Functions<a class="headerlink" href="#module-nnabla.functions" title="Permalink to this heading"></a></h2>
<p>The <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> module provides various types of functions listed below.
These functions takes input <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a> (s) as its leading argument(s), followed by options
specific to each function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The functions can also take <a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NdArray</span></code></a> (s) as inputs instead
of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> (s). It will execute the function operation immediately,
and returns <a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NdArray</span></code></a> (s) as output(s) holding output values of the
operation. We call this “Imperative Mode” (NdArray + Functions).</p>
</div>
<section id="neural-network-layers">
<h3>Neural Network Layers<a class="headerlink" href="#neural-network-layers" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.affine">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.affine" title="Permalink to this definition"></a></dt>
<dd><p>Affine layer, also called as the fully connected layer. It calculates:</p>
<div class="math notranslate nohighlight">
\[{\mathbf y} = {\mathbf A} {\mathbf x} + {\mathbf b}.\]</div>
<p>where <span class="math notranslate nohighlight">\({\mathbf x}\)</span> is the input and <span class="math notranslate nohighlight">\({\mathbf y}\)</span> is the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times ... \times M_{B-1} \times D_B \times ... \times D_N\)</span>). Dimensions before and after base_axis are flattened as if it is a matrix.</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight matrix with shape (<span class="math notranslate nohighlight">\((D_B \times ... \times D_N) \times L_{0} \times \ldots \times L_{I}\)</span>)
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(L_{0} \times \ldots \times L_{I}\)</span>)
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Base axis of Affine operation. Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\((B + 1)\)</span>-D array. (<span class="math notranslate nohighlight">\(M_0 \times ... \times M_{B-1} \times L_{0} \times \ldots \times L_{I}\)</span>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.convolution" title="Permalink to this definition"></a></dt>
<dd><p>N-D Convolution with bias.</p>
<p>See references for dilated convolution (a.k.a. atrous convolution).</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1606.00915">Chen et al., DeepLab: Semantic Image Segmentation with Deep Convolutional
Nets, Atrous Convolution, and Fully Connected CRFs.</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1511.07122">Yu et al., Multi-Scale Context Aggregation by Dilated Convolutions.</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convolution is a computationally intensive operation that
should preferrably be run with the <code class="xref any docutils literal notranslate"><span class="pre">cudnn</span></code> backend. NNabla
then uses CuDNN library functions to determine and cache the
fastest algorithm for the given set of convolution parameters,
which results in additional memory consumption which may pose
a problem for GPUs with insufficient memory size. In that
case, the <code class="xref any docutils literal notranslate"><span class="pre">NNABLA_CUDNN_WORKSPACE_LIMIT</span></code> environment variable
can be used to restrict the choice of algorithms to those that
fit the given workspace memory limit, expressed in bytes. In
some cases it may also be desired to restrict the automatic
search to algorithms that produce deterministic (reproducable)
results. This can be requested by setting the the environment
variable <code class="xref any docutils literal notranslate"><span class="pre">NNABLA_CUDNN_DETERMINISTIC</span></code> to a non-zero value.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((2 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C' \times C \times K_1 \times ... \times K_N\)</span>).
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i = \frac{L_i + 2 p_i - d_i (k_i - 1) - 1}{s_i} + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size, and <span class="math notranslate nohighlight">\(s_i\)</span> is the stride for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.depthwise_convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">depthwise_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#depthwise_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.depthwise_convolution" title="Permalink to this definition"></a></dt>
<dd><p>N-D Depthwise Convolution with bias.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1610.02357">F. Chollet. Xception: Deep Learning with Depthwise Separable Convolutions.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C \times K_1 \times ... \times K_N\)</span>).
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>multiplier</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of output feature maps per input feature map.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>The output map size <span class="math notranslate nohighlight">\(C'\)</span> is <span class="math notranslate nohighlight">\(C\)</span> multiplied by <span class="math notranslate nohighlight">\(m\)</span></p>
<div class="math notranslate nohighlight">
\[C' =  m \times C,\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the multiplier.</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i = \frac{L_i + 2 p_i - d_i (k_i - 1) - 1}{s_i} + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size, and <span class="math notranslate nohighlight">\(s_i\)</span> is the stride for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.deconvolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">deconvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#deconvolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.deconvolution" title="Permalink to this definition"></a></dt>
<dd><p>N-D deconvolution, also known as transposed convolution, with bias operates backward convolution (derivative of the output w.r.t. the input) plus channel-wise learned bias.</p>
<p>The weights are specified in the same manner as <a class="reference internal" href="#nnabla.functions.convolution" title="nnabla.functions.convolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convolution()</span></code></a> , as if it was an ordinary convolution function.
The forward operation of <a class="reference internal" href="#nnabla.functions.deconvolution" title="nnabla.functions.deconvolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deconvolution()</span></code></a> will then be operationally equivalent to the backward pass of <a class="reference internal" href="#nnabla.functions.convolution" title="nnabla.functions.convolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convolution()</span></code></a> .
Therefore, the number of input channels (can be seen as output channels of forward convolution) is specified in the first dimension, and the number of the output channels divided by the number of groups is specified in the second dimension.</p>
<p>For <code class="xref any docutils literal notranslate"><span class="pre">stride</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, a parameter-wise identical deconvolution on the output
of a convolution may not produce the same output shape as the input to
the convolution if, due to striding, the convolution did not fully cover
the input spatial dimension. The <code class="xref any docutils literal notranslate"><span class="pre">output_padding</span></code> parameter can then be
used to appropriately increase the calculated output shape. Note that
this is used to find the output shape for the deconvolution operation,
but not to add zero-padding to the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((2 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C \times C' \times K_1 \times ... \times K_N\)</span>).
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>output_padding</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Additional size added to the output shape.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i =s_i (L_i - 1) - 2 p_i + d_i (k_i - 1) + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(s_i\)</span> is the stride, <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, and <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.depthwise_deconvolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">depthwise_deconvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#depthwise_deconvolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.depthwise_deconvolution" title="Permalink to this definition"></a></dt>
<dd><p>Depthwise deconvolution computes the transposed depthwise convolution with bias for one-dimensional and two-dimensional input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C \times K_1 \times ... \times K_N\)</span>).
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>divisor</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of input feature maps per output feature map.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>The output map size <span class="math notranslate nohighlight">\(C'\)</span> is <span class="math notranslate nohighlight">\(C\)</span> multiplied by <span class="math notranslate nohighlight">\(m\)</span></p>
<div class="math notranslate nohighlight">
\[C' =  \frac{C}{d},\]</div>
<p>where <span class="math notranslate nohighlight">\(d\)</span> is the divisor.</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i =s_i (L_i - 1) - 2 p_i + d_i (k_i - 1) + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(s_i\)</span> is the stride, <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, and <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.deformable_convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">deformable_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deformable_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#deformable_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.deformable_convolution" title="Permalink to this definition"></a></dt>
<dd><p>2-D Deformable Convolution with bias.
Another convolution with fixed output channels must be passed externally to calculate the offsets and mask.
Mask should be normalized to <span class="math notranslate nohighlight">\([0,1]\)</span> interval.</p>
<div class="math notranslate nohighlight">
\[\begin{eqnarray}
  y(p) = \sum_{k=1}^{K} w_k \cdot x(p + p_k + \Delta p_k) \cdot \Delta m_k,
\end{eqnarray}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are input and output, <span class="math notranslate nohighlight">\(w_k\)</span> is the weight, <span class="math notranslate nohighlight">\(p\)</span> is the pixel location of interest, <span class="math notranslate nohighlight">\(p_k\)</span> is the fixed displacement e.g., <span class="math notranslate nohighlight">\(p_k \in \{(-1, -1), (-1, 0), \ldots (1, 1)\}\)</span> for the 2D 3x3 receptive field, <span class="math notranslate nohighlight">\(\Delta p_k\)</span> is the learnable displacement, and <span class="math notranslate nohighlight">\(\Delta m_k\)</span> is the learnable scale normalized in <span class="math notranslate nohighlight">\([0, 1]\)</span> by a function like the sigmoid. Note that <span class="math notranslate nohighlight">\(\Delta p_k\)</span> and <span class="math notranslate nohighlight">\(\Delta m_k\)</span> are sample-dependent, location-dependent, and feature-independent.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1703.06211">Dai et al., Deformable Convolutional Networks.</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1811.11168">Zhu et al., Deformable ConvNets v2: More Deformable, Better Results.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C \times L_1 \times ... \times L_N\)</span>).</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\((2 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(C' \times C \times K_1 \times ... \times K_N\)</span>).
[parameter]</p></li>
<li><p><strong>offset</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Offsets for deformable convolutions. Shape is fixed to <span class="math notranslate nohighlight">\((N, deformable{\_}group \times 2 \times Kh \times Kw, H, W)\)</span>. Offsets must be calculated externally through a separate convolution layer.</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Normalized mask for deformable convolutions v2. Shape is fixed to <span class="math notranslate nohighlight">\((N, deformable{\_}group \times Kh \times Kw, H, W)\)</span>. Masks must be calculated externally together with the offsets through a separate convolution layer.
[optional]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(C'\)</span>).
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – base axis <span class="math notranslate nohighlight">\(B\)</span>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>deformable_group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of deformable groups of channels.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="math notranslate nohighlight">\((B + 1 + N)\)</span>-D array (<span class="math notranslate nohighlight">\(M_1 \times ... \times M_B \times C' \times L'_1 \times ... \times L'_N\)</span>).</p>
<p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[L'_i = \frac{L_i + 2 p_i - d_i (k_i - 1) - 1}{s_i} + 1,\]</div>
<p>where <span class="math notranslate nohighlight">\(L_i\)</span> is the spatial size, <span class="math notranslate nohighlight">\(p_i\)</span> is the padding, <span class="math notranslate nohighlight">\(d_i\)</span> is the dilation, <span class="math notranslate nohighlight">\(k_i\)</span> is the kernel size, and <span class="math notranslate nohighlight">\(s_i\)</span> is the stride for <span class="math notranslate nohighlight">\(i\)</span>-th spatial dimension. The same calculation can also be applied to the other spatial dimensions.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.adaptive_separable_convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">adaptive_separable_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizontal_kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#adaptive_separable_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.adaptive_separable_convolution" title="Permalink to this definition"></a></dt>
<dd><p>2-D Adaptive Separable Convolution for NCHW (the channel-first tensor).
Sample and pixel dependent vertical and horizontal kernels are dynamically generated ones,
which are used for approximating a feature-independent 2-D kernel in this function.
Thus, the kernel used in this function is dependent on samples and pixels but independent on features.</p>
<p>If the padding is needed, use the pad function to the input <span class="math notranslate nohighlight">\(x\)</span> before this function.</p>
<p>Adaptive separable convolution is formulated as</p>
<div class="math notranslate nohighlight">
\[\tilde{I}(c, h, w) = \sum_{j, i} K_v(j, h, w) \times K_h(i, h, w) \times I(c, h + j, w + i),\]</div>
<p>where <span class="math notranslate nohighlight">\(I(c, h, w)\)</span> and <span class="math notranslate nohighlight">\(\tilde{I}(c, h, w)\)</span> are the input and output images
at <span class="math notranslate nohighlight">\(c\)</span>-th channel, <span class="math notranslate nohighlight">\(h\)</span>-th height, <span class="math notranslate nohighlight">\(w\)</span>-th width.
<span class="math notranslate nohighlight">\(K_V(:, h, w)\)</span> and <span class="math notranslate nohighlight">\(K_h(:, h, w)\)</span> are vertical and horizontal 1-D kernels
at <span class="math notranslate nohighlight">\(h\)</span>-th height and <span class="math notranslate nohighlight">\(w\)</span>-th width.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1708.01692">Simon Niklaus, Long Mai, Feng Liu,
Video Frame Interpolation via Adaptive Separable Convolution,</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1809.07759">Mart Kartasev, Carlo Rapisarda, Dominik Fay,
Implementing Adaptive Separable Convolution for Video Frame Interpolation,</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\(4-D\)</span> array (<span class="math notranslate nohighlight">\(B \times C \times H \times W\)</span>)</p></li>
<li><p><strong>vertical_kernel</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\(4-D\)</span> array (<span class="math notranslate nohighlight">\(B \times K_v \times H \times W\)</span>)</p></li>
<li><p><strong>horizontal_kernel</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – <span class="math notranslate nohighlight">\(4-D\)</span> array (<span class="math notranslate nohighlight">\(B \times K_h \times H \times W\)</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(4-D\)</span> array (<span class="math notranslate nohighlight">\(B \times C \times H - K_v + 1 \times W - K_h + 1\)</span>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.max_pooling">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">max_pooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#max_pooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.max_pooling" title="Permalink to this definition"></a></dt>
<dd><p>Max pooling. It pools the maximum values inside the scanning kernel:</p>
<div class="math notranslate nohighlight">
\[y_{i_1, i_2} = \max_{k_1, k_2 \in K} (x_{i_1 + k_1, i_2 + k_2})\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i_1 + k_1, i_2 + k_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{i_1, i_2}\)</span> is the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</p></li>
<li><p><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Subsampling factors for each spatial axis.
[default= <code class="xref any docutils literal notranslate"><span class="pre">kernel</span></code> ]</p></li>
<li><p><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If false, kernels covering borders are also considered for the output.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">len(kernel)</span></code> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum values variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.average_pooling">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">average_pooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">including_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#average_pooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.average_pooling" title="Permalink to this definition"></a></dt>
<dd><p>Average pooling. It pools the averaged values inside the scanning kernel:</p>
<div class="math notranslate nohighlight">
\[y_{i_1, i_2} = \frac{1}{K_1 K_2} \sum_{k1} \sum_{k2} x_{i_1 + k_1, i_2 + k_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i_1 + k_1, i_2 + k_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{i_1, i_2}\)</span> is the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</p></li>
<li><p><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Subsampling factors for each spatial axis.
[default= <code class="xref any docutils literal notranslate"><span class="pre">kernel</span></code> ]</p></li>
<li><p><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If false, kernels covering borders are also considered for the output.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">len(kernel)</span></code> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>including_pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, border padding values are considered for the output.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average values variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.global_average_pooling">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">global_average_pooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#global_average_pooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.global_average_pooling" title="Permalink to this definition"></a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is experimental support, so please do not actively use it.</p>
</div>
<p>Global average pooling. It pools an averaged value from the whole image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average values variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sum_pooling">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sum_pooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sum_pooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sum_pooling" title="Permalink to this definition"></a></dt>
<dd><p>Sum pooling. It pools the summed values inside the scanning kernel:</p>
<div class="math notranslate nohighlight">
\[y_{i_1, i_2} = \sum_{k1} \sum_{k2} x_{i_1 + k_1, i_2 + k_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i_1 + k_1, i_2 + k_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{i_1, i_2}\)</span> is the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</p></li>
<li><p><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Subsampling factors for each spatial axis.
[default= <code class="xref any docutils literal notranslate"><span class="pre">kernel</span></code> ]</p></li>
<li><p><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If false, kernels covering borders are also considered for the output.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">len(kernel)</span></code> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Summed values variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.unpooling">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">unpooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#unpooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.unpooling" title="Permalink to this definition"></a></dt>
<dd><p>Inverse operation of pooling. It spreads the input values:</p>
<div class="math notranslate nohighlight">
\[y_{k_1 i_1 + j_1, k_2 i_2 + j_2} = x_{i_1, i_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(_{i_1, i_2}\)</span> is the input and <span class="math notranslate nohighlight">\(y_{k_1 i_1 + j_1, k_2 i_2 + j_2}\)</span> is the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable.</p></li>
<li><p><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Kernel sizes for each spatial axis.</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spread values variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.embed">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">embed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#embed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.embed" title="Permalink to this definition"></a></dt>
<dd><p>Embed slices of a matrix/tensor with indexing array/tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Indices with shape <span class="math notranslate nohighlight">\((I_0, ..., I_N)\)</span></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weights with shape <span class="math notranslate nohighlight">\((W_0, ..., W_M)\)</span>
[parameter]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output with shape <span class="math notranslate nohighlight">\((I_0, ..., I_N, W_1, ..., W_M)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.rnn">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">rnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tanh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.rnn" title="Permalink to this definition"></a></dt>
<dd><p>RNN function implements Elman RNN with nonlinearity to input sequence.
RNN function is defined as following:</p>
<div class="math notranslate nohighlight">
\[{\mathbf h_t} = {\mathbf \tanh}( {\mathbf w_{ih}} *{\mathbf x_t} + {\mathbf b_{ih}} + {\mathbf w_{hh}}* {\mathbf h_{(t-1)}} + {\mathbf b_{hh}}).\]</div>
<p>We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(T\)</span>: sequcne length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(I\)</span>: input size, <span class="math notranslate nohighlight">\(L\)</span>: number of layers, <span class="math notranslate nohighlight">\(D\)</span>: number of directions, can be either 1 or 2, <span class="math notranslate nohighlight">\(H\)</span>: hidden size.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://crl.ucsd.edu/~elman/Papers/fsit.pdf">Jeffrey Elman, Finding Structure in Time.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((T, B, I)\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</p></li>
<li><p><strong>weight_l0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((D, H, I + H)\)</span>.
[parameter]</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L-1, D, H, D * H + H)\)</span>.
[optional][parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, H)\)</span>.
[optional][parameter]</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of layers in the network. If set to 1, only the weights for the first layer will be invoked. Default is 1.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>nonlinearity</strong> (<em>string</em>) – Type of nonlinearity applied to input sequcne. Must be either tanh or relu. Default is tanh.
[default= <code class="xref any docutils literal notranslate"><span class="pre">'tanh'</span></code> ]</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Dropout ratio applied to parameters. Default is 0.0.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, bidirectional computation will be performed in each layer. Default is False.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Backpropagation will be performed only when it is true. Default is True.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((T, B, D * H)\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.lstm">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">lstm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#lstm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.lstm" title="Permalink to this definition"></a></dt>
<dd><p>N-Step LSTM layer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\mathbf f_t} &amp;=&amp; {\mathbf \sigma}( {\mathbf W_f} *{\mathbf x_t} + {\mathbf U_f}* {\mathbf h_{(t-1)}} + {\mathbf b_f})\\
{\mathbf i_t} &amp;=&amp; {\mathbf \sigma}( {\mathbf W_i} *{\mathbf x_t} + {\mathbf U_i}* {\mathbf h_{(t-1)}} + {\mathbf b_i})\\
{\mathbf o_t} &amp;=&amp; {\mathbf \sigma}( {\mathbf W_o} *{\mathbf x_t} + {\mathbf U_o}* {\mathbf h_{(t-1)}} + {\mathbf b_o})\\
{\mathbf c_t} &amp;=&amp; {\mathbf f_t}\odot {\mathbf c_{(t-1)}} + {\mathbf i_t}\odot {\mathbf \tanh}({\mathbf W_c}*{\mathbf x_t} + {\mathbf U_c} *{\mathbf h_{(t-1)}} + {\mathbf b_c})\\
{\mathbf h_t} &amp;=&amp; {\mathbf o_t} \odot {\mathbf \tanh}({\mathbf c_t}).\end{split}\]</div>
<p>We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(T\)</span>: sequcne length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(I\)</span>: input size, <span class="math notranslate nohighlight">\(L\)</span>: number of layers, <span class="math notranslate nohighlight">\(D\)</span>: number of directions, can be either 1 or 2, <span class="math notranslate nohighlight">\(H\)</span>: hidden size.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.bioinf.jku.at/publications/older/2604.pdf">S. Hochreiter and J. Schmidhuber, Long Short-Term Memory.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((T, B, I)\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</p></li>
<li><p><strong>c</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</p></li>
<li><p><strong>weight_l0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the first layer. Shape is <span class="math notranslate nohighlight">\((D, 4, H, I + H)\)</span>.
[parameter]</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the second layer and above. Shape is <span class="math notranslate nohighlight">\((L-1, D, 4, H, D * H + H)\)</span>.
[optional][parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(L\)</span>). Shape is <span class="math notranslate nohighlight">\((L, D, 4, H)\)</span>.
[optional][parameter]</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of layers in the network. If set to 1, only the weights for the first layer will be invoked. Default is 1.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Dropout ratio applied to parameters. Default is 0.0.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, bidirecitonal computation will be performed in each layer. Default is False.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Backpropagation will be performed only when it is True. Default is True.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((T, B, D * H)\)</span>. Its memory layout can be reshaped as <span class="math notranslate nohighlight">\((T, B, D, H)\)</span>.
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(c_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.gru">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">gru</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#gru"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.gru" title="Permalink to this definition"></a></dt>
<dd><p>N-Step GRU layer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\mathbf r_t} &amp;=&amp; {\mathbf \sigma}( {\mathbf W_r} *{\mathbf x_t} + {\mathbf U_r}* {\mathbf h_{(t-1)}} + {\mathbf b_r})\\
  {\mathbf z_t} &amp;=&amp; {\mathbf \sigma}( {\mathbf W_z} *{\mathbf x_t} + {\mathbf U_z}* {\mathbf h_{(t-1)}} + {\mathbf b_z})\\
{\mathbf n_t} &amp;=&amp; {\mathbf \tanh}( {\mathbf W_n}{\mathbf x_t}+ {\mathbf b_{in}}+ {\mathbf r_n}\odot( {\mathbf U_n}{\mathbf h_{t-1}}+ {\mathbf b_{hn}})) \\
{\mathbf h_t} &amp;=&amp; (1- {\mathbf z_t})\odot {\mathbf n_t} + {\mathbf z_t}\odot {\mathbf h_{t-1}}.\end{split}\]</div>
<p>We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(T\)</span>: sequcne length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(I\)</span>: input size, <span class="math notranslate nohighlight">\(L\)</span>: number of layers, <span class="math notranslate nohighlight">\(D\)</span>: number of directions, can be either 1 or 2, <span class="math notranslate nohighlight">\(H\)</span>: hidden size.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.aclweb.org/anthology/D14-1179">K. cho et al., Learning Phrases Representations using RNN Encoder-Decoder for Statistical Machine Translation.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((T, B, I)\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span>.</p></li>
<li><p><strong>weight_l0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the first layer. Shape is <span class="math notranslate nohighlight">\((D, 3, H, I + H)\)</span>.
[parameter]</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – weight parameters for the second layer and above. Shape is <span class="math notranslate nohighlight">\((L-1, D, 3, H, D * H + H)\)</span>.
[optional][parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias vector (<span class="math notranslate nohighlight">\(L\)</span>). Shape is <span class="math notranslate nohighlight">\((L, D, 4, H)\)</span>.
[optional][parameter]</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of layers in the network. If set to 1, only the weights for the first layer will be invoked. Default is 1.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Dropout ratio applied to parameters. Default is 0.0.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, bidirecitonal computation will be performed in each layer. Default is False.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Backpropagation will be performed only when it is True. Default is True.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((T, B, D * H)\)</span>. Its memory layout can be reshaped as <span class="math notranslate nohighlight">\((T, B, D, H)\)</span>.
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((L, D, B, H)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.multi_head_attention">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">multi_head_attention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_bias_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_bias_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additive_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#multi_head_attention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.multi_head_attention" title="Permalink to this definition"></a></dt>
<dd><p>MultiHeadAttention.</p>
<p>Computes multi-headed attention with query, key, and value.
We use the following notations to describe the inputs and outputs below.
<span class="math notranslate nohighlight">\(L_T\)</span>: target sequence length, <span class="math notranslate nohighlight">\(L_S\)</span>: source sequence length, <span class="math notranslate nohighlight">\(B\)</span>: batch size, <span class="math notranslate nohighlight">\(D\)</span>: input dimension, <span class="math notranslate nohighlight">\(E\)</span>: embedding dimension, <span class="math notranslate nohighlight">\(H\)</span>: number of attention heads.</p>
<p class="rubric">References</p>
<p>A. Vaswani et al. “Attention is All You Need.”
NIPS. 2017.
&lt;<a class="reference external" href="https://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf">https://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf</a>&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L_T, B, D_q)\)</span>.</p></li>
<li><p><strong>key</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L_S, B, D_k)\)</span>.</p></li>
<li><p><strong>value</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L_S, B, D_v)\)</span>.</p></li>
<li><p><strong>num_heads</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of attention heads. Note that embedding dimensoin E must be divisible by the number of heads. Default is 12 which is conventional.</p></li>
<li><p><strong>q_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((D_q, E)\)</span>.</p></li>
<li><p><strong>k_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((D_k, E)\)</span>.</p></li>
<li><p><strong>v_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((D_v, E_v)\)</span>.</p></li>
<li><p><strong>out_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((D_v, E_{out})\)</span>.</p></li>
<li><p><strong>q_bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((E, )\)</span>.</p></li>
<li><p><strong>k_bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((E, )\)</span>.</p></li>
<li><p><strong>v_bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((E_v, )\)</span>.</p></li>
<li><p><strong>out_bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((E_{out}, )\)</span>.</p></li>
<li><p><strong>attn_bias_k</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((E, )\)</span>.</p></li>
<li><p><strong>attn_bias_v</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((E_v, )\)</span>.</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em>, </em><em>optional</em>) – Dropout ratio applied to parameters. Default is 0.</p></li>
<li><p><strong>additive_mask</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((L_T, L_S)\)</span>. Values will be added to the attention layer to prevent attention to certain positions.</p></li>
<li><p><strong>key_padding_mask</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – Input N-D array with shape <span class="math notranslate nohighlight">\((B, L_S)\)</span>. Specified padding elements will be ignored by the attention layer. Values must be either 1 or 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output <span class="math notranslate nohighlight">\(y\)</span> with shape <span class="math notranslate nohighlight">\((L_T, B, E_{out})\)</span>
~nnabla.Variable: Output <span class="math notranslate nohighlight">\(h_n\)</span> with shape <span class="math notranslate nohighlight">\((B, L_T, L_S)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.patch_correlation">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">patch_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#patch_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.patch_correlation" title="Permalink to this definition"></a></dt>
<dd><p>Multiplicative patch-wise comparison between inputs <code class="xref any docutils literal notranslate"><span class="pre">x1</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">x2</span></code>, which
must both be 4-dimensional NCHW (with <code class="xref any docutils literal notranslate"><span class="pre">channel_last=False</span></code>) or NHWC (with
<code class="xref any docutils literal notranslate"><span class="pre">channel_last=True</span></code>) arrays (where <em>N</em> is the number of samples, <em>H</em> and
<em>W</em> are the sample height and width and <em>C</em> is the number of channels).
The function returns a 5-D array with shape <span class="math notranslate nohighlight">\((N, C_y, C_x, H_o, W_o)\)</span>
where <span class="math notranslate nohighlight">\(H_o, W_o\)</span> are determined by the possible patch locations within
the, optionally padded, input image sizeand <span class="math notranslate nohighlight">\(C_y, C_x\)</span> are determined
by the optionally shifted patch positions.</p>
<p>Mathematically, the patch correlation is formulated as</p>
<div class="math notranslate nohighlight">
\[O(s_y, s_x, h_0, w_0) =
\sum_{c} \sum_{k_h} \sum_{k_w} I_1(c, h + k_h, w + k_w) \times I_2(c, h + k_h + s_h, w + k_w + s_w),\]</div>
<p>where <span class="math notranslate nohighlight">\(I_1(c, h, w)\)</span> and <span class="math notranslate nohighlight">\(I_2(c, h, w)\)</span> are the inputs at <span class="math notranslate nohighlight">\(c\)</span>-th channel,
<span class="math notranslate nohighlight">\(h\)</span>-th height, and <span class="math notranslate nohighlight">\(w\)</span>-th width, <span class="math notranslate nohighlight">\(k_h, k_w\)</span> indices for the patch size
and <span class="math notranslate nohighlight">\(s_h, s_w\)</span> indices for the shifts.</p>
<p>A single correlation value (per sample) is produced if the patch extends
to the image dimensions and all other parameters use the default values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span><span class="o">.</span><span class="n">d</span>
<span class="go">array([[[[[24.]]]]], dtype=float32)</span>
</pre></div>
</div>
<p>A patch that is smaller than the image size moves horizontal and vertical
producing a value per position. The <code class="xref any docutils literal notranslate"><span class="pre">patch_step</span></code> argument may be used to
control the position increments.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="p">(</span><span class="n">H</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">W</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">d</span>
<span class="go">array([[[[[12., 12.],</span>
<span class="go">          [12., 12.]]]]], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="p">(</span><span class="n">H</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">W</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">patch_step</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">d</span>
<span class="go">array([[[[[12., 12.]]]]], dtype=float32)</span>
</pre></div>
</div>
<p>Multiple correlations may be performed at each position between the patch
from <code class="xref any docutils literal notranslate"><span class="pre">x1</span></code> and patches from <code class="xref any docutils literal notranslate"><span class="pre">x2</span></code> at relative offsets striding the maximum
vertical and horizontal distance given by the <a class="reference internal" href="#nnabla.functions.shift" title="nnabla.functions.shift"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shift</span></code></a> values at increments
of <code class="xref any docutils literal notranslate"><span class="pre">shift_step</span></code>. The shifted correlation values can be obtained for the
from the second and third output dimension for the vertical and horizontal
shifts.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shift</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 1, 3, 1, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shift</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">d</span>
<span class="go">array([[[[[0., 6., 6., 6.]],</span>
<span class="go">         [[6., 6., 6., 6.]],</span>
<span class="go">         [[6., 6., 6., 0.]]]]], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shift</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shift_step</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">d</span>
<span class="go">array([[[[[0., 6., 6., 6.]],</span>
<span class="go">         [[6., 6., 6., 0.]]]]], dtype=float32)</span>
</pre></div>
</div>
<p>Padding with zero values may be applied individually to the top, bottom,
left and right side of the input image.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span><span class="o">.</span><span class="n">d</span>
<span class="go">array([[[[[ 0.,  6., 12., 18., 24., 18., 12.,  6.,  0.],</span>
<span class="go">          [ 0.,  4.,  8., 12., 16., 12.,  8.,  4.,  0.]]]]], dtype=float32)</span>
</pre></div>
</div>
<p>This function may be used to implement the FlowNetC correlation layer.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">patch_correlation</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">shift_step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 21, 21, 44, 60)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1504.06852">Fischer et al., FlowNet: Learning Optical Flow with Convolutional
Networks.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>
or <span class="math notranslate nohighlight">\((N, H, W, C)\)</span>.</p></li>
<li><p><strong>x2</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array with shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>
or <span class="math notranslate nohighlight">\((N, H, W, C)\)</span>.</p></li>
<li><p><strong>patch</strong> – A tuple with height and width of the correlation patch. A single
integer expands to identical height and width.</p></li>
<li><p><strong>shift</strong> – A tuple of maximum vertical and horizontal displacement of
patches from <code class="xref any docutils literal notranslate"><span class="pre">x2</span></code> that are correlated with a single patch from <code class="xref any docutils literal notranslate"><span class="pre">x1</span></code>.
A single integer expands to identical vertical and horizontal
displacement.</p></li>
<li><p><strong>patch_step</strong> – A tuple of vertical and horizontal increments for advancing
the position of the correlation patch within the input image shape.
A single integer expands to identical vertical and horizontal
increments.</p></li>
<li><p><strong>shift_step</strong> – A tuple of vertical and horizontal increments for advancing
the relative offset position within the shift range. A single
integer expands to identical vertical and horizontal increments.</p></li>
<li><p><strong>padding</strong> – A tuple of top, bottom, left and right padding extent. A tuple
of two values yields identical top/bottom and left/right padding
from the first and second tuple value. A single integer expands to
identical padding extent for all sides.</p></li>
<li><p><strong>channel_last</strong> – Last dimension is the channel (NHWC order) if True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>N-D array with shape <span class="math notranslate nohighlight">\((N, C_y, C_x, H_o, W_o)\)</span> or <span class="math notranslate nohighlight">\((N, H, W, C_y, C_x)\)</span> if <code class="xref any docutils literal notranslate"><span class="pre">channel_last=True</span></code>.</p>
<blockquote>
<div><p>A spatial size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[H_o = \frac{H + (top\_pad + bottom\_pad) - patch_v}{patch\_step_v} + 1.\]</div>
<p>A channel size of the output is calculated as</p>
<div class="math notranslate nohighlight">
\[C_y = \frac{2 \times shift_v}{shift\_step_v} + 1.\]</div>
<p><span class="math notranslate nohighlight">\(W_o\)</span> and <span class="math notranslate nohighlight">\(C_x\)</span> are the same calculation with differenct components.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.roi_align">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">roi_align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#roi_align"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.roi_align" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Map Regions of Interest (RoI) defined by bounding <code class="xref any docutils literal notranslate"><span class="pre">boxes</span></code> to features
of <code class="xref any docutils literal notranslate"><span class="pre">output_size</span></code> height and width using bilinear interpolation with
<code class="xref any docutils literal notranslate"><span class="pre">sampling_ratio</span></code> points in the interpolation grid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[[[1. 1. 1. 1.]</span>
<span class="go">   [1. 2. 2. 1.]</span>
<span class="go">   [1. 2. 2. 1.]</span>
<span class="go">   [1. 1. 1. 1.]]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxes</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">roi_align</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[[[[1.25 1.25]</span>
<span class="go">   [1.25 1.25]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[[[2.   2.  ]</span>
<span class="go">  [2.   2.  ]]]]</span>
</pre></div>
</div>
<p>The <code class="xref any docutils literal notranslate"><span class="pre">spatial_scale</span></code> argument tuple may be used to appropriately scale
the box coordinates, for example, to scale normalized box coordinate to
the input height and width dimensions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxes</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">30</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">roi_align</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">spatial_scale</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[[[6. 7.]]]]</span>
</pre></div>
</div>
<p>References:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1703.06870v3">He et al., Mask R-CNN.</a></p></li>
</ul>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with shape <span class="math notranslate nohighlight">\((N, H, W, C)\)</span> or <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>boxes</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with shape <span class="math notranslate nohighlight">\((K, 5)\)</span> containing box coordinates in (b, x1, y1, x2, y2) format where b is the batch index. Note that an invalid (out-of-range) batch index will generate an error only when running on CPU; when using a GPU context the batch index values are clipped to the range of input samples.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – the height and width of the output feature maps.</p></li>
<li><p><strong>spatial_scale</strong> (<em>repeated float</em>) – Scaling factor from box to input coordinates, as (x, y).
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1.0,</span> <span class="pre">1.0)</span></code> ]</p></li>
<li><p><strong>sampling_ratio</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of sampling points used for interpolation. Computed as <code class="xref any docutils literal notranslate"><span class="pre">ceil((y2</span> <span class="pre">-</span> <span class="pre">y1)</span> <span class="pre">/</span> <span class="pre">output_size[0])</span></code> for height and likewise for width if <code class="xref any docutils literal notranslate"><span class="pre">sampling_ratio</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with shape <span class="math notranslate nohighlight">\((K, C, output\_size[0], output\_size[1])\)</span>
or <span class="math notranslate nohighlight">\((K, output\_size[0], output\_size[1], C)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="neural-network-activation">
<h3>Neural Network Activation<a class="headerlink" href="#neural-network-activation" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sigmoid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sigmoid" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise sigmoid function.</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{1}{1 + \exp(-x)},\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.swish">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">swish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#swish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.swish" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise swish function, by Ramachandran et al. (2017).</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{x_i}{1 + \exp(-x_i)},\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1710.05941">Prajit Ramachandran, Barret Zoph, and Quoc V. Le, Swish: a Self-Gated Activation Function, arXiv:1710.05941 [cs.NE]</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.tanh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.tanh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic tangent (tanh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \tanh (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.relu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">relu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#relu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.relu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Rectified Linear Unit (ReLU) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \max (0, x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.softmax">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.softmax" title="Permalink to this definition"></a></dt>
<dd><p>Softmax normalization. Calculates</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{\exp(x_i)}{\sum_j \exp(x_j)}\]</div>
<p>along the dimension specified by <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a>, where <span class="math notranslate nohighlight">\(x_i\)</span> is the input and <span class="math notranslate nohighlight">\(y_i\)</span> is the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x.shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.log_softmax">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">log_softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#log_softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.log_softmax" title="Permalink to this definition"></a></dt>
<dd><p>Fused operation of Softmax normalization followed by log, which is defined as</p>
<div class="math notranslate nohighlight">
\[y_i = \log \frac{\exp(x_i)}{\sum_j \exp(x_j)},\]</div>
<p>where <span class="math notranslate nohighlight">\(y_i\)</span> is the input and <span class="math notranslate nohighlight">\(x_i\)</span> is the output at i-th channel.
An advantage of this fusion is reducing the numerical instability due to the log application.</p>
<p>The original definition can be rewritten as</p>
<div class="math notranslate nohighlight">
\[y_i = x_i - \max_j(x_j) - \log\left(\sum_j \exp(x_j - \max_k(x_k))\right).\]</div>
<p>It is more stable as a log is always applied to a value <span class="math notranslate nohighlight">\(\ge e\)</span>, while a log can be evaluated for 0 in the non-fused operation.</p>
<p>Also, backward gradient computation is more stable than the original one as it doesn’t perform division by x due to a gradient of log. The definition is as following.</p>
<div class="math notranslate nohighlight">
\[dx_i = dy_i - y_i * \sum_j dy_j\]</div>
<p>where <span class="math notranslate nohighlight">\(dx_i\)</span> and <span class="math notranslate nohighlight">\(dy_i\)</span> denote gradients of loss
wrt <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x.shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.elu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">elu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#elu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.elu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Exponential Linear Unit (ELU) function.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \left\{
\begin{array}{ll}
x_i &amp; (x &gt; 0)\\
\alpha (\exp(x_i) - 1) &amp; (x \leq 0)
\end{array} \right..\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="http://arxiv.org/abs/1511.07289">Clevart et al., Fast and Accurate Deep Network Learning by Exponential Linear Units (ELUs).</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Coefficient for negative outputs. <span class="math notranslate nohighlight">\(\alpha\)</span> in definition
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.selu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">selu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05070098735548</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.673263242354377</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#selu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.selu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Scaled Exponential Linear Unit (SELU) function by Klambauer et al. (2017).</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \lambda \left\{
\begin{array}{ll}
x_i &amp; (x &gt; 0)\\
\alpha (\exp(x_i) - 1) &amp; (x \leq 0)
\end{array} \right..\end{split}\]</div>
<p>The coefficients <span class="math notranslate nohighlight">\(\lambda\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> default to the following values <span class="math notranslate nohighlight">\(\lambda_{01}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{01}\)</span>, respectively, provided by Klambauer et al. (2017):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
  \lambda_{01} &amp;=&amp;  \left(  1 - \operatorname{erfc}\left( \frac{1}{\sqrt{2}} \right) \sqrt{e}  \right)
              \sqrt{2 \pi} \\
             &amp;&amp; \left(
                  2 \operatorname{erfc} \left( \sqrt{2} \right) e^2
                  + \pi \operatorname{erfc}\left( \frac{1}{\sqrt{2}} \right)^2 e
                  \right. \\
             &amp;&amp; \left.
                  - 2(2 + \pi) \operatorname{erfc} \left( \frac{1}{\sqrt{2}} \right) \sqrt{e}
                  + \pi + 2
             \right)^{-1/2}  \\
          &amp;\approx&amp; 1.0507 \\
  \alpha_{01} &amp;=&amp;  - \frac
                {\sqrt {\frac {2}{\pi}}}
                {\operatorname{erfc} \left( \frac{1}{\sqrt{2}} \right) \exp \left(\frac {1} {2} \right) - 1} \\
          &amp;\approx&amp; 1.67326
\end{array}\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1706.02515">Klambauer, G., Unterthiner, T., Mayr, A., &amp; Hochreiter, S. (2017).
Self-Normalizing Neural Networks. In Advances in Neural Information
Processing Systems (NIPS).</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The coefficient <span class="math notranslate nohighlight">\(\lambda\)</span> in the definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.05070098735548</span></code> ]</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The coefficient <span class="math notranslate nohighlight">\(\alpha\)</span> in the definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.673263242354377</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.crelu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">crelu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#crelu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.crelu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Concatenated Rectified Linear Unit (CReLU) function.
This function calculates the ReLU of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(-x\)</span> , then concatenates the results together at a specified axis,
and returns the resulting array.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1603.05201">Wenling Shang, Kihyuk Sohn, Diogo Almeida, Honglak Lee.
Understanding and Improving Convolutional Neural Networks
via Concatenated Rectified Linear Units.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The ReLU activations of positive inputs and negative inputs are concatenated at axis.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array where axis dimension is doubled by concatenating.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.celu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">celu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#celu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.celu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Concatenated Exponential Linear Unit (CELU) function.
Concatenates ELU outputs of positive and negative inputs together at specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Coefficient for negative outputs. <span class="math notranslate nohighlight">\(\alpha\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The ELU activations of positive inputs and negative inputs are concatenated at axis.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array where axis dimension is doubled by concatenating.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.gelu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">gelu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#gelu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.gelu" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian Error Unit (GELU) function.</p>
<div class="math notranslate nohighlight">
\[GELU(x) = xP(X \leq  x) = x \Phi (x)\]</div>
<p>which is approximated by</p>
<div class="math notranslate nohighlight">
\[GELU(x) = 0.5x (1 + \tanh ( \sqrt(2/\pi)(x + 0.044715x^3) ))\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1606.08415">Dan Hendrycks and Kevin Gimpel.
Gaussian Error Linera Units (GELUs).</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.mish">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">mish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#mish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.mish" title="Permalink to this definition"></a></dt>
<dd><p>Mish activation function.</p>
<div class="math notranslate nohighlight">
\[Mish(x) = x \tanh(\log(1+\exp(x_i)))\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1908.08681">Diganta Misra.
Mish A Self Regularized Non-Monotonic Neural Activation Function.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.prelu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">prelu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#prelu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.prelu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Parametrized Rectified Linear Unit function. Calculates:</p>
<div class="math notranslate nohighlight">
\[y_i = \max(0, x_i) + w_i \min(0, x_i)\]</div>
<p>where negative slope <span class="math notranslate nohighlight">\(w\)</span> is learned and can vary across channels (an
axis specified with <code class="xref any docutils literal notranslate"><span class="pre">base_axis</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – (N-D array) Input</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – (N-D array) Weights</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.leaky_relu">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">leaky_relu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#leaky_relu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.leaky_relu" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Leaky Rectified Linear Unit (ReLU) function.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[y_i = \alpha * \min(0, x_i) + \max (0, x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The slope value multiplied to negative numbers. <span class="math notranslate nohighlight">\(\alpha\)</span> in the definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.1</span></code> ]</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.relu6">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">relu6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#relu6"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.relu6" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise ReLU6 function.
Capping ReLU activation to 6 is often observed to learn sparse features earlier.</p>
<div class="math notranslate nohighlight">
\[ReLU6(x) = \min(\max(0,x,),6)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.hard_sigmoid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">hard_sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#hard_sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.hard_sigmoid" title="Permalink to this definition"></a></dt>
<dd><p>Segment-wise linear approximation of sigmoid.
Preferable when speed of computation is more important than precision.
Returns <span class="math notranslate nohighlight">\(0\)</span> if <span class="math notranslate nohighlight">\(x &lt; -2.5\)</span>.
Returns <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(x&gt; 2.5\)</span>.
Returns <span class="math notranslate nohighlight">\(0.2x + 0.5\)</span> if <span class="math notranslate nohighlight">\(-2.5 &lt;= x &lt;= 2.5\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.hard_tanh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">hard_tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#hard_tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.hard_tanh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise HardTanh function.
Computationally cheaper than Tanh function.
Returns <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(x &gt; 1\)</span>.
Returns <span class="math notranslate nohighlight">\(-1\)</span> if <span class="math notranslate nohighlight">\(x &lt; -1\)</span>.
Returns <span class="math notranslate nohighlight">\(x\)</span> otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.log_sigmoid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">log_sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#log_sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.log_sigmoid" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise LogSigmoid function.</p>
<div class="math notranslate nohighlight">
\[LogSigmoid(x) = \log(1/(1+\exp(-x_i)))\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.softplus">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">softplus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softplus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.softplus" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise SoftPlus function.
Unlike Sigmoid and Tanh that have upper and lower bound, SoftPlus is only lower-bounded by 0.</p>
<div class="math notranslate nohighlight">
\[SoftPlus(x) = \frac{1}{\beta} * \log(1+\exp(\beta * x_i))\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – the <code class="xref any docutils literal notranslate"><span class="pre">beta</span></code> value for SoftPlus formulation
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.softsign">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">softsign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softsign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.softsign" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise SoftSign.
Can be used in place of Tanh function.
While Tanh converges exponentially, SoftSign converges polynomially.</p>
<div class="math notranslate nohighlight">
\[SoftSign(x) = x/(1+|x|)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.tanh_shrink">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">tanh_shrink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tanh_shrink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.tanh_shrink" title="Permalink to this definition"></a></dt>
<dd><p>Element-wies TanhShrink function.</p>
<div class="math notranslate nohighlight">
\[TanhShrink(x) = x - \tanh(x)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sinc">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sinc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sinc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sinc" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Sinc function.
Unlike other popular activation functions, it has rises and falls.
returns <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(x = 0\)</span>.
returns <span class="math notranslate nohighlight">\(\sin(x)/x\)</span> otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="normalization">
<h3>Normalization<a class="headerlink" href="#normalization" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.batch_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">batch_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#batch_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.batch_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Batch normalization.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu &amp;=&amp; \frac{1}{M} \sum x_i \\
  \sigma^2 &amp;=&amp; \frac{1}{M} \sum \left(x_i - \mu\right)^2 \\
  \hat{x}_i &amp;=&amp; \frac{x_i - \mu}{\sqrt{\sigma^2 + \epsilon}} \\
  y_i &amp;=&amp; \hat{x}_i \gamma + \beta.
\end{eqnarray}\end{split}\]</div>
<p>At testing time, the mean and variance values used are those that were computed during training by moving average.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1502.03167">Ioffe and Szegedy, Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of beta which is learned. If None, the bias term is omitted.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of gamma which is learned. If None, the scale term is omitted.</p></li>
<li><p><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of running mean (modified during forward execution).
If None, dummy variable is created and running mean is not updated.
mean=None with batch_stat=False is prohibited.</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of running variance (modified during forward execution).
If None, dummy variable is created and running variance is not updated.
variance=None with batch_stat=False is prohibited.</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Mean and variance are calculated along these axes.</p></li>
<li><p><strong>decay_rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Decay rate of running mean and variance.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>batch_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use mini-batch statistics rather than running ones.
If False, mean and variance must be <code class="xref any docutils literal notranslate"><span class="pre">~nnabla.Variable</span></code>. (None is prohibited.)</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – It true, the batch statistics of mean and variance,
will be returned as Variables. They are also differentiable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Returns batch normalization output as <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">output_stat=True</span></code>, it also returns the mean and variance
of the mini-batch</p>
<ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Output of the batch normalization</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Variance (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.batch_normalization</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.fused_batch_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">fused_batch_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#fused_batch_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.fused_batch_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Batch normalization fused with an add operation and an activation.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1502.03167">Ioffe and Szegedy, Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of beta which is learned. If None, the bias term is omitted.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of gamma which is learned. If None, the scale term is omitted.</p></li>
<li><p><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of running mean (modified during forward execution).
If None, dummy variable is created and running mean is never updated.
mean=None with batch_stat=False is prohibited.</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running variance (modified during forward execution).
If None, dummy variable is created and running variance is not updated.
variance=None with batch_stat=False is prohibited.</p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><em>optional</em>) – N-D array</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Mean and variance are calculated along these axes.</p></li>
<li><p><strong>decay_rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Decay rate of running mean and variance.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>batch_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use mini-batch statistics rather than running ones.
If False, mean and variance must be <code class="xref any docutils literal notranslate"><span class="pre">~nnabla.Variable</span></code>. (None is prohibited.)</p></li>
<li><p><strong>nonlinearity</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Nonlinearity chosen from relu. Default is relu.</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – It true, the batch statistics of mean and variance,
will be returned as Variables. They are also differentiable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Returns batch normalization output as <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">output_stat=True</span></code>, it also returns the mean and variance
of the mini-batch</p>
<ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Output of the batch normalization</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Variance (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.batch_normalization</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sync_batch_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sync_batch_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'world'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#sync_batch_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sync_batch_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Synchronized batch normalization.</p>
<p>For some tasks (e.g., semantic segmentation), batch size will be too small and BatchNormalization layer might not work well.
SyncBatchNorlization layer solves these problems by synchronizing batch stats (mean and var) between multiple processes.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu &amp;=&amp; \frac{1}{M} \sum x_i \\
  \sigma^2 &amp;=&amp; \frac{1}{M} \left(\sum x_i - \mu\right)^2 \\
  \hat{x}_i &amp;=&amp; \frac{x_i - \mu}{\sqrt{\sigma^2 + \epsilon}} \\
  y_i &amp;=&amp; \hat{x}_i \gamma + \beta.
\end{eqnarray}\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Implementing Synchronized Multi-GPU Batch Normalization <a class="reference external" href="https://hangzhang.org/PyTorch-Encoding/notes/syncbn.html">https://hangzhang.org/PyTorch-Encoding/notes/syncbn.html</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of beta which is learned. If None, the bias term is omitted.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of gamma which is learned. If None, the scale term is omitted.</p></li>
<li><p><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of running mean (modified during forward execution).
If None, dummy variable is created and running mean is never updated.
mean=None with batch_stat=False is prohibited.</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – N-D array of running variance (modified during forward execution).
If None, dummy variable is created and running variance is never updated.
variance=None with batch_stat=False is prohibited.</p></li>
<li><p><strong>comm</strong> (<a class="reference internal" href="communicator.html#nnabla.communicators.Communicator" title="nnabla.communicators.Communicator"><em>Communicator</em></a>) – The communicator</p></li>
<li><p><strong>group</strong> (<em>string</em>) – The name of the communicator group</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Mean and variance are calculated along these axes.</p></li>
<li><p><strong>decay_rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Decay rate of running mean and variance.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>batch_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use mini-batch statistics rather than running ones.
If False, mean and variance must be <code class="xref any docutils literal notranslate"><span class="pre">~nnabla.Variable</span></code>. (None is prohibited.)</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – It true, the batch statistics of mean and variance,
will be returned as Variables. They are also differentiable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Returns batch normalization output as <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">output_stat=True</span></code>, it also returns the mean and variance
of the mini-batch</p>
<ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Output of the batch normalization</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Variance (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.batch_normalization</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.mean_subtraction">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">mean_subtraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_running_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#mean_subtraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.mean_subtraction" title="Permalink to this definition"></a></dt>
<dd><p>It subtracts the mean of the elements of the input array,
and normalizes it to <span class="math notranslate nohighlight">\(0\)</span>. Preprocessing arrays with this function has the effect of improving accuracy
in various tasks such as image classification.</p>
<p>At training time, this function is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu &amp;=&amp; \frac{1}{M} \sum x_i \\
  y_i &amp;=&amp; x_i - \mu
\end{eqnarray}\end{split}\]</div>
<p>At testing time, the mean values used are those that were computed during training by moving average.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The backward performs an approximated differentiation that takes into account only the latest mini-batch.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</p></li>
<li><p><strong>mean</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of running mean (modified during forward execution).</p></li>
<li><p><strong>t</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Scalar of num of iteration of running mean (modified during forward execution).</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Base axis of Mean Subtraction operation. Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>update_running_mean</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Update running mean during forward execution.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.mean_subtraction</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.norm_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">norm_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#norm_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.norm_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Norm normalization.</p>
<div class="math notranslate nohighlight">
\[y = \frac{x_i}{\|x\|_p}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Order of the norm.
[default= <code class="xref any docutils literal notranslate"><span class="pre">2</span></code> ]</p></li>
<li><p><strong>axes</strong> (<em>repeated int64</em>) – Axes to be reduced. If empty list is given, all dimensions are reduced.
[default= <code class="xref any docutils literal notranslate"><span class="pre">range(x.ndim)</span></code> ]</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Epsilon for the normalization. This <code class="xref any docutils literal notranslate"><span class="pre">eps</span></code> is added before taking the p-th root in the norm computation.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1e-12</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.clip_by_value">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">clip_by_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#clip_by_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.clip_by_value" title="Permalink to this definition"></a></dt>
<dd><p>Clip inputs by values.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y = \begin{cases}
        max &amp; (x &gt; max) \\
        x &amp; (otherwise) \\
        min &amp; (x &lt; min)
    \end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>min</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – A min variable or float value by which <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> is clipped. Note that if Variable is given, its shape must be the same as <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>’s.</p></li>
<li><p><strong>max</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – A max variable or float value by which <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> is clipped. Note that if Variable is given, its shape must be the same as <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>’s</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.clip_grad_by_value">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">clip_grad_by_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#clip_grad_by_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.clip_grad_by_value" title="Permalink to this definition"></a></dt>
<dd><p>In forward pass, the function behaves as the identity.</p>
<p>In backward pass,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}g_x = \begin{cases}
    max &amp; (g_y &gt; max) \\
    g_y &amp; (otherwise) \\
    min &amp; (g_y &lt; min)
   \end{cases}.\end{split}\]</div>
</div></blockquote>
<p>A typical case for use is to prevent the gradient explosion through a whole computational graph.
For example, if you want to clip gradient values for each feature map,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="nb">min</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="nb">max</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">clip_grad_by_value</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="nb">max</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</p></li>
<li><p><strong>min</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of minimum input value by which the gradients of the <code class="xref any docutils literal notranslate"><span class="pre">y</span></code> are clipped. Note that the shape of <a class="reference internal" href="#nnabla.functions.min" title="nnabla.functions.min"><code class="xref any py py-func docutils literal notranslate"><span class="pre">min</span></code></a> must be the same as <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>’s and the backward to <a class="reference internal" href="#nnabla.functions.min" title="nnabla.functions.min"><code class="xref any py py-func docutils literal notranslate"><span class="pre">min</span></code></a> is not performed.</p></li>
<li><p><strong>max</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of maximum input value by which the gradients of the <code class="xref any docutils literal notranslate"><span class="pre">y</span></code> are clipped. Note that the shape of <a class="reference internal" href="#nnabla.functions.max" title="nnabla.functions.max"><code class="xref any py py-func docutils literal notranslate"><span class="pre">max</span></code></a> must be the same as <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>’s and the backward to <a class="reference internal" href="#nnabla.functions.max" title="nnabla.functions.max"><code class="xref any py py-func docutils literal notranslate"><span class="pre">max</span></code></a> is not performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.clip_by_norm">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">clip_by_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#clip_by_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.clip_by_norm" title="Permalink to this definition"></a></dt>
<dd><p>Clip inputs by its L2 norm when the L2 norm is larger than the threshold value (defined by clip_norm).
If it is less than the threshold, inputs are not modified. If it is applied, the operation is represented as</p>
<div class="math notranslate nohighlight">
\[y = N \times \frac{x}{\|x\|_2}.\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> is the input, <span class="math notranslate nohighlight">\(y\)</span> is the output,
and <span class="math notranslate nohighlight">\(N\)</span> is <code class="xref any docutils literal notranslate"><span class="pre">clip_norm</span></code>. this is the case that <code class="xref any docutils literal notranslate"><span class="pre">axes</span></code> is not set.
When <code class="xref any docutils literal notranslate"><span class="pre">axes</span></code> is set, the norm is computed over <code class="xref any docutils literal notranslate"><span class="pre">axes</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>clip_norm</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – An input scalar variable or float value. Must be positive.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which the reduction is performed. Passing the default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.clip_grad_by_norm">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">clip_grad_by_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#clip_grad_by_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.clip_grad_by_norm" title="Permalink to this definition"></a></dt>
<dd><p>In the forward pass, the function behaves like the identity.</p>
<p>In the backward pass,</p>
<div class="math notranslate nohighlight">
\[g_x = N \times \frac{g_y}{\|g_y\|_2}.\]</div>
<p>where <span class="math notranslate nohighlight">\(g_x\)</span> is the gradient w.r.t the input, <span class="math notranslate nohighlight">\(g_y\)</span> is the gradient w.r.t. the output,
and <span class="math notranslate nohighlight">\(N\)</span> is <code class="xref any docutils literal notranslate"><span class="pre">clip_norm</span></code> where the norm of <span class="math notranslate nohighlight">\(g_y\)</span> becomes. this is the case that <code class="xref any docutils literal notranslate"><span class="pre">axes</span></code> is not set.
When <code class="xref any docutils literal notranslate"><span class="pre">axes</span></code> is set, the norm is computed over <code class="xref any docutils literal notranslate"><span class="pre">axes</span></code>.</p>
<p>A typical case for use is to prevent the gradient explosion through a whole computational graph.
For example, if you want to normalize gradient values over feature axis,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">clip_grad_by_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">))</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of input.</p></li>
<li><p><strong>clip_norm</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Clip to the norm of input to <code class="xref any docutils literal notranslate"><span class="pre">clip_norm</span></code> in the backward pass.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
<li><p><strong>axes</strong> (<em>repeated int64</em>) – Axes to be reduced. If empty list is given, all dimensions are reduced to scalar. This is used in the forward pass.
[default= <code class="xref any docutils literal notranslate"><span class="pre">range(x.ndim)</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.layer_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">layer_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#layer_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.layer_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Applies Layer Normalization over an input tensor, which is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu^l &amp;=&amp; \frac{1}{H} \sum_{i=1}^{H} x_i^l \\
  \sigma^l &amp;=&amp; \sqrt{\frac{1}{H} \sum_{i=1}^{H} \left(x_i^l - \mu^l\right)^2 + \epsilon} \\
  y &amp;=&amp; \frac{x - \mu^l}{\sigma^l} \gamma + \beta
\end{eqnarray}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are input and output variable,
<span class="math notranslate nohighlight">\(\mu^l\)</span> and <span class="math notranslate nohighlight">\(\sigma^l\)</span> are the mean and std of each layer which is separately calculated for each batch,
and <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are adaptive biases and gains.</p>
<p>If the input shape is [B, C, H, W] (= batch_axis=0), the shape of calculated mean and std are [B, 1, 1, 1]</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1607.06450">Jimmy Lei Ba, Jamie Ryan Kiros, Geoffrey E. Hinton, Layer Normalization.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – An Adaptive biases. If None, the bias term is omitted.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – An Adaptive gains. If None, the scale term is omitted.</p></li>
<li><p><strong>batch_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>repeated int</em>) – Axes mean and variance are taken.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, calculated mean and variance are also returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output variable which is normalized its statics and rescaled by alpha and beta.
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>).
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Std (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.instance_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">instance_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#instance_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.instance_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Applies Instance Normalization over an input tensor, which is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu^i &amp;=&amp; \frac{1}{H} \sum_{i=1}^{H} x_i^i \\
  \sigma^i &amp;=&amp; \sqrt{\frac{1}{H} \sum_{i=1}^{H} \left(x_i^i - \mu^i\right)^2 + \epsilon} \\
  y &amp;=&amp; \frac{x - \mu^i}{\sigma^i} \gamma + \beta
\end{eqnarray}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are input and output variable,
<span class="math notranslate nohighlight">\(\mu^i\)</span> and <span class="math notranslate nohighlight">\(\sigma^i\)</span> are the mean and std of each instance which is separately calculated for each batch and channel,
and <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are adaptive gains and biases.</p>
<p>If the input shape is [B, C, H, W] (= channel_axis=1, batch_axis=0), the shape of calculated mean and std are [B, C, 1, 1]</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1607.08022">Dmitry Ulyanov, Andrea Vedaldi, Victor Lempitsky, Instance Normalization: The Missing Ingredient for Fast Stylization.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – An Adaptive biases. If None, the bias term is omitted.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – An Adaptive gains. If None, the scale term is omitted.</p></li>
<li><p><strong>channel_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Channel axis.</p></li>
<li><p><strong>batch_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>repeated int</em>) – Batch axes.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, the batch statistics of mean and variance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized output variable.
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Std (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.group_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">group_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#group_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.group_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Applies Group Normalization over an input tensor, which is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu^g &amp;=&amp; \frac{1}{H} \sum_{i=1}^{H} x_i^g \\
  \sigma^g &amp;=&amp; \sqrt{\frac{1}{H} \sum_{i=1}^{H} \left(x_i^g - \mu^g\right)^2 + \epsilon} \\
  y &amp;=&amp; \frac{x - \mu^g}{\sigma^g} \gamma + \beta
\end{eqnarray}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are input and output variable,
<span class="math notranslate nohighlight">\(\mu^g\)</span> and <span class="math notranslate nohighlight">\(\sigma^g\)</span> are the mean and std of each group which contains <code class="xref any docutils literal notranslate"><span class="pre">num_channels</span> <span class="pre">/</span> <span class="pre">num_groups</span></code> channels,
and <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are adaptive gains and biases.</p>
<p>The input channels, specified by <code class="xref py py-attr docutils literal notranslate"><span class="pre">channel_axis</span></code>, are separated into <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_groups</span></code> groups,
and the mean and std are calculated over the each group.
For example, if the input shape is [B, C, H, W] (= channel_axis=1, batch_axis=0),
an input variable is once reshaped to [B, num_groups, C / num_groups, H, W]
and standardize by its mean and std whose shapes are [B, num_groups, 1, 1, 1].
Finally, an output variable is reshaped again to the original input shape (= [B, C, H, W] in the case above).</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1803.08494">Yuxin Wu, Kaiming He, Group Normalization.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – An Adaptive biases. If None, the bias term is omitted.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em> or </em><em>None</em>) – An Adaptive gains. If None, the scale term is omitted.</p></li>
<li><p><strong>num_groups</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – A number of groups. The channel dim of ‘x’ must be integer multiple of <code class="xref any docutils literal notranslate"><span class="pre">num_groups</span></code>.</p></li>
<li><p><strong>channel_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Channel axis.</p></li>
<li><p><strong>batch_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>repeated int</em>) – Batch axes.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, the batch statistics of mean and variance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized output variable.
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Std (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.weight_standardization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">weight_standardization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/normalization_functions.html#weight_standardization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.weight_standardization" title="Permalink to this definition"></a></dt>
<dd><p>Applies Weight Standardization over an input weight, which is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
  \mu_{W_i} &amp;=&amp; \frac{1}{I} \sum_{j=1}^{I} W_{ij} \\
  \sigma_{W_i} &amp;=&amp; \sqrt{\frac{1}{I} \sum_{i=1}^{I} \left(W_{ij} - \mu_{W_{i}}\right)^2 + \epsilon} \\
  \hat{W_{ij}} &amp;=&amp; \frac{W_{ij} - \mu_{W_i}}{\sigma_{W_i}} \\
  y &amp;=&amp; \hat{W} \ast x
\end{eqnarray}\end{split}\]</div>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">nnabla.parametric_functions</span> <span class="k">as</span> <span class="nn">PF</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>

<span class="c1"># For convolution:</span>

<span class="k">def</span> <span class="nf">ws_callback_conv</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">weight_standardization</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">apply_w</span><span class="o">=</span><span class="n">ws_callback_conv</span><span class="p">)</span>

<span class="c1"># For affine:</span>

<span class="k">def</span> <span class="nf">ws_callback_affine</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">weight_standardization</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">channel_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">apply_w</span><span class="o">=</span><span class="n">ws_callback_affine</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/pdf/1903.10520v1.pdf">Siyuan Qiao, Huiyu Wang, Chenxi Liu, Wei Shen, Alan Yuille, Weight Standardization</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A weight variable.</p></li>
<li><p><strong>channel_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – An axis for output channel. Default value is 0 which assumes the weights of convolution.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tiny value to avoid zero division by std.</p></li>
<li><p><strong>output_stat</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, the batch statistics of mean and variance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Standardized output weight.
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Mean (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)
* <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Std (if <code class="xref any docutils literal notranslate"><span class="pre">output_stat=True</span></code>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.weight_normalization">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">weight_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#weight_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.weight_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Weight normalization.</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_{WN} = g \dfrac{\mathbf{w}}{\|\mathbf{w}\|}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> is the input weights to be normalized.
and <span class="math notranslate nohighlight">\(g\)</span> is learnable multiplication factors each of which is applied to each data at <code class="xref any docutils literal notranslate"><span class="pre">dim</span></code>.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1602.07868">Tim Salimans, Diederik P. Kingma, Weight Normalization: A Simple Reparameterization to Accelerate Training of Deep Neural Networks.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of learnable weights.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – 1-D array of learnable scales.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Output dimension. For the other dimensions, the norms are computed.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Epsilon for the normalization. This <code class="xref any docutils literal notranslate"><span class="pre">eps</span></code> is added before taking the sqrt in the norm computation.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1e-12</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.spectral_norm">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">spectral_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#spectral_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.spectral_norm" title="Permalink to this definition"></a></dt>
<dd><p>Spectral Normalization.</p>
<div class="math notranslate nohighlight">
\[W_{sn} = \frac{W}{\sigma(W)}\]</div>
<p>where <span class="math notranslate nohighlight">\(W\)</span> is the input matrix, and the <span class="math notranslate nohighlight">\(\sigma(W)\)</span> is the spectral norm of <span class="math notranslate nohighlight">\(W\)</span>. The spectral norm is approximately computed by the power iteration.</p>
<p class="rubric">References</p>
<p>Takeru Miyato, Toshiki Kataoka, Masanori Koyama, Yuichi Yoshida,
“Spectral Normalization for Generative Adversarial Networks”,
International Conference on Learning Representations. 2018.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of learnable weights. This is normally network parameter.</p></li>
<li><p><strong>u</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – 1-D array of singular vector. When <code class="xref any docutils literal notranslate"><span class="pre">test</span> <span class="pre">==</span> <span class="pre">False</span></code>, the data region of <code class="xref any docutils literal notranslate"><span class="pre">u</span></code> will be updated during forward calculation.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Output dimension. Default is 0. If the dimension is not 0, then the specified dimension becomes the most-left dimension by transposing.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>itr</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of power iterations. Default is 1.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Epsilon for the normalization. This <code class="xref any docutils literal notranslate"><span class="pre">eps</span></code> is added before taking the sqrt in the norm computation.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1e-12</span></code> ]</p></li>
<li><p><strong>test</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – When in <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, <code class="xref any docutils literal notranslate"><span class="pre">u</span></code> will not be updated. Default is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>output_u</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Output original <code class="xref any docutils literal notranslate"><span class="pre">u</span></code> or not. <code class="xref any docutils literal notranslate"><span class="pre">u</span></code> is updated when <code class="xref any docutils literal notranslate"><span class="pre">test</span> <span class="pre">==</span> <span class="pre">True</span></code> but you can get original <code class="xref any docutils literal notranslate"><span class="pre">u</span></code> as output with this option. Default is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrally normalized <span class="math notranslate nohighlight">\(W_{sn}\)</span> with the same shape as <span class="math notranslate nohighlight">\(W\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="reduction">
<h3>Reduction<a class="headerlink" href="#reduction" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sum">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sum" title="Permalink to this definition"></a></dt>
<dd><p>Reduction along axes with sum operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which the sum is
calculated. Passing the default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
<li><p><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.mean">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.mean" title="Permalink to this definition"></a></dt>
<dd><p>Reduction along axes with mean operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which mean is
calculated. Passing the default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
<li><p><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.max">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.max" title="Permalink to this definition"></a></dt>
<dd><p>Reduce the input N-D array <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> along the given <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> using the max
operation. The <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> argument may be a single integer to reduce
over one axis, a tuple of integers to reduce over multiple axes,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> to reduce over all axes. If <code class="xref any docutils literal notranslate"><span class="pre">keepdims</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the output will keep all reduced dimensions with size 1. If
<code class="xref any docutils literal notranslate"><span class="pre">with_index</span></code> is True, result is a tuple <code class="docutils literal notranslate"><span class="pre">(sorted,</span> <span class="pre">indices)</span></code> or
only <code class="docutils literal notranslate"><span class="pre">indices</span></code> if <code class="xref any docutils literal notranslate"><span class="pre">only_index</span></code> is True. Setting <code class="xref any docutils literal notranslate"><span class="pre">only_index</span></code> to
True implies that <code class="xref any docutils literal notranslate"><span class="pre">with_index</span></code> is also True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">maxval</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">maxval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">maxval</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">maxval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">only_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which max is
calculated. The default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
<li><p><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Keep reduced axes as dimension with 1 element.</p></li>
<li><p><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return tuple of max values and index.</p></li>
<li><p><strong>only_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return only the index of max values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.min">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.min" title="Permalink to this definition"></a></dt>
<dd><p>Reduce the input N-D array <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> along the given <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> using the min
operation. The <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> argument may be a single integer to reduce
over one axis, a tuple of integers to reduce over multiple axes,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> to reduce over all axes. If <code class="xref any docutils literal notranslate"><span class="pre">keepdims</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the output will keep all reduced dimensions with size 1. If
<code class="xref any docutils literal notranslate"><span class="pre">with_index</span></code> is True, result is a tuple <code class="docutils literal notranslate"><span class="pre">(sorted,</span> <span class="pre">indices)</span></code> or
only <code class="docutils literal notranslate"><span class="pre">indices</span></code> if <code class="xref any docutils literal notranslate"><span class="pre">only_index</span></code> is True. Setting <code class="xref any docutils literal notranslate"><span class="pre">only_index</span></code> to
True implies that <code class="xref any docutils literal notranslate"><span class="pre">with_index</span></code> is also True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">minval</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">minval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">minval</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">minval</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">only_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which min is
calculated. The default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
<li><p><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Keep reduced axes as dimension with 1 element.</p></li>
<li><p><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return tuple of min values and index.</p></li>
<li><p><strong>only_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return only the index of min values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.norm">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.norm" title="Permalink to this definition"></a></dt>
<dd><p>Reduction along axes with norm operation.</p>
<div class="math notranslate nohighlight">
\[y = \|x\|_p = \left( \sum_i |x_i|^p \right)^{\frac{1}{p}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Order of the norm.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which product is
calculated. Passing the default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
<li><p><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.prod">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#prod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.prod" title="Permalink to this definition"></a></dt>
<dd><p>Reduction along axes with product operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>axis</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Axis or axes along which product is
calculated. Passing the default value <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> will reduce all dimensions.</p></li>
<li><p><strong>keepdims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag whether the reduced axes are kept as a dimension with 1 element.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Backward computation is not accurate in a zero value input.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.reduce_sum">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">reduce_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reduce_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.reduce_sum" title="Permalink to this definition"></a></dt>
<dd><p>Reduction along an axis with sum operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is deprecated. Use <code class="docutils literal notranslate"><span class="pre">sum</span></code> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.reduce_mean">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">reduce_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reduce_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.reduce_mean" title="Permalink to this definition"></a></dt>
<dd><p>Reduction by mean along an axis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is deprecated. Use <code class="docutils literal notranslate"><span class="pre">mean</span></code> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="arithmetic">
<h3>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.add2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">add2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#add2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.add2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise addition.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i + x^{(1)}_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.add_n">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">add_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#add_n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.add_n" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise addition.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i + . . . + x^{(n-1)}_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D arrays
[variadic]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sub2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sub2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sub2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sub2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise subtraction.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i - x^{(1)}_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.mul2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">mul2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#mul2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.mul2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise multiplication.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i x^{(1)}_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.mul_n">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">mul_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#mul_n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.mul_n" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise multiplication.</p>
<div class="math notranslate nohighlight">
\[y_i = x^{(0)}_i . . . x^{(n-1)}_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D arrays
[variadic]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.div2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">div2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#div2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.div2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise division.</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{x^{(0)}_i} {x^{(1)}_i}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.pow2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">pow2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pow2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.pow2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise power function.</p>
<div class="math notranslate nohighlight">
\[y_i = {(x^{(0)}_i)} ^ {x^{(1)}_i}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.add_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">add_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#add_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.add_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar addition.</p>
<div class="math notranslate nohighlight">
\[y_i = x_i + v\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.mul_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">mul_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#mul_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.mul_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar multiplication.</p>
<div class="math notranslate nohighlight">
\[y_i = v x_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.pow_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">pow_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pow_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.pow_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar power function.</p>
<div class="math notranslate nohighlight">
\[y_i = (x_i) ^ v\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.r_sub_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">r_sub_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#r_sub_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.r_sub_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar subtraction.</p>
<div class="math notranslate nohighlight">
\[y_i = v - x_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.r_div_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">r_div_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#r_div_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.r_div_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar division.</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{v}{x_i}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.r_pow_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">r_pow_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#r_pow_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.r_pow_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar power function.</p>
<div class="math notranslate nohighlight">
\[y_i = v ^ {x_i}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="logical">
<h3>Logical<a class="headerlink" href="#logical" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.equal">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.equal" title="Permalink to this definition"></a></dt>
<dd><p>Element wise ‘equal’</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1 &amp; (x^{(0)}_i = x^{(1)}_i) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.equal_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">equal_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#equal_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.equal_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element wise ‘equal’ with a scalar</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    1 &amp; (x_i = v) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.greater">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">greater</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.greater" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i &gt; x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i \leq x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.greater_equal">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">greater_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.greater_equal" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i \geq x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i &lt; x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.greater_equal_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">greater_equal_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater_equal_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.greater_equal_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i \geq v \\
    0 &amp; (x^{(0)}_i &lt; v
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.greater_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">greater_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#greater_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.greater_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i &gt; v \\
    0 &amp; (x^{(0)}_i \leq v
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.less">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">less</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.less" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i &lt; x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i \geq x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.less_equal">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">less_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.less_equal" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1  &amp; (x^{(0)}_i \leq x^{(1)}_i) \\
    0 &amp; (x^{(0)}_i &gt; x^{(1)}_i)
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.less_equal_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">less_equal_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less_equal_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.less_equal_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i \leq v) \\
    0 &amp; (x^{(0)}_i &gt; v)
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.less_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">less_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#less_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.less_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element wise comparison with a scalar. The <span class="math notranslate nohighlight">\(i^{th}\)</span> element of the output is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,v) = \begin{cases}
    1  &amp; (x^{(0)}_i &lt; v) \\
    0 &amp; (x^{(0)}_i \geq v)
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_and">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_and"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_and" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise logical AND.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1 &amp; (x^{(0)}_i \neq 0 \;\&amp;\; x^{(1)}_i \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_and_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_and_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_and_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_and_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise logical AND with scalar.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    1 &amp; (x_i \neq 0 \;\&amp;\; v \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – No Description</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_not">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_not"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_not" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise logical NOT operation</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i) = \begin{cases}
    1 &amp; (x_i = 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_or">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_or"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_or" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise logical OR.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    0 &amp; (x^{(0)}_i = 0 \;\&amp;\; x^{(1)}_i = 0) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_or_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_or_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_or_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_or_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise logical OR with scalar.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    0 &amp; (x_i = 0 \;\&amp;\; v = 0) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – No Description</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_xor">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_xor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_xor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_xor" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise logical XOR.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    1 &amp; (x^{(0)}_i = 0 \;\&amp;\; x^{(1)}_i = 0) \\
    1 &amp; (x^{(0)}_i \neq 0 \;\&amp;\; x^{(1)}_i \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.logical_xor_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">logical_xor_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#logical_xor_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.logical_xor_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise logical XOR with scalar.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    1 &amp; (x_i = 0 \;\&amp;\; v = 0) \\
    1 &amp; (x_i \neq 0 \;\&amp;\; v \neq 0) \\
    0 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – No Description</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.not_equal">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">not_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#not_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.not_equal" title="Permalink to this definition"></a></dt>
<dd><p>Element wise ‘not equal’</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x^{(0)}_i,x^{(1)}_i) = \begin{cases}
    0 &amp; (x^{(0)}_i = x^{(1)}_i) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>No Description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.not_equal_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">not_equal_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#not_equal_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.not_equal_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element wise ‘not equal’ with a scalar</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x_i,v) = \begin{cases}
    0 &amp; (x_i = v) \\
    1 &amp; otherwise
\end{cases}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sign">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sign" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise sign function.</p>
<p>In the forward pass, it is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = \begin{cases}
    1  &amp; (x &gt; 0) \\
    -1 &amp; (x &lt; 0) \\
    \alpha &amp; (x = 0)
\end{cases}.\end{split}\]</div>
<p>In the backward pass, it is defined as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f(x)}{\partial x} = 1,\]</div>
<p>or in other words, it behaves as the identity function for the gradient in the backward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value in case of <span class="math notranslate nohighlight">\(x = 0\)</span>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.minimum2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">minimum2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#minimum2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.minimum2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise minimum.</p>
<div class="math notranslate nohighlight">
\[y_i = \min(x^{(0)}_i, x^{(1)}_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of min value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.maximum2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">maximum2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#maximum2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.maximum2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise maximum.</p>
<div class="math notranslate nohighlight">
\[y_i = \max(x^{(0)}_i, x^{(1)}_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of max value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.minimum_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">minimum_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#minimum_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.minimum_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar minimum.</p>
<div class="math notranslate nohighlight">
\[y_i = \min(x_i, v)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.maximum_scalar">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">maximum_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#maximum_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.maximum_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise scalar maximum.</p>
<div class="math notranslate nohighlight">
\[y_i = \max (x_i, v)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.isnan">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">isnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#isnan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.isnan" title="Permalink to this definition"></a></dt>
<dd><p>Test element-wise for NaN and return a <code class="docutils literal notranslate"><span class="pre">0/1</span></code> array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.isinf">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">isinf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#isinf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.isinf" title="Permalink to this definition"></a></dt>
<dd><p>Test element-wise for <code class="docutils literal notranslate"><span class="pre">inf/-inf</span></code> and return a <code class="docutils literal notranslate"><span class="pre">0/1</span></code> array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.reset_nan">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">reset_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reset_nan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.reset_nan" title="Permalink to this definition"></a></dt>
<dd><p>Replace NaNs with a scalar value specified by <code class="docutils literal notranslate"><span class="pre">val</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.reset_inf">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">reset_inf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reset_inf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.reset_inf" title="Permalink to this definition"></a></dt>
<dd><p>Replace <code class="docutils literal notranslate"><span class="pre">-inf/inf</span></code> with a scalar value specified by <code class="docutils literal notranslate"><span class="pre">val</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value of the scalar
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.where">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_false</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#where"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.where" title="Permalink to this definition"></a></dt>
<dd><p>Return elements, either from <code class="docutils literal notranslate"><span class="pre">x_true</span></code> or <code class="docutils literal notranslate"><span class="pre">x_false</span></code>, depending on <code class="docutils literal notranslate"><span class="pre">condition</span></code>.</p>
<p>If rank of <code class="docutils literal notranslate"><span class="pre">condition</span></code> is higher than those of <code class="docutils literal notranslate"><span class="pre">x_true</span></code> and <code class="docutils literal notranslate"><span class="pre">x_false</span></code>, the first dimensions of <code class="docutils literal notranslate"><span class="pre">x_true</span></code> and <code class="docutils literal notranslate"><span class="pre">x_false</span></code> must match the dimensions of <code class="docutils literal notranslate"><span class="pre">condition</span></code>.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">greater_scalar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">z</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="c1"># Numpy equivalent</span>
<span class="n">z_numpy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">d</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">z_numpy</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-d array. For all i, when <code class="docutils literal notranslate"><span class="pre">condition[i]</span> <span class="pre">==</span> <span class="pre">true</span></code>, yield <code class="docutils literal notranslate"><span class="pre">x_true[i]</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">x_false[i]</span></code>.</p></li>
<li><p><strong>x_true</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-d array with higher or equal rank to <code class="docutils literal notranslate"><span class="pre">condition</span></code>.</p></li>
<li><p><strong>x_false</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-d array with higher or equal rank to <code class="docutils literal notranslate"><span class="pre">condition</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as condition</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="math">
<h3>Math<a class="headerlink" href="#math" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.constant">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.constant" title="Permalink to this definition"></a></dt>
<dd><p>Generate a constant-valued array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Constant value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of the output array.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array where all values are the specified constant.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.arange">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">arange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#arange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.arange" title="Permalink to this definition"></a></dt>
<dd><p>Generate a range of values within the half-open interval
<code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop)</span></code> (the interval including start but excluding
stop) with <a class="reference internal" href="utils/quantization_aware_training.html#nnabla.utils.qnn.QATScheduler.step" title="nnabla.utils.qnn.QATScheduler.step"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">step</span></code></a> increments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Start value.</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – End value.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Step value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1-D array with the generated values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.abs">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#abs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.abs" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise absolute value function.</p>
<div class="math notranslate nohighlight">
\[y_i = |x_i|\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise absolute variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.exp">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.exp" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise natural exponential function.</p>
<div class="math notranslate nohighlight">
\[y_i = \exp(x_i).\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise exp variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.log">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.log" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise natural logarithm function.</p>
<div class="math notranslate nohighlight">
\[y_i = \ln(x_i).\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise log variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.round">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#round"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.round" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise round function.</p>
<p>In the forward pass, this function simply computes <a class="reference internal" href="#nnabla.functions.round" title="nnabla.functions.round"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round</span></code></a> to the nearest integer value.</p>
<div class="math notranslate nohighlight">
\[y_i = round(x_i).\]</div>
<p>In the backward pass, the simple Straight-Through Estimator (STE) is applied,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial y_i}{\partial x_i} = 1.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.ceil">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#ceil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.ceil" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise ceil function.</p>
<p>In the forward pass, this function simply returns the smallest integer which is not less than the input.</p>
<div class="math notranslate nohighlight">
\[y_i = ceil(x_i).\]</div>
<p>In the backward pass, the simple Straight-Through Estimator (STE) is applied,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial y_i}{\partial x_i} = 1.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.floor">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#floor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.floor" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise floor function.</p>
<p>In the forward pass, this function simply returns the largest integer which is not greater than the input.</p>
<div class="math notranslate nohighlight">
\[y_i = floor(x_i).\]</div>
<p>In the backward pass, the simple Straight-Through Estimator (STE) is applied,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial y_i}{\partial x_i} = 1.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.identity">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.identity" title="Permalink to this definition"></a></dt>
<dd><p>Identity function.</p>
<div class="math notranslate nohighlight">
\[y = x\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.matrix_diag">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">matrix_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#matrix_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.matrix_diag" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array where the last two dimensions consist of the diagonal matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N\)</span>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N \times M_N\)</span>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.matrix_diag_part">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">matrix_diag_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#matrix_diag_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.matrix_diag_part" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array in which the values of the last dimension consist of the diagonal
elements of the last two dimensions of an input array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N \times M_N\)</span>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with shape (<span class="math notranslate nohighlight">\(M_0 \times \ldots \times M_N\)</span>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.batch_matmul">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">batch_matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#batch_matmul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.batch_matmul" title="Permalink to this definition"></a></dt>
<dd><p>Batch matrix multiplication.</p>
<p>Two of batchs of matrices are multiplied for each sample in a batch.
A batch of matrices is composed as […, P, Q] where the last two dimensions compose matrix dimensions,
and the first dimensions up to the third last dimension are considered as batch samples.
These batch dimensions are internally broadcasted when the size of a dimension is 1.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Same batch size</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">batch_matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Different batch size with the broadcast</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">batch_matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the version 1.13, the behavior of the batch dimensions changed, it supported the internal
broadcast when the size of a dimension is 1. Accordingly, this function does not supports different
batch dimensions between two inputs even if the total sample size for each input is same.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with &gt;= 2-dim. The last two dimensions will be treated as a matrix.</p></li>
<li><p><strong>b</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with &gt;= 2-dim. The last two dimensions will be treated as a matrix. The product of the size of 0-th dimension through the size of the third last dimension must be same as that of the input <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p></li>
<li><p><strong>transpose_a</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Transpose the last two axes of <code class="docutils literal notranslate"><span class="pre">a</span></code> in matrix multiplication.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>transpose_b</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Transpose the last two axes of <code class="docutils literal notranslate"><span class="pre">b</span></code> in matrix multiplication.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of sample-wise matrix multiplication in a batch. When <code class="docutils literal notranslate"><span class="pre">a</span></code> is of a shape of [N, P, Q], <code class="docutils literal notranslate"><span class="pre">b</span></code> is of a shape of [N, Q, R], and transpose options are all False, the output will be a shape of [N, P, R].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sin">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sin" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise sine (sin) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \sin (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.cos">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#cos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.cos" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise cosine (cos) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \cos (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.tan">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.tan" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise tangent (tan) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \tan (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sinh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sinh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic sine (sinh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \sinh (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.cosh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#cosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.cosh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic cosine (cosh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \cosh (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic tangent (tanh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \tanh (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.asin">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">asin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#asin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.asin" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise arcsine (asin) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \arcsin (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.acos">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">acos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#acos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.acos" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise arccosine (acos) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \arccos (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.atan">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">atan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#atan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.atan" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise arctangent (atan) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \arctan (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.atan2">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">atan2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#atan2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.atan2" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise arctangent (atan) function with 2 input variables.</p>
<div class="math notranslate nohighlight">
\[y_i = \arctan2 (x_{i1}, x_{i2})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as input variables</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.asinh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">asinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#asinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.asinh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic arcsine (asinh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{arcsinh} (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.acosh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">acosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#acosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.acosh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic arccosine (acosh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{arccosh} (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.atanh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">atanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#atanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.atanh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise hyperbolic arctangent (atanh) function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{arctanh} (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.cumsum">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#cumsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.cumsum" title="Permalink to this definition"></a></dt>
<dd><p>Cumulative sum along a given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis along which cumulative sum is to be calculated
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>exclusive</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, perform exclusive cumsum
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, perform cumsum in reverse direction
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.cumprod">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">cumprod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#cumprod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.cumprod" title="Permalink to this definition"></a></dt>
<dd><p>Cumulative product along a given axis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Backward computation is not accurate in a zero value input.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis along which cumulative product is to be calculated
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>exclusive</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, perform exclusive cumprod
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, perform cumprod in reverse direction
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.batch_inv">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">batch_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#batch_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.batch_inv" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array of inverted matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – batched N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batched N-D array of inverted matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.batch_det">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">batch_det</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#batch_det"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.batch_det" title="Permalink to this definition"></a></dt>
<dd><p>Batch-wise determinant function.</p>
<div class="math notranslate nohighlight">
\[Y_b = \det(X_b),\]</div>
<p>where <span class="math notranslate nohighlight">\(X_b\)</span> and <span class="math notranslate nohighlight">\(Y_b\)</span> are the <span class="math notranslate nohighlight">\(b\)</span>-th input and output, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – batched N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batched N-D array of determinant</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.batch_logdet">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">batch_logdet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#batch_logdet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.batch_logdet" title="Permalink to this definition"></a></dt>
<dd><p>Batch-wise log absolute determinant function.</p>
<div class="math notranslate nohighlight">
\[Y_b = \log(|\det(X_b)|),\]</div>
<p>where <span class="math notranslate nohighlight">\(X_b\)</span> and <span class="math notranslate nohighlight">\(Y_b\)</span> are the <span class="math notranslate nohighlight">\(b\)</span>-th input and output, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – batched N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batched N-D array of log absolute determinant</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.batch_cholesky">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">batch_cholesky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#batch_cholesky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.batch_cholesky" title="Permalink to this definition"></a></dt>
<dd><p>Batch-wise cholesky decomposition of symmetric positive definite matrix.
The gradient of this function will be a symmetric matrix.
This function does not check whether given matrix is symmetric positive define matrix or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – batched N-D array</p></li>
<li><p><strong>upper</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, will return an upper triangular matrix. Otherwise will return a lower triangular matrix.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batched N-D array of lower/upper triangular matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.erf">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">erf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#erf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.erf" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Error function.</p>
<div class="math notranslate nohighlight">
\[y_i = \text{erf} (x_i)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="array-manipulation">
<h3>Array Manipulation<a class="headerlink" href="#array-manipulation" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.concatenate">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">concatenate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#concatenate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.concatenate" title="Permalink to this definition"></a></dt>
<dd><p>Concatenate a variable number of input arrays along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D arrays.
[variadic]</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x[0].shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenate variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.split">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.split" title="Permalink to this definition"></a></dt>
<dd><p>Split arrays at the specified axis.</p>
<p>It returns a number corresponding the size of the given
axis (i.e <code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span></code>) of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis</p></li>
</ul>
</dd>
</dl>
<p>Returns: A <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> s</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">nnabla.function_bases.split()</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.stack">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.stack" title="Permalink to this definition"></a></dt>
<dd><p>Joins two or more arrays on a new axis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike <a class="reference internal" href="#nnabla.functions.concatenate" title="nnabla.functions.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nnabla.functions.concatenate()</span></code></a> , which joins arrays on an existing axis,
Stack joins arrays on a new axis.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D arrays. The sizes of all the arrays to be stacked must be the same.
[variadic]</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The axis on which to concatenate arrays. Axis indices take on values 0, 1, 2, and so on from the left. For example, to stack four (3,28,28) inputs on the second axis, specify 1. In this case, the output size will be (3,4,28,28).
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.slice">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.slice" title="Permalink to this definition"></a></dt>
<dd><p>Slice arrays along specified axis. This function
complies with python slice where <code class="xref any docutils literal notranslate"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">-1)</span></code> and
<code class="xref any docutils literal notranslate"><span class="pre">slice(-1,</span> <span class="pre">None,</span> <span class="pre">-1)</span></code> are the special case, which flips the
input array and results in the output array from the end to the beginning
of the input array along the corresponding dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>start</strong> (<em>repeated int64</em>) – Start indices for each axis
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">len(x.shape)</span></code> ]</p></li>
<li><p><strong>stop</strong> (<em>repeated int64</em>) – Stop indices for each axis
[default= <code class="xref any docutils literal notranslate"><span class="pre">tuple(x.shape)</span></code> ]</p></li>
<li><p><strong>step</strong> (<em>repeated int64</em>) – Step indices for each axis
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">len(x.shape)</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sliced N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.gather">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.gather" title="Permalink to this definition"></a></dt>
<dd><p>Gather from the input data according to the index.</p>
<p>Given the input data <span class="math notranslate nohighlight">\(X\)</span> of <span class="math notranslate nohighlight">\((D_{0}, \ldots, D_{N-1})\)</span> shape and
the indices <span class="math notranslate nohighlight">\(IDX\)</span> of <span class="math notranslate nohighlight">\((I_{0}, \ldots, I_{M-1})\)</span> shape, in case of <code class="xref any docutils literal notranslate"><span class="pre">batch_dims</span> <span class="pre">=</span> <span class="pre">0</span></code>,
the gather outputs</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;&amp; Y[d_{0}, \ldots, d_{axis - 1}, i_{0}, \ldots, i_{M-1}, d_{axis + 1}, \ldots, d_{N-1}] = \\
&amp;&amp; X[d_{0}, \ldots, d_{axis - 1}, IDX[i_{0}, \ldots, i_{M-1}], d_{axis + 1}, \ldots, d_{N-1}].\end{split}\]</div>
<p>Generally, the gather outputs</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;&amp; Y[d_{0}, \ldots, d_{axis - 1}, i_{B}, \ldots, i_{M-1}, d_{axis + 1}, \ldots, d_{N-1}] = \\
&amp;&amp; X[d_{0}, \ldots, d_{axis - 1}, IDX[i_{0}, \ldots, i_{B - 1}, i_{B} \ldots, i_{M-1}], d_{axis + 1}, \ldots d_{N-1}].\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(B\)</span> = <code class="xref any docutils literal notranslate"><span class="pre">batch_dims</span></code>.</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">x.shape[:batch_dims]</span></code> must be equal to <code class="xref any docutils literal notranslate"><span class="pre">indices.shape[:batch_dims]</span></code>.</p>
<p>Output shape is <code class="xref any docutils literal notranslate"><span class="pre">x.shape[:axis]</span> <span class="pre">+</span> <span class="pre">indices.shape[batch_dims:]</span> <span class="pre">+</span> <span class="pre">x.shape[axis</span> <span class="pre">+</span> <span class="pre">1]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Data from which to gather.</p></li>
<li><p><strong>Indices</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Index with which to gather.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis in <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> to gather from. <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> must be greater than or equal to <code class="xref any docutils literal notranslate"><span class="pre">batch_dims</span></code>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of batch dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gathered output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.gather_nd">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">gather_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#gather_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.gather_nd" title="Permalink to this definition"></a></dt>
<dd><p>Gather elements or slices from <a class="reference internal" href="nd_array.html#nnabla.NdArray.data" title="nnabla.NdArray.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> according to <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code>, which must
be at least two-dimensional with the first dimension <span class="math notranslate nohighlight">\(M\)</span> being less or
equal to the <span class="math notranslate nohighlight">\(N\)</span> dimensions of <a class="reference internal" href="nd_array.html#nnabla.NdArray.data" title="nnabla.NdArray.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">data</span></code></a>. Given <a class="reference internal" href="nd_array.html#nnabla.NdArray.data" title="nnabla.NdArray.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> with shape
<span class="math notranslate nohighlight">\((X_0, X_1, ..., X_{N-1})\)</span> and indices with shape <span class="math notranslate nohighlight">\((M, Y_0, ...,
Y_{K-1})\)</span> output has shape <span class="math notranslate nohighlight">\((Y_0, ..., Y_{K-1}, X_M, ..., X_{N-1})\)</span>.
If <span class="math notranslate nohighlight">\(M == N\)</span>, output shape is simply <span class="math notranslate nohighlight">\((Y_0, ..., Y_{K-1})\)</span>.</p>
<p>The forward of <a class="reference internal" href="#nnabla.functions.gather_nd" title="nnabla.functions.gather_nd"><code class="xref py py-func docutils literal notranslate"><span class="pre">gather_nd()</span></code></a> is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">tmp_index</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">tmp_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="p">(</span><span class="bp">Ellipsis</span><span class="p">,)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">new_index</span><span class="p">))</span>
    <span class="n">out_shape</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">tmp_index</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">out_shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[ 1.  2.  3.  4.  5.]</span>
<span class="go"> [ 6.  7.  8.  9. 10.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[6. 7. 1.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[ 6.  7.  8.  9. 10.]</span>
<span class="go"> [ 6.  7.  8.  9. 10.]</span>
<span class="go"> [ 1.  2.  3.  4.  5.]]</span>
</pre></div>
</div>
<p>When <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code> is provided as a <a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a> it will be possible
to change the actual index values after function creation. It is important
to note that out-of-bound indices raise errors when running on CPU but are
ignored when using an accelerated computation context.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[1.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[10.]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a>) – input data</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a><em>, </em><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a>) – gather indices</p></li>
</ul>
</dd>
</dl>
<p>Returns: ~nnabla.Variable or ~nnabla.NdArray of gathered elements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.scatter_nd">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">scatter_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#scatter_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.scatter_nd" title="Permalink to this definition"></a></dt>
<dd><p>Scatter <a class="reference internal" href="nd_array.html#nnabla.NdArray.data" title="nnabla.NdArray.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> according to <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code> into a new array of given <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a>
or an existing array provided as <code class="xref any docutils literal notranslate"><span class="pre">out</span></code>. Exactly one of the <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a> or <code class="xref any docutils literal notranslate"><span class="pre">out</span></code>
argument must be given. Given output <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a>, or shape of <code class="xref any docutils literal notranslate"><span class="pre">out</span></code> array,
<span class="math notranslate nohighlight">\((X_0,X_1,\ldots,X_{N-1})\)</span> and <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code> shape
<span class="math notranslate nohighlight">\((M,Y_0,\ldots,Y_{K-1})\)</span> the input <a class="reference internal" href="nd_array.html#nnabla.NdArray.data" title="nnabla.NdArray.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> shape is
<span class="math notranslate nohighlight">\((Y_0,\ldots,Y_{K-1},X_M,\ldots,X_{N-1})\)</span>, where <span class="math notranslate nohighlight">\(M&lt;=N\)</span>. If
<span class="math notranslate nohighlight">\(M==N\)</span> the <a class="reference internal" href="nd_array.html#nnabla.NdArray.data" title="nnabla.NdArray.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> shape is simply <span class="math notranslate nohighlight">\((Y_0,\ldots,Y_{K-1})\)</span>.
Note that <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code> are treated as integers and potentially converted.</p>
<p>The forward of <a class="reference internal" href="#nnabla.functions.scatter_nd" title="nnabla.functions.scatter_nd"><code class="xref py py-func docutils literal notranslate"><span class="pre">scatter_nd()</span></code></a> is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scatter_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">shape</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">out</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">out</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">out</span> <span class="k">if</span> <span class="n">out</span> <span class="k">else</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scattered</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">scatter_nd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scatterd</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[ 0. 11.  0. 10.  9.  0.  0. 12.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">scattered</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[ 9. 10. 11. 12.]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a>) – input data</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a><em>, </em><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a>) – scatter indices</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – shape of new output array</p></li>
<li><p><strong>out</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a>) – existing output array</p></li>
<li><p><strong>add</strong> (<em>tool</em>) – Add the input data to the same destination specified by the indices.</p></li>
</ul>
</dd>
</dl>
<p>Returns: ~nnabla.Variable or ~nnabla.NdArray of given <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.scatter_add">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">scatter_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#scatter_add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.scatter_add" title="Permalink to this definition"></a></dt>
<dd><p>Add all values from <code class="xref any docutils literal notranslate"><span class="pre">x1</span></code> into the <code class="xref any docutils literal notranslate"><span class="pre">x0</span></code> according to index specified by <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code>.
This function adds <code class="xref any docutils literal notranslate"><span class="pre">x1</span></code> into the copy of <code class="xref any docutils literal notranslate"><span class="pre">x0</span></code> and outputs the copy.
The original <code class="xref any docutils literal notranslate"><span class="pre">x0</span></code> will not be changed.
<code class="xref any docutils literal notranslate"><span class="pre">x0</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">x1</span></code> must have same number of dimensions.</p>
<p>The forward of <a class="reference internal" href="#nnabla.functions.scatter_add" title="nnabla.functions.scatter_add"><code class="xref py py-func docutils literal notranslate"><span class="pre">scatter_add()</span></code></a> is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scatter_add</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
    <span class="c1"># Assuming each input is 3 dimensional</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">output</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]][</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array which the data is added to its copy.</p></li>
<li><p><strong>indices</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array scatter indices.
The size of each dimension must be equal or smaller than that of x0 except for the specified axis.
The value of indices must be smaller than the size of specified axis’ dimension of x0.
The size of each dimension must be equal or smaller than that of x1.
Indices must not be negative.</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array which is scattered and added to x0.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis along which to index. The axis must not exceed the inputs’ dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array which contains the result of scatter addition. The shape is same as x0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.pad">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.pad" title="Permalink to this definition"></a></dt>
<dd><p>Pad the input N-D array <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> over the number of dimensions given
by half the length of the <code class="xref any docutils literal notranslate"><span class="pre">pad_width</span></code> iterable, where every two
values in <code class="xref any docutils literal notranslate"><span class="pre">pad_width</span></code> determine the before and after pad size of
an axis. The <code class="xref any docutils literal notranslate"><span class="pre">pad_width</span></code> iterable must hold an even number of
positive values which may cover all or fewer dimensions of the
input variable <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>. If <code class="xref any docutils literal notranslate"><span class="pre">pad_width</span></code> covers fewer dimensions then
it applies to the innermost dimensions of <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>Padding is performed according to the requested <code class="xref any docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<dl>
<dt>constant</dt><dd><p>Pads with a value given by the keyword argument <code class="xref any docutils literal notranslate"><span class="pre">constant_value</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</dd>
<dt>reflect</dt><dd><p>Pads with the reflection of the vector mirrored on the first
and last values of the vector along each axis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</dd>
<dt>repeat</dt><dd><p>Pads with the edge value of the vector along each axis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;repeat&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>pad_width</strong> (<em>repeated int64</em>) – Iterable of <em>before</em> and <em>after</em> pad values.</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Padding mode string.
[default= <code class="xref any docutils literal notranslate"><span class="pre">'constant'</span></code> ]</p></li>
<li><p><strong>constant_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Fill value if mode is <a class="reference internal" href="#nnabla.functions.constant" title="nnabla.functions.constant"><code class="xref any py py-func docutils literal notranslate"><span class="pre">constant</span></code></a>.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Padded N-D array with the same number of dimensions as the input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># a shape like (B, C, H, W)</span>
<span class="c1"># 1-D padding: last dim by 1 left and 2 on the right side</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># 2-D padding: last dim by (1, 1) and 2nd to last by (2, 2)</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># 3-D padding: dims C by (0, 1), H by (2, 1), and W by (3, 3)</span>
<span class="k">assert</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.transpose">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.transpose" title="Permalink to this definition"></a></dt>
<dd><p>Transposes tensor dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>axes</strong> (<em>repeated int64</em>) – Source axis indices for each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transposed N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.broadcast">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">broadcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#broadcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.broadcast" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasting ND-array to the specified shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape broadcasted to. The size must be the same in axis where <code class="docutils literal notranslate"><span class="pre">x</span></code>’s shape is not 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Broadcasted N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.broadcast_to">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">broadcast_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#broadcast_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.broadcast_to" title="Permalink to this definition"></a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is experimental support, so please do not actively use it.</p>
</div>
<p>Broadcasting ND-array to the specified buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>y</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Target axis to start broadcasting. If this is not set, broadcast will try to fit y to x starting from the last dimension
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Broadcasted N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.tile">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#tile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.tile" title="Permalink to this definition"></a></dt>
<dd><p>Forward <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> repeated the number of times given by <code class="xref any docutils literal notranslate"><span class="pre">reps</span></code>. If <code class="xref any docutils literal notranslate"><span class="pre">reps</span></code> is
a sequence, the output has dimension of <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">max(len(reps),</span> <span class="pre">x.ndim)</span></code> and
either <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> is promoted to be d-dimensional by prepending new axes or <code class="xref any docutils literal notranslate"><span class="pre">reps</span></code>
is promoted to x.ndim by prepending 1’s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array.</p></li>
<li><p><strong>reps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>sequence</em><em> of </em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Repetitions of <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># reps is promoted to [1, 3]</span>
<span class="go">(2, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># x is promoted to shape (1, 3)</span>
<span class="go">(2, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[1. 2. 3. 1. 2. 3. 1. 2. 3.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[1. 2. 3. 1. 2. 3. 1. 2. 3.]</span>
<span class="go"> [1. 2. 3. 1. 2. 3. 1. 2. 3.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[1. 3. 1. 3. 1. 3.]</span>
<span class="go"> [2. 4. 2. 4. 2. 4.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[1. 3. 1. 3. 1. 3.]</span>
<span class="go"> [2. 4. 2. 4. 2. 4.]</span>
<span class="go"> [1. 3. 1. 3. 1. 3.]</span>
<span class="go"> [2. 4. 2. 4. 2. 4.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.meshgrid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">meshgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ij_indexing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#meshgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.meshgrid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.flip">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#flip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.flip" title="Permalink to this definition"></a></dt>
<dd><p>Reverses the order of elements of the specified dimension of an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>axes</strong> (<em>repeated int64</em>) – The index of the dimension to reverse the order of the elements. Axis indices take on values 0, 1, 2, and so on from the left. For example, to flip a 32 (W) by 24 (H) 100 RGB image (100,3,24,32) vertically and horizontally, specify (2,3).
[default= <code class="xref any docutils literal notranslate"><span class="pre">[len(x.shape)</span> <span class="pre">-</span> <span class="pre">1]</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.shift">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.shift" title="Permalink to this definition"></a></dt>
<dd><p>Shifts the array elements by the specified amount.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>shifts</strong> (<em>repeated int64</em>) – The amount to shift elements. For example, to shift image data to the right by 2 pixels and up 3 pixels, specify (-3,2).
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">len(x.shape)</span></code> ]</p></li>
<li><p><strong>border_mode</strong> (<em>string</em>) – Specify how to process the ends of arrays whose values will be undetermined as a result of shifting. nearest: The data at the ends of the original      array is copied and used. reflect: Original data reflected      at the ends of the original array is used.
[default= <code class="xref any docutils literal notranslate"><span class="pre">'nearest'</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sort">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sort" title="Permalink to this definition"></a></dt>
<dd><p>Sorts the elements of <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> along a given <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> in ascending order
by value. A negative <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-axis" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">axis</span></code></a> counts from the last dimension of <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>,
so the default of -1 sorts along the last dimension. If <code class="xref any docutils literal notranslate"><span class="pre">reverse</span></code>
is True, then the elements are sorted in descending order.</p>
<p>If <code class="xref any docutils literal notranslate"><span class="pre">with_index</span></code> is True, result is a tuple <code class="docutils literal notranslate"><span class="pre">(sorted,</span> <span class="pre">indices)</span></code>
or only <code class="docutils literal notranslate"><span class="pre">indices</span></code> if <code class="xref any docutils literal notranslate"><span class="pre">only_index</span></code> is True. Setting <code class="xref any docutils literal notranslate"><span class="pre">only_index</span></code>
to True implies that <code class="xref any docutils literal notranslate"><span class="pre">with_index</span></code> is also True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="nb">sorted</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sorted</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>

<span class="nb">sorted</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">with_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sorted</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">only_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis along which to sort.</p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Sort in descending order.</p></li>
<li><p><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return sorted values and index.</p></li>
<li><p><strong>only_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return only the sort index.</p></li>
</ul>
</dd>
</dl>
<p>Returns: ~nnabla.Variable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#sorted" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">sorted</span></code></a> or ~nnabla.Variable <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code> or (~nnabla.Variable <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#sorted" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">sorted</span></code></a>, ~nnabla.Variable <code class="xref any docutils literal notranslate"><span class="pre">indices</span></code>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.shape">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.shape" title="Permalink to this definition"></a></dt>
<dd><p>Get the shape of a tensor. Optional attributes start and end can be used to compute
a slice of the input tensor’s shape. If start axis is omitted, the slice starts from
axis 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – If start axis is omitted, the slice starts from axis 0.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The end axis, if specified, is exclusive (and the returned value will not include.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.reshape">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.reshape" title="Permalink to this definition"></a></dt>
<dd><p>Reshapes the input variable in-place. It does not create a copy of the variable.
The output variable (y) has a new shape but points to the same data as the input variable (x).
This means that if the data in the output variable (y) is modified, the data in the input
variable (x) also gets modified since the reshape was done in-place.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function has the same behavior as the <a class="reference internal" href="variable.html#nnabla.Variable.reshape" title="nnabla.Variable.reshape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nnabla.Variable.reshape()</span></code></a> method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dimensions for each axis. <code class="docutils literal notranslate"><span class="pre">-1</span></code> can be specified only in one shape dimension. The value is calculated from the size of the array and remaining dimensions.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – The output array is shared with the input array if True.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reshaped N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.one_hot">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#one_hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.one_hot" title="Permalink to this definition"></a></dt>
<dd><p>This function creates one-hot vector based on input indices.
The range [-shape[i], -1] of input indices are regarded as [0, shape[i]-1],
and an input index outside [-shape[i], shape[i]-1] generates a vector
filled with zero.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">]]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 1)</span>

<span class="n">num_class</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_class</span><span class="p">,</span> <span class="p">))</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 10)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># [[0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]</span>
<span class="c1">#  [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]</span>

<span class="c1"># Can also be used for ndarray.</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 2)</span>

<span class="n">num_class_1</span><span class="p">,</span> <span class="n">num_class_2</span>  <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_class_1</span><span class="p">,</span> <span class="n">num_class_2</span><span class="p">))</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5, 10, 8)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># [[[0. 0. 0. 0. 0. 0. 0. 0.]          [[0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 1.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 1. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]    ...    [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]           [0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#   [0. 0. 0. 0. 0. 0. 0. 0.]],         [0. 0. 0. 0. 0. 0. 0. 0.]]]</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array representing label’s indice.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of classes. When nd-labels are given, dimensions must match. See the example above.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array one-hot vector/tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.assign">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign source array to destination array just like <code class="xref any docutils literal notranslate"><span class="pre">tf.assign</span></code>.
This is useful to synchronize or manually update parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dst</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">assign</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>

<span class="n">assign</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> <span class="c1"># dst and src have identical values.</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">assign</span><span class="o">.</span><span class="n">d</span> <span class="n">dst</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> <span class="c1"># returned Variable is also identical to dst.</span>
</pre></div>
</div>
<p>Unlike TensorFlow, the returned Variable has a backward path to <code class="xref any docutils literal notranslate"><span class="pre">dst</span></code>:</p>
<div class="math notranslate nohighlight">
\[g_{dst} = g_{y}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A destination N-D array</p></li>
<li><p><strong>src</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A source N-D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An assigned array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.top_k_data">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">top_k_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">largest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#top_k_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.top_k_data" title="Permalink to this definition"></a></dt>
<dd><p>Select the <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> largest values from each sample in <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> to
propagate unmodified and set all other values to 0. If <a class="reference internal" href="#nnabla.functions.abs" title="nnabla.functions.abs"><code class="xref any py py-func docutils literal notranslate"><span class="pre">abs</span></code></a> is
True, the <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> largest values are selected by magnitude. If
<a class="reference internal" href="communicator.html#nnabla.communicators.Communicator.reduce" title="nnabla.communicators.Communicator.reduce"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">reduce</span></code></a> is True (the default), all feature dimensions are
reduced to a single dimension of size <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> that propagates only
the <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> largest values. Otherwise, if <a class="reference internal" href="communicator.html#nnabla.communicators.Communicator.reduce" title="nnabla.communicators.Communicator.reduce"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">reduce</span></code></a> is False, input
and output dimensions are identical. Dimensions before
<code class="xref any docutils literal notranslate"><span class="pre">base_axis</span></code> are treated as number of sample dimensions and <code class="xref any docutils literal notranslate"><span class="pre">k</span></code>
values get selected from all elements of a sample (dimensions
from <code class="xref any docutils literal notranslate"><span class="pre">base_axis</span></code>) regardless of shape.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span><span class="o">,</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">top_k_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 5, 6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">top_k_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">top_k_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">base_axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 5, 3)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of largest data values to propagate.</p></li>
<li><p><strong>abs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Determine largest data values by magnitude.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>reduce</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Reduce feature size to one dimension of size <code class="xref any docutils literal notranslate"><span class="pre">k</span></code>.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – First dimension of the sample shape.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>largest</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to select the <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> largest or smallest values.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>with_index</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Return top-k values and indices.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.
~nnabla.Variable: N-D array of top-k indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.top_k_grad">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">top_k_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#top_k_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.top_k_grad" title="Permalink to this definition"></a></dt>
<dd><p>Select the <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> largest gradients for each sample in <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> to
back-propagate unmodified and set all other gradients to 0. If
<a class="reference internal" href="#nnabla.functions.abs" title="nnabla.functions.abs"><code class="xref any py py-func docutils literal notranslate"><span class="pre">abs</span></code></a> is True, the <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> largest gradients are selected by
magnitude. Dimensions before <code class="xref any docutils literal notranslate"><span class="pre">base_axis</span></code> are treated as number
of sample dimensions and <code class="xref any docutils literal notranslate"><span class="pre">k</span></code> gradients get selected from all
gradients of a sample (dimensions from <code class="xref any docutils literal notranslate"><span class="pre">base_axis</span></code>) regardless
of shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of largest gradients to propagate.</p></li>
<li><p><strong>abs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Determine largest gradients by magnitude.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – First dimension of the sample shape.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with same shape and data as <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.pack_padded_sequence">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">pack_padded_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">padded_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pack_padded_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.pack_padded_sequence" title="Permalink to this definition"></a></dt>
<dd><p>Pack a padded variable-length sequences.</p>
<p>This method packs a padded variable-length sequences.</p>
<p><span class="math notranslate nohighlight">\(T_i\)</span> is the length of the <span class="math notranslate nohighlight">\(i\)</span>-th Variable in the sequences.
<span class="math notranslate nohighlight">\(B\)</span> is the batch size equal to the length of the sequences.
<span class="math notranslate nohighlight">\(T\)</span> is the max of <span class="math notranslate nohighlight">\(T_i\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>.
<span class="math notranslate nohighlight">\(*\)</span> is the remaining dimensions including none.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes the length-sorted padded sequence in the decreasing order
and must be used by <a class="reference internal" href="utils/rnn.html#nnabla.utils.rnn.pack_padded_sequence" title="nnabla.utils.rnn.pack_padded_sequence"><code class="xref py py-func docutils literal notranslate"><span class="pre">pack_padded_sequence()</span></code></a> in the dynamic computation mode.
See :</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>padded_sequence</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Padded sequence of (<span class="math notranslate nohighlight">\(T \times B \times *\)</span>) or (<span class="math notranslate nohighlight">\(B \times T \times *\)</span>) shape.</p></li>
<li><p><strong>lengths</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Sequence length for each batch and always resides in CPU.</p></li>
<li><p><strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – <p><code class="xref any docutils literal notranslate"><span class="pre">padded_sequence</span></code> is of (<span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(*\)</span>) shape if False,
otherwise (<span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(*\)</span>).</p>
<p>[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Packed sequence of (<span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(*\)</span>) shape.
~nnabla.Variable: Batch size for each time and always resides in CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.pad_packed_sequence">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">pad_packed_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">packed_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#pad_packed_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.pad_packed_sequence" title="Permalink to this definition"></a></dt>
<dd><p>Pad packed sequence.</p>
<p>This method unpacks the packed sequqnce and pad it, the inverse operation of <a class="reference internal" href="#nnabla.functions.pack_padded_sequence" title="nnabla.functions.pack_padded_sequence"><code class="xref py py-func docutils literal notranslate"><span class="pre">pack_padded_sequence()</span></code></a>.</p>
<p><span class="math notranslate nohighlight">\(T_i\)</span> is the length of the <span class="math notranslate nohighlight">\(i\)</span>-th Variable in the sequences.
<span class="math notranslate nohighlight">\(B\)</span> is the batch size equal to the length of the sequences.
<span class="math notranslate nohighlight">\(T\)</span> is the max of <span class="math notranslate nohighlight">\(T_i\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>.
<span class="math notranslate nohighlight">\(*\)</span> is the remaining dimensions including none.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes the output of the length-sorted padded sequence in the decreasing order
and must be used by <a class="reference internal" href="utils/rnn.html#nnabla.utils.rnn.pad_packed_sequence" title="nnabla.utils.rnn.pad_packed_sequence"><code class="xref py py-func docutils literal notranslate"><span class="pre">pad_packed_sequence()</span></code></a> in the dynamic computation mode.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>packed_sequence</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Packed sequence of (<span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(*\)</span>) shape.</p></li>
<li><p><strong>batch_sizes</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Batch size for each time and always resides in CPU.</p></li>
<li><p><strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – <p><code class="xref any docutils literal notranslate"><span class="pre">padded_sequence</span></code> is of (<span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(*\)</span>) shape if False,
otherwise (<span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(*\)</span>).</p>
<p>[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p>
</p></li>
<li><p><strong>padding_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Padding value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>total_length</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <p>If not None, the outputs are padded up to the <code class="xref any docutils literal notranslate"><span class="pre">total_length</span></code>.
If the <code class="xref any docutils literal notranslate"><span class="pre">total_length</span></code> is less than the max length in the <code class="xref any docutils literal notranslate"><span class="pre">sequences</span></code>,
the error is thrown.</p>
<p>[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded sequence of (<span class="math notranslate nohighlight">\(T \times B \times *\)</span>) or (<span class="math notranslate nohighlight">\(B \times T \times *\)</span>) shape.
~nnabla.Variable: Sequence length for each batch and always resides in CPU.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.searchsorted">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">searchsorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sorted_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#searchsorted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.searchsorted" title="Permalink to this definition"></a></dt>
<dd><p>Finds indices in the innermost dimension of a sorted sequance where values must be inserted in order to maintain value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sorted_sequence</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of sorted sequence where search is to be performed. Note that this must be a sorted array</p></li>
<li><p><strong>values</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of Search values</p></li>
<li><p><strong>right</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – :If True, given a value v, the function returns index i such that sorted_sequence[i-1] &lt;= v &lt; sorted_sequence[i] (index of closest upper bound of v). By default, this is false so the function returns index i such that a[i-1] &lt; v &lt;= a[i] (index of closest lower bound of v)
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array containing the required indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.bool_gather">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">bool_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#bool_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.bool_gather" title="Permalink to this definition"></a></dt>
<dd><p>Gather from the input data according to the mask.</p>
<p>Given an input of <span class="math notranslate nohighlight">\((B_1, \ldots, B_N, D_1, \ldots, D_M)\)</span> shape and mask of <span class="math notranslate nohighlight">\((B_1, \ldots, B_N)\)</span> shape, the function returns an output of <span class="math notranslate nohighlight">\((nnz, D_1, \ldots, D_M)\)</span> shape and <span class="math notranslate nohighlight">\(nnz\)</span> is the number of non-zero elements in mask.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">input</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">bool_gather</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> <span class="c1"># [[1, 2], [5, 6]]</span>
</pre></div>
</div>
<p>Note that this function is normally used with the dynamic graph
since this function outputs a variable-length output. If used with the static graph,
a network has to be constructed all time in iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Data from which to gather.</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Mask with which to gather. Non-zero/zero elements are supposed to be a binary mask as 1/0. No gradients are computed with respect to mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gathered output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.bool_scatter">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">bool_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#bool_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.bool_scatter" title="Permalink to this definition"></a></dt>
<dd><p>Scatter the <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#input" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">input</span></code></a> according to the <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-mask" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">mask</span></code></a>.</p>
<p>Given an input of <span class="math notranslate nohighlight">\((nnz, D_1, \ldots, D_M)\)</span> shape and mask of <span class="math notranslate nohighlight">\((B_1, \ldots, B_N)\)</span> shape, the function returns an output <span class="math notranslate nohighlight">\((B_1, \ldots, B_N, D_1, \ldots, D_M)\)</span> and <span class="math notranslate nohighlight">\(nnz\)</span> is the number of non-zero elements in the mask.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">input0</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">output0</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">bool_gather</span><span class="p">(</span><span class="n">input0</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

<span class="n">input1</span> <span class="o">=</span> <span class="n">output0</span> <span class="o">+</span> <span class="mi">10</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">bool_scatter</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output1</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># [[11, 12], [0, 0], [15, 16]]</span>
</pre></div>
</div>
<p>Note that the higher-order gradients of this function relies on F.gather, thus
the higher-order gradients of this function is normally used with the dynamic graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Data to be scattered.</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Mask with which to scatter. Non-zero/zero elements are supposed to be a binary mask as 1/0. No gradients are computed with respect to mask.</p></li>
<li><p><strong>output</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Destination of output. If specified, data are inplaced.
[optional]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scattered output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.bool_fill">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">bool_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#bool_fill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.bool_fill" title="Permalink to this definition"></a></dt>
<dd><p>Fill the data with the value to according to the mask.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">input</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">bool_fill</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># [[-1, 2], [3, -1]]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Data to be filled.</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Mask with which to fill. Non-zero/zero elements are supposed to be a binary mask as 1/0. No gradients are computed with respect to mask.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value to fill.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filled output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.dot">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/numpy_compat_functions.html#dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.dot" title="Permalink to this definition"></a></dt>
<dd><p>A compatible operation with <code class="docutils literal notranslate"><span class="pre">numpy.dot</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any operation between nnabla’s Variable/NdArray and numpy array is not supported.</p>
<p>If both arguments are 1-D, it is inner product of vectors.
If both arguments are 2-D, it is matrix multiplication.
If either a or b is 0-D(scalar), it is equivalent to multiply.
If b is a 1-D array, it is a sum product over the last axis of a and b.
If b is an M-D array (M&gt;=2), it is a sum product over the last axis of a and the second-to-last axis of b.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a><em> or </em><em>scalar</em>) – Left input array.</p></li>
<li><p><strong>b</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a><em>, </em><a class="reference internal" href="nd_array.html#nnabla.NdArray" title="nnabla.NdArray"><em>NdArray</em></a><em> or </em><em>scalar</em>) – Right input array.</p></li>
<li><p><strong>out</strong> – Output argument. This must have the same shape, dtype, and type as the result that would be returned for F.dot(a,b).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>~nnabla.Variable or ~nnabla.NdArray</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="c1"># 2-D matrix * 2-D matrix</span>
<span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">nd1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NdArray</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="n">nd2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NdArray</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>
<span class="n">ans1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nd1</span><span class="p">,</span> <span class="n">nd2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ans1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 8)</span>

<span class="n">var1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="n">var2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>
<span class="n">ans2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<span class="n">ans2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ans2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 8)</span>

<span class="n">out1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NdArray</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">out1</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nd1</span><span class="p">,</span> <span class="n">nd2</span><span class="p">,</span> <span class="n">out1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 8)</span>

<span class="n">out2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">out2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">out2</span><span class="p">)</span>
<span class="n">out2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 8)</span>

<span class="c1"># N-D matrix * M-D matrix (M&gt;=2)</span>
<span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">8</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">nd1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NdArray</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="n">nd2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NdArray</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>
<span class="n">ans1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nd1</span><span class="p">,</span> <span class="n">nd2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ans1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 6, 7, 2, 3, 6)</span>

<span class="n">var1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="n">var2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>
<span class="n">ans2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<span class="n">ans2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ans2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 6, 7, 2, 3, 6)</span>

<span class="n">out1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NdArray</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">out1</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nd1</span><span class="p">,</span> <span class="n">nd2</span><span class="p">,</span> <span class="n">out1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 6, 7, 2, 3, 6)</span>

<span class="n">out2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">out2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">out2</span><span class="p">)</span>
<span class="n">out2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#(5, 6, 7, 2, 3, 6)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="stochasticity">
<h3>Stochasticity<a class="headerlink" href="#stochasticity" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.rand">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">rand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.rand" title="Permalink to this definition"></a></dt>
<dd><p>Samples numbers from a uniform distribution <span class="math notranslate nohighlight">\(x \sim U(low, high)\)</span>
given lowest value <span class="math notranslate nohighlight">\(low\)</span>, upper bound <span class="math notranslate nohighlight">\(high\)</span>,
and shape of the returned Variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(low\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(high\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variable with the shape specified in the argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.randint">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">randint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#randint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.randint" title="Permalink to this definition"></a></dt>
<dd><p>Samples integer numbers from a uniform distribution <span class="math notranslate nohighlight">\(x \sim U(low, high)\)</span>
given lowest value <span class="math notranslate nohighlight">\(low\)</span>, upper bound <span class="math notranslate nohighlight">\(high\)</span>, and the shape of the returned Variable. The lowest
value <span class="math notranslate nohighlight">\(low\)</span> is included in the range, while the upper bound <span class="math notranslate nohighlight">\(high\)</span> is excluded, corresponding to the half-open
interval <span class="math notranslate nohighlight">\([low, high)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(low\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(high\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variable with the shape specified in the argument. The dtype is int32.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.randn">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">randn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#randn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.randn" title="Permalink to this definition"></a></dt>
<dd><p>Samples numbers from a normal distribution <span class="math notranslate nohighlight">\(x \sim N(\mu, \sigma)\)</span>
given mean <span class="math notranslate nohighlight">\(\mu\)</span>, standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>,
and shape of the returned Variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\mu\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\sigma\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variable with the shape specified in the argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.rand_binomial">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">rand_binomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rand_binomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.rand_binomial" title="Permalink to this definition"></a></dt>
<dd><p>Samples numbers from a binomial distribution <span class="math notranslate nohighlight">\(x \sim B(n, p)\)</span>
given the numbers of trials <span class="math notranslate nohighlight">\(n\)</span>, probability <span class="math notranslate nohighlight">\(p\)</span>,
and shape of the returned Variable.
When <span class="math notranslate nohighlight">\(n = 1\)</span>, this behaves like the Bernoulli distriburion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(n\)</span> in definition, the number of trials.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(p\)</span> in definition, probability of success.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variable with the shape specified in the argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.rand_beta">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">rand_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rand_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.rand_beta" title="Permalink to this definition"></a></dt>
<dd><p>Samples numbers from a beta distribution <span class="math notranslate nohighlight">\(x \sim \beta(\alpha, \beta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\alpha\)</span>, scale parameter.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\beta\)</span>, scale parameter.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variable with the shape specified in the argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.rand_gamma">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">rand_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#rand_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.rand_gamma" title="Permalink to this definition"></a></dt>
<dd><p>Samples numbers from a gamma distribution <span class="math notranslate nohighlight">\(x \sim \frac {\gamma(k, \frac {x}{\theta})}{\Gamma(k)}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – k, scale parameter.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(\theta\)</span>, scale parameter.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Shape of returned variable.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variable with the shape specified in the argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.dropout">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">dropout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#dropout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.dropout" title="Permalink to this definition"></a></dt>
<dd><p>Dropout.
Samples a number <span class="math notranslate nohighlight">\(u\)</span> from a uniform distribution in <span class="math notranslate nohighlight">\([0, 1]\)</span> ,
and ignores the input if <span class="math notranslate nohighlight">\(u \leq p\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y = \left\{
\begin{array}{ll}
  \frac{x}{1 - p} &amp; (u &gt; p) \\
  0 &amp; ({\rm otherwise})
\end{array} \right.\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Usually dropout only applied during training as below
(except <a class="reference external" href="https://arxiv.org/abs/1506.02142">MC dropout</a>). If you want to use dropout as an MC dropout, remove ‘if train:’.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_hidden</span><span class="p">)</span>
<span class="k">if</span> <span class="n">train</span><span class="p">:</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(p\)</span> in definition.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.random_choice">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">random_choice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_choice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.random_choice" title="Permalink to this definition"></a></dt>
<dd><p>Generate random samples from population <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> with selection probabilities
determined by the relative weights <code class="xref any docutils literal notranslate"><span class="pre">w</span></code>. The number of samples to draw is
given by the product of <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a>s dimensions, and the samples are returned
with the given <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a>. By default, samples are drawn with replacement,
i.e. selection of a specific population member is solely determined by
its associated weight. Sampling without replacement, where any population
member may be drawn only once, is used if <code class="xref any docutils literal notranslate"><span class="pre">replace</span></code> is set to False.</p>
<p>For both <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">w</span></code> the innermost dimension corresponds to the individual
populations and their weights from which samples are returned with the
requested <a class="reference internal" href="#nnabla.functions.shape" title="nnabla.functions.shape"><code class="xref any py py-func docutils literal notranslate"><span class="pre">shape</span></code></a> following all outermost dimensions of the input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">nn</span><span class="o">.</span><span class="n">set_auto_forward</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># x holds two populations</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">330</span><span class="p">]]))</span>
<span class="c1"># w holds the weights for each population</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]))</span>

<span class="c1"># draw one sample from each population</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">random_choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>  <span class="c1"># y.shape =&gt; (2, 1)</span>

<span class="c1"># draw 12 samples with shape (3, 4) from each population</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">random_choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># y.shape =&gt; (2, 3, 4)</span>
</pre></div>
</div>
<p>Note that weights must not be less than zero and for each population the
sum of weights must be greater than zero. Additionally, sampling without
replacement requires that the number of non-zero weights is not less than
the number of samples to be drawn. These conditions are verified in “cpu”
computation context but not when using “cuda” or “cudnn” acceleration
(this would require additional device synchronization steps penalizing
performance).</p>
<p>Random sampling from an implicit array of index values (like categorical
or multinomial) can be realized with input <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> constructed as indices.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">random_choice</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array from which a random sample is generated.</p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of associated weights of elements in <code class="xref any docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number and shape of generated samples.
[default= <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code> ]</p></li>
<li><p><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether sampling is with or without replacement.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.random_crop">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">random_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.random_crop" title="Permalink to this definition"></a></dt>
<dd><p>RandomCrop randomly extracts a portion of an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The data size to extract. For example, to randomly extract a portion of the image (3,48,48) from a 3,64,64 image, specify (3,48,48).
[default= <code class="xref any docutils literal notranslate"><span class="pre">x.shape</span></code> ]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – No Description
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.random_erase">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">random_erase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.02,</span> <span class="pre">0.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.3,</span> <span class="pre">3.3333)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replacements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">255.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ste_fine_grained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_erase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.random_erase" title="Permalink to this definition"></a></dt>
<dd><p>Randomly erase patches of the inputs and replace with random values.</p>
<p>Erasing is applied for each sample and for each <code class="xref any docutils literal notranslate"><span class="pre">n</span></code> with the given probability, the randomly
selected area ratio and aspect ratio if <code class="xref any docutils literal notranslate"><span class="pre">share</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>;
otherwise (<code class="xref any docutils literal notranslate"><span class="pre">share`=`False</span></code>), for each feature additionally.</p>
<p>Random patch are selected by random coordinates as the following,</p>
<div class="math notranslate nohighlight">
\[\begin{split}S_e &amp;&amp;= Uniform(s_l, s_h) \times S \\
r_e &amp;&amp;= Uniform(r_l, r_h) \\
H_e &amp;&amp;= \sqrt{S_e \times r_e} \\
W_e &amp;&amp;= \sqrt{S_e / r_e} \\
y_e &amp;&amp;= Uniform(0, H - H_e) \\
x_e &amp;&amp;= Uniform(0, W - W_e),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is the area, <span class="math notranslate nohighlight">\(s_l\)</span> and <span class="math notranslate nohighlight">\(s_h\)</span> are the low and high values of
the area ratio range, <span class="math notranslate nohighlight">\(r_l\)</span> and <span class="math notranslate nohighlight">\(r_h\)</span> are the low and high values
of the aspect ratio range, <span class="math notranslate nohighlight">\(H_e\)</span> and <span class="math notranslate nohighlight">\(W_e\)</span> are height and width of a patch,
and <span class="math notranslate nohighlight">\(y_e\)</span> and <span class="math notranslate nohighlight">\(x_e\)</span> are the start coordinates of a patch. If a pixel of the inputs
falls in this patch, the value of that pixel is replaced with a random value in <code class="xref any docutils literal notranslate"><span class="pre">replacements</span></code>
range.</p>
<p>Backward is implemented as passing gradients if <code class="xref any docutils literal notranslate"><span class="pre">ste_fine_grained</span></code> is False; otherwise,
the backward only occurs in regions not erased.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1708.04896">Zhun Zhong, Liang Zheng, Guoliang Kang, Shaozi Li, Yi Yang,
Random Erasing Data Augmentation,</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>prob</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Probability to erase.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>area_ratios</strong> (<em>repeated float</em>) – Low and high of the area ratio range.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0.02,</span> <span class="pre">0.4)</span></code> ]</p></li>
<li><p><strong>aspect_ratios</strong> (<em>repeated float</em>) – Low and high of the aspect ratios range.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0.3,</span> <span class="pre">3.3333)</span></code> ]</p></li>
<li><p><strong>replacements</strong> (<em>repeated float</em>) – Low and high of the replacement value range.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0.0,</span> <span class="pre">255.0)</span></code> ]</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Max number of patches to be erased.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>share</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use a same bounding box randomly picked over the feature dimension when being True. Default is True.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – This option is obsolete and ignored. Output is never in-placed with input.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>ste_fine_grained</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Straight Through Estimator is fine-grained or not. Default is True.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.random_flip">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">random_flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_flip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.random_flip" title="Permalink to this definition"></a></dt>
<dd><p>Reverses the order of elements of the specified dimension of an array at 50% probability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>axes</strong> (<em>repeated int64</em>) – The index of the axis to reverse the order of the elements. Axis indices take on values 0, 1, 2, and so on from the left. For example, to flip a 32 (W) by 24 (H) 100 RGB images (100, 3,24,32) vertically and horizontally at random, specify (2,3).
[default= <code class="xref any docutils literal notranslate"><span class="pre">[len(x.shape)</span> <span class="pre">-</span> <span class="pre">1]</span></code> ]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – No Description
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.random_shift">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">random_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#random_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.random_shift" title="Permalink to this definition"></a></dt>
<dd><p>Randomly shifts the array elements within the specified range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>shifts</strong> (<em>repeated int64</em>) – Max absolute amount to shift elements. For example, to shift image data horizontally by <span class="math notranslate nohighlight">\(\pm 2\)</span> pixels and vertically by <span class="math notranslate nohighlight">\(\pm 3\)</span> pixels, specify (3,2).
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">len(x.shape)</span></code> ]</p></li>
<li><p><strong>border_mode</strong> (<em>string</em>) – Specify how to process the ends of arrays whose values will be undetermined as a result of shifting. nearest: The data at the ends of the   original array is copied and used. reflect: Original data reflected at   the ends of the original array is used. constant: Constant value is used.
[default= <code class="xref any docutils literal notranslate"><span class="pre">'nearest'</span></code> ]</p></li>
<li><p><strong>constant_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Value used for outside of the original array if border_mode=’constant’.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0</span></code> ]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – No Description
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.image_augmentation">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">image_augmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distortion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_ud</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_each</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_each</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#image_augmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.image_augmentation" title="Permalink to this definition"></a></dt>
<dd><p>ImageAugmentation randomly alters the input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The output image data size.
[default= <code class="xref any docutils literal notranslate"><span class="pre">x.shape</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Border padding values for each spatial axis. Padding will be added both sides of the dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> ]</p></li>
<li><p><strong>min_scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The minimum scale ratio when randomly scaling the image. For example, to scale down to 0.8 times the size of the original image, specify “0.8”. To not apply random scaling, set both min_scale and max_scale to “1.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
<li><p><strong>max_scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The maximum scale ratio when randomly scaling the image. For example, to scale down to 2 times the size of the original image, specify “2.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The rotation angle range in radians when randomly rotating the image. The image is randomly rotated in the -Angle to +Angle range. For example, to rotate in a +-15 degree range, specify “0.26” (15 degrees/360 degrees * 2PI). To not apply random rotation, specify “0.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>aspect_ratio</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The aspect ratio range when randomly deforming the image. For example, to deform aspect ratio of image from 1:1.3 to 1.3:1, specify “1.3”. To not apply random deforming, specify “1.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
<li><p><strong>distortion</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The distortion range when randomly distorting the image. To not apply distortion, specify “0.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>flip_lr</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to randomly flip the image horizontally at 50% probability.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>flip_ud</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to randomly flip the image vertically at 50% probability.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>brightness</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The absolute range of values to randomly add to the brightness. A random value in the -Brightness to +Brightness range is added to the brightness. For example, to vary the brightness in the -0.05 to +0.05 range, specify “0.05”. To not apply random addition to brightness, specify “0.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>brightness_each</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to apply the random addition to brightness (as specified by brightness) to each color channel. True: brightness is added based on a different random number for each channel. False: brightness is added based on a random number common to all channels.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>contrast</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The range in which to randomly vary the image contrast. The contrast is varied in the 1/Contrast times to Contrast times range. The output brightness is equal to (input - contrast_center) * contrast + contrast_center. For example, to vary the contrast in the 0.91 times to 1.1 times range, specify “1.1”. To not apply random contrast variation, specify “1.0”.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
<li><p><strong>contrast_center</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Intensity center used for applying contrast.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>contrast_each</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether to apply the random contrast variation (as specified by contrast) to each color channel. True: contrast is varied based on a different random number for each channel. False: contrast is varied based on a random number common to all channels.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>noise</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Sigma of normal random number to be added.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.0</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="loss-functions">
<h3>Loss Functions<a class="headerlink" href="#loss-functions" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sigmoid_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sigmoid_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sigmoid_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sigmoid_cross_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise cross entropy between <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> and the target variables, passed to a sigmoid function.</p>
<div class="math notranslate nohighlight">
\[y_i = - \left(x^{(1)}_i \ln \left(\sigma \left(x^{(0)}_i \right)\right) + \
\left(1 - x^{(1)}_i\right) \ln \left(1 - \sigma \left(x^{(0)}_i \
\right)\right)\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma(s)=\frac{1}{1+\exp(-s)}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SigmoidCrossEntropy is equivalent to Sigmoid+BinaryCrossEntropy, but computing them at once has the effect of reducing computational error.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score. The value lies in <span class="math notranslate nohighlight">\([-\infty, \infty]\)</span>
[parameter]</p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. Only 0 or 1 value is allowed.
[parameter]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of element-wise losses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_cross_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise cross entropy between <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> and the target variables.</p>
<div class="math notranslate nohighlight">
\[y_i = - \left(x^{(1)}_i * \ln \left(x^{(0)}_i\right) + \left(1 - \
x^{(1)}_i\right) * \ln \left(1 - x^{(0)}_i\right)\right).\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Probabilities N-D array. <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>.</p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. Usually set as 0 or 1, but, unlike SigmoidCrossEntropy, it allows probability (0 to 1) as inputs and backpropagation can be done.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of element-wise losses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.softmax_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">softmax_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#softmax_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.softmax_cross_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise cross entropy between the variables and the variables of a label given by a category index with Softmax normalization.</p>
<div class="math notranslate nohighlight">
\[y_{j} = -\ln \left(\frac{\exp(x_{j,t_j})}{\sum_{i'} \exp(x_{j,i'})}\right)\]</div>
<p>along dimension specified by axis (<span class="math notranslate nohighlight">\(i\)</span> is the axis where normalization is performed on).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SoftmaxCrossEntropy is equivalent to Softmax+CategoricalCrossEntropy, but computing them at once has the effect of reducing computational error.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score. <span class="math notranslate nohighlight">\((D_1 \times ... \times D_i \times ... \times D_N)\)</span>
[parameter]</p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span> , each label should be the index from 0 to n-class, -1 if not belongs any class.
[parameter]</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x.shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of element-wise losses. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.categorical_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">categorical_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#categorical_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.categorical_cross_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise cross entropy between <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> and the target <code class="xref any docutils literal notranslate"><span class="pre">t</span></code> where targets are given by a category index.</p>
<div class="math notranslate nohighlight">
\[y_{j} = -\ln \left( x_{j, t_j} \right)\]</div>
<p>along dimension specified by axis (<span class="math notranslate nohighlight">\(i\)</span> is the axis where normalization is performed on).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array. Typically indicates a score. <span class="math notranslate nohighlight">\((D_1 \times ... \times D_i \times ... \times D_N)\)</span>
[parameter]</p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span>, each label should be the index from 0 to n-class, -1 if not belongs any class.
[parameter]</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis normalization is taken.
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x.shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of element-wise losses. <span class="math notranslate nohighlight">\((D_1 \times ... \times 1 \times ... \times D_N)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.squared_error">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#squared_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.squared_error" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise squared error</p>
<div class="math notranslate nohighlight">
\[y_i = \left(x^{(0)}_i - x^{(1)}_i\right)^2.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.absolute_error">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">absolute_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#absolute_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.absolute_error" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise absolute error</p>
<div class="math notranslate nohighlight">
\[y_i = | x^{(0)}_i - x^{(1)}_i |.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.huber_loss">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">huber_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#huber_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.huber_loss" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Huber loss</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \left\{
\begin{array}{ll}
  d^2 &amp; (|d| &lt; \delta)\\
  \delta (2 |d| - \delta) &amp; ({\rm otherwise})
\end{array} \right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d = x^{(0)}_i - x^{(1)}_i\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Delta
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of element-wise losses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.epsilon_insensitive_loss">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">epsilon_insensitive_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#epsilon_insensitive_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.epsilon_insensitive_loss" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise Epsilon Insensitive Loss</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i= \left\{
\begin{array}{ll}
  | x^{(0)}_i - x^{(1)}_i | - \epsilon &amp; if \ \ | x^{(0)}_i - x^{(1)}_i | &gt; \epsilon \\
                0 &amp; otherwise
\end{array} \right.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>x1</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Insensitive parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array of element-wise losses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.kl_multinomial">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">kl_multinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#kl_multinomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.kl_multinomial" title="Permalink to this definition"></a></dt>
<dd><p>The Kullback Leibler Divergence for multinomial distributions.</p>
<div class="math notranslate nohighlight">
\[D = \sum_i p_i \log \left( \frac{p_i}{q_i} \right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of the source categorical probabilities</p></li>
<li><p><strong>q</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of the target categorical probabilities</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Kullback Leibler divergence <span class="math notranslate nohighlight">\(KL(p \parallel q)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="signal-processing">
<h3>Signal Processing<a class="headerlink" href="#signal-processing" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.interpolate">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">half_pixel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">half_pixel_for_nn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.interpolate" title="Permalink to this definition"></a></dt>
<dd><p>Resize an ND array with interpolation.</p>
<p>Scaling factors for spatial dimensions are determined by either
<code class="docutils literal notranslate"><span class="pre">scale</span></code> or <code class="docutils literal notranslate"><span class="pre">output_size</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nd</span> <span class="pre">=</span> <span class="pre">len(scale)</span></code> or <code class="docutils literal notranslate"><span class="pre">nd</span> <span class="pre">=</span> <span class="pre">len(output_size)</span></code> determines the number of
spatial dimensions, and the last <code class="docutils literal notranslate"><span class="pre">nd</span></code> dimensions of the input <code class="docutils literal notranslate"><span class="pre">x</span></code> are
considered as the spatial dimensions to be resized.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">scale</span></code> is given, the <code class="docutils literal notranslate"><span class="pre">output_size</span></code> is calculated by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output_size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">scale</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)])</span><span class="o">.</span>
</pre></div>
</div>
<p>Calculation of the coordinate transformation are as follows.</p>
<p>The input coordinate i_input is computed by the output coordinate i_output,
the input size size_input, and the output size size_output as</p>
<table class="docutils align-center">
<thead>
<tr class="row-odd"><th class="head"><p>align_corners</p></th>
<th class="head"><p>half_pixel</p></th>
<th class="head"><p>i_input</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>True</p></td>
<td><p>True</p></td>
<td><p>Not supported.</p></td>
</tr>
<tr class="row-odd"><td><p>True</p></td>
<td><p>False</p></td>
<td><p>i_output * (size_input - 1) / (size_output - 1)</p></td>
</tr>
<tr class="row-even"><td><p>False</p></td>
<td><p>True</p></td>
<td><p>(i_output + 0.5) * size_input / size_output - 0.5</p></td>
</tr>
<tr class="row-odd"><td><p>False</p></td>
<td><p>False</p></td>
<td><p>i_output * size_input / size_output</p></td>
</tr>
</tbody>
</table>
<p>In the case of the <code class="xref any docutils literal notranslate"><span class="pre">nearest</span></code> mode and <code class="docutils literal notranslate"><span class="pre">half_pixel_for_nn</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the input coordinate i_input is computed by the output coordinate i_output as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i_input</span> <span class="o">=</span> <span class="p">(</span><span class="n">i_output</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">size_input</span> <span class="o">/</span> <span class="n">size_output</span><span class="o">.</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>

<span class="c1"># Resize by scales</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (64, 3, 448, 448)</span>
<span class="n">y</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># Print output</span>

<span class="c1"># Resize to a size</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">257</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (64, 3, 320, 257)</span>
<span class="n">y2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># Print output</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with an arbitrary number of dimensions.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – Scale factors along axes. The default is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, and if this is omitted, <code class="docutils literal notranslate"><span class="pre">output_size</span></code> must be specified.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> of </em><em>ints</em>) – The output sizes for axes. If this is
given, the scale factors are determined by the output sizes and the
input sizes. The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, and if this is omitted,
<code class="docutils literal notranslate"><span class="pre">scale</span></code> must be specified.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Interpolation mode chosen from (‘linear’|’nearest’).
The default is ‘linear’.</p></li>
<li><p><strong>align_corners</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, the corner pixels of input and output
arrays are aligned, such that the output corner pixels have the
same values with the input corner pixels. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>half_pixel</strong> – If true, in the coordinate transformation, 0.5 is added to the output coordinate
and 0.5 is subtracted from the input coordinate after scaling. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>half_pixel_for_nn</strong> – This is a special argument to support the backward-compatibility of the nearest neighbor interpolation.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>. When in <code class="docutils literal notranslate"><span class="pre">True</span></code>, the implementation of nearest neighbor interpolation
is the old one.</p></li>
<li><p><strong>channel_last</strong> – Last dimension is the channel (NHWC order) if True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Up to the version 1.8.0, the default of <code class="xref any docutils literal notranslate"><span class="pre">align_corners</span></code> was <code class="docutils literal notranslate"><span class="pre">None</span></code>, and it becomes <code class="docutils literal notranslate"><span class="pre">True</span></code>
if <code class="xref any docutils literal notranslate"><span class="pre">mode</span></code> is linear, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Up to the version 1.8.0, the nearest <code class="xref any docutils literal notranslate"><span class="pre">mode</span></code> interpolation corresponds to
the nearest <code class="xref any docutils literal notranslate"><span class="pre">mode</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">half_pixel_for_nn</span></code> = <code class="docutils literal notranslate"><span class="pre">True</span></code> after the version 1.8.0.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.fft">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.fft" title="Permalink to this definition"></a></dt>
<dd><p>Complex-to-complex Discrete Fourier Transform,</p>
<div class="math notranslate nohighlight">
\[X_{k_1, \ldots, k_d} = \sum_{n_1=0}^{N_1-1} \dots \sum_{n_d=0}^{N_d-1} x_{n_1, \ldots, n_d} \exp\left(-2 \pi j \left( \sum_{i=0}^{d} \frac{k_i n_i}{N_i} \right) \right),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[k_i = 0, \ldots, N_i - 1.\]</div>
<p>This function now supports 1-D, 2-D, and 3-D DFT with or without the leading batch dimension(s).</p>
<p>The input is expected to be complex-valued with at least signal_ndim + 1 dimensions.
The last dimension has a shape of two where x[…, 0] is the real part and x[…, 1] the imaginary part.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">nnabla.ext_utils</span> <span class="kn">import</span> <span class="n">get_extension_context</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">get_extension_context</span><span class="p">(</span><span class="s2">&quot;cudnn&quot;</span><span class="p">)</span>
<span class="n">nn</span><span class="o">.</span><span class="n">set_default_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

<span class="c1"># Example for a batched 2D-FFT and 2D-IFFT (batch-size: 2, data-size: 4x3)</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x_data</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">signal_ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">signal_ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">z</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">z</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_data</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</p></li>
<li><p><strong>signal_ndim</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of dimensions for each signal. It must be 1, 2, or 3.</p></li>
<li><p><strong>normalized</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use unitary normalization. If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, the normalization constant <span class="math notranslate nohighlight">\(\sqrt{\frac{1}{\prod_{i=1}^{d} N_i}}\)</span> is multiplied.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FFT transformed signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.ifft">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">ifft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.ifft" title="Permalink to this definition"></a></dt>
<dd><p>Complex-to-complex inverse Discrete Fourier Transform,</p>
<div class="math notranslate nohighlight">
\[X_{k_1, \ldots, k_d} = \frac{1}{\prod_{i=1}^{d} N_i} \sum_{n_1=0}^{N_1-1} \dots \sum_{n_d=0}^{N_d-1} x_{n_1, \ldots, n_d} \exp\left(2 \pi j \left( \sum_{i=0}^{d} \frac{k_i n_i}{N_i} \right) \right),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[k_i = 0, \ldots, N_i - 1.\]</div>
<p>This function now supports 1-D, 2-D, and 3-D DFT with or without the leading batch dimension(s).</p>
<p>The input is expected to be complex-valued with at least signal_ndim + 1 dimensions.
The last dimension has a shape of two where x[…, 0] is the real part and x[…, 1] the imaginary part.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</p></li>
<li><p><strong>signal_ndim</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of dimensions for each signal. It must be 1, 2, or 3.</p></li>
<li><p><strong>normalized</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use unitary normalization. If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, the normalization constant <span class="math notranslate nohighlight">\(\frac{1}{\prod_{i=1}^{d} N_i}\)</span> becomes <span class="math notranslate nohighlight">\(\sqrt{\frac{1}{\prod_{i=1}^{d} N_i}}\)</span>.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>IFFT transformed signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.stft">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">stft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_istft_backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#stft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.stft" title="Permalink to this definition"></a></dt>
<dd><p>Computes the short-time Fourier transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Time domain sequence of size <code class="xref any docutils literal notranslate"><span class="pre">batch_size</span> <span class="pre">x</span> <span class="pre">sample_size</span></code>.</p></li>
<li><p><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of STFT analysis window.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of samples that we shift the window, also called <code class="xref any docutils literal notranslate"><span class="pre">hop</span> <span class="pre">size</span></code>.</p></li>
<li><p><strong>fft_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of the FFT, the output will have <code class="xref any docutils literal notranslate"><span class="pre">fft_size</span> <span class="pre">//</span> <span class="pre">2+</span> <span class="pre">1</span></code> frequency bins.</p></li>
<li><p><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Analysis window, can be either <code class="xref any docutils literal notranslate"><span class="pre">hanning</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">hamming</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">rectangular</span></code>.
For convenience, also <code class="xref any docutils literal notranslate"><span class="pre">window_type=None</span></code> is supported which is equivalent to <code class="xref any docutils literal notranslate"><span class="pre">window_type='rectangular'</span></code>.</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, then the signal <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> is padded by half the FFT size using reflection padding.</p></li>
<li><p><strong>pad_mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Padding mode, which can be <code class="xref any docutils literal notranslate"><span class="pre">'constant'</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">'reflect'</span></code>. <code class="xref any docutils literal notranslate"><span class="pre">'constant'</span></code> pads with <code class="xref any docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>as_istft_backward</strong> – If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, then forward execution behaves as backward execution of ISTFT,
treating input <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> as output gradient of ISTFT and outputs <code class="xref any docutils literal notranslate"><span class="pre">y_r</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">y_i</span></code> as inputs gradient of ISTFT.
This option is only used in nn.grad operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Returns real and imaginary parts of STFT result.</p>
<ul class="simple">
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Real part of STFT of size <code class="xref any docutils literal notranslate"><span class="pre">batch_size</span> <span class="pre">x</span> <span class="pre">fft_size//2</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">x</span> <span class="pre">frame_size</span></code>.</p></li>
<li><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Variable</span></code></a>: Imaginary part of STFT of size <code class="xref any docutils literal notranslate"><span class="pre">batch</span> <span class="pre">x</span> <span class="pre">fft_size//2</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">x</span> <span class="pre">frame_size</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.istft">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">istft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_stft_backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#istft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.istft" title="Permalink to this definition"></a></dt>
<dd><p>Computes the inverse shoft-time Fourier transform</p>
<p>Note: We use a constant square inverse window for the reconstruction
of the time-domain signal, therefore, the first and last
<code class="xref any docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">stride</span></code> are not perfectly reconstructed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_r</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Real part of STFT of size <code class="xref any docutils literal notranslate"><span class="pre">batch_size</span> <span class="pre">x</span> <span class="pre">fft_size//2</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">x</span> <span class="pre">frame_size</span></code>.</p></li>
<li><p><strong>y_i</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Imaginary part of STFT of size <code class="xref any docutils literal notranslate"><span class="pre">batch_size</span> <span class="pre">x</span> <span class="pre">fft_size//2</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">x</span> <span class="pre">frame_size</span></code>.</p></li>
<li><p><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of STFT analysis window.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of samples that we shift the window, also called <code class="xref any docutils literal notranslate"><span class="pre">hop</span> <span class="pre">size</span></code>.</p></li>
<li><p><strong>fft_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Size of the FFT, (STFT has <code class="xref any docutils literal notranslate"><span class="pre">fft_size</span> <span class="pre">//</span> <span class="pre">2</span> <span class="pre">+</span> <span class="pre">1</span></code> frequency bins).</p></li>
<li><p><strong>window_type</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Analysis window, can be either <code class="xref any docutils literal notranslate"><span class="pre">hanning</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">hamming</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">rectangular</span></code>.
For convenience, also <code class="xref any docutils literal notranslate"><span class="pre">window_type=None</span></code> is supported which is equivalent to <code class="xref any docutils literal notranslate"><span class="pre">window_type='rectangular'</span></code>.</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, then it is assumed that the time-domain signal has centered frames.</p></li>
<li><p><strong>pad_mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Padding mode corresponding to STFT <code class="xref any docutils literal notranslate"><span class="pre">pad_mode</span></code>, which can be <code class="xref any docutils literal notranslate"><span class="pre">'constant'</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">'reflect'</span></code>. <code class="xref any docutils literal notranslate"><span class="pre">'constant'</span></code> pads with <code class="xref any docutils literal notranslate"><span class="pre">0</span></code>.
This option is ignored for the normal use of ISTFT. You need to set the same <code class="xref any docutils literal notranslate"><span class="pre">pad_mode</span></code> only when <code class="xref any docutils literal notranslate"><span class="pre">as_stft_backward</span> <span class="pre">==</span> <span class="pre">True</span></code>.</p></li>
<li><p><strong>as_stft_backward</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, then forward execution behaves as backward execution of STFT,
treating inputs <code class="xref any docutils literal notranslate"><span class="pre">y_r</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">y_i</span></code> as outputs gradient of STFT and output <code class="xref any docutils literal notranslate"><span class="pre">x</span></code> as input gradient of STFT.
This option is only used in nn.grad operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Time domain sequence of size <code class="xref any docutils literal notranslate"><span class="pre">batch_size</span> <span class="pre">x</span> <span class="pre">sample_size</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="geometric-neural-network-layers">
<h3>Geometric Neural Network Layers<a class="headerlink" href="#geometric-neural-network-layers" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.affine_grid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">affine_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#affine_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.affine_grid" title="Permalink to this definition"></a></dt>
<dd><p>Generate the source grid based on the normalized target grid with <a class="reference internal" href="communicator.html#nnabla.communicators.Communicator.size" title="nnabla.communicators.Communicator.size"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">size</span></code></a>.
The target grid is first normalized in [-1, 1], then
tranformed by the affine transformation <span class="math notranslate nohighlight">\(\theta\)</span> to generate
the source grid. 2D and 3D grid are supported now.</p>
<p>This function is normally used with the <a class="reference internal" href="#nnabla.functions.warp_by_grid" title="nnabla.functions.warp_by_grid"><code class="xref any py py-func docutils literal notranslate"><span class="pre">warp_by_grid</span></code></a> function for
constructing the spatial transformer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array with the shape (<span class="math notranslate nohighlight">\(B \times 2 \times 3\)</span>), the sample-wise affine transformation matrix.</p></li>
<li><p><strong>size</strong> (<em>repeated int64</em>) – The grid size of (<span class="math notranslate nohighlight">\(H \times W\)</span>) for 2D and (<span class="math notranslate nohighlight">\(D \times H \times W\)</span>) for 3D.</p></li>
<li><p><strong>align_corners</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, the top-left and bottom-right pixels correspond to (-1, -1) and (1, 1) respectively since a pixel is located on the corner of a grid, and the target grid is normalized in [-1, 1].
If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>, the normalized target grid in [-1, 1] is scaled by <code class="xref any docutils literal notranslate"><span class="pre">size</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">/</span> <span class="pre">size</span></code> according to the respective spatial size (e.g., <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(W\)</span>) before the transformation since a pixel is located on a center of a cell in a grid.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the shape (<span class="math notranslate nohighlight">\(B \times H \times W \times 2\)</span>) for 2D and (<span class="math notranslate nohighlight">\(B \times D \times H \times W \times 3\)</span>) for 3D. The last dimension of 2 is for (x, y) and of 3 for (x, y, z). The <code class="xref any docutils literal notranslate"><span class="pre">gird</span></code> is used as the source grid for the warping.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.warp_by_grid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">warp_by_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#warp_by_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.warp_by_grid" title="Permalink to this definition"></a></dt>
<dd><p>Warp the input data by the grid.
This function is normally used with the generated normalized grid by
the <a class="reference internal" href="#nnabla.functions.affine_grid" title="nnabla.functions.affine_grid"><code class="xref any py py-func docutils literal notranslate"><span class="pre">affine_grid</span></code></a> function for constructing the spatial transformer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input data to be warped with the shape (<span class="math notranslate nohighlight">\(B \times C \times H_{in} \times W_{in}\)</span>) for 2D and (<span class="math notranslate nohighlight">\(B \times C \times D_{in} \times H_{in} \times W_{in}\)</span>) for 3D.</p></li>
<li><p><strong>grid</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Grid warping the input data with the shape (<span class="math notranslate nohighlight">\(B \times H_{out} \times W_{out} \times 2\)</span>) for 2D and (<span class="math notranslate nohighlight">\(B \times D_{out} \times H_{out} \times W_{out} \times 3\)</span>) for 3D. The last dimension of 2 is for (x, y) or 3 for (x, y, z).</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Interpolation mode, linear or nearest.
[default= <code class="xref any docutils literal notranslate"><span class="pre">'linear'</span></code> ]</p></li>
<li><p><strong>padding_mode</strong> (<em>string</em>) – Padding mode when the grid value is outside [-1, 1]. If this is “zero”, 0 is used for padding. “reflect” uses the values reflected at the ends of the original input data like the mirror. “repeat” used the values at the ends of the original input data.
[default= <code class="xref any docutils literal notranslate"><span class="pre">'zero'</span></code> ]</p></li>
<li><p><strong>align_corners</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – The target grid normalized in [-1, 1] is scaled by <code class="xref any docutils literal notranslate"><span class="pre">size</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">/</span> <span class="pre">size</span></code> according to the respective spatial size (e.g., <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(W\)</span>) before the transformation if this is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>. If this is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, the top-left and bottom-right pixels correspond to (-1, -1) and (1, 1) respectively.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
<li><p><strong>channel_last</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If True, the last dimension is considered as channel dimension, a.k.a NHWC order.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output data warped by the grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.warp_by_flow">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">warp_by_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#warp_by_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.warp_by_flow" title="Permalink to this definition"></a></dt>
<dd><p>Transform the image(s) <em>data</em> by <em>flow</em> field(s) of offset vectors such
that each output pixel corresponds to the input image pixel at the
relative offset location given by horizontal and vertical flow values
(in other words, the flow field describes the coordinate displacements
for each output pixel to the corresponding input pixel). Both <em>data</em> and
<em>flow</em> are 4-D variables (in “NCHW” layout) with identical shape except
the <em>flow</em> channel dimension (which is always 2).</p>
<div class="math notranslate nohighlight">
\[output_{n,c,y,x} = data_{n,c,y',x'},\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}y' &amp;=&amp; y + flow_{n,1,y,x}, \\
x' &amp;=&amp; x + flow_{n,0,y,x}.\end{split}\]</div>
<p>The output pixel values at <span class="math notranslate nohighlight">\(y'\)</span> and <span class="math notranslate nohighlight">\(x'\)</span> locations are
obtained by bilinear interpolating between the 4 closest pixels of the
input image. Pixel values outside of the input image are implicitly
padded with the value of the closest boundary pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input image data with shape <code class="xref any docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">Channels,</span> <span class="pre">Height,</span> <span class="pre">Width)</span></code>.</p></li>
<li><p><strong>flow</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Flow field vectors with shape <code class="xref any docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">2,</span> <span class="pre">Height,</span> <span class="pre">Width)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed image data with shape <code class="xref any docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">Channels,</span> <span class="pre">Height,</span> <span class="pre">Width)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="quantized-neural-network-layers">
<h3>Quantized Neural Network Layers<a class="headerlink" href="#quantized-neural-network-layers" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_sigmoid">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_sigmoid" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise binary sigmoid function. In the forward pass, it computes</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = \begin{cases}
    1 &amp; (x &gt; 0) \\
    0 &amp; ({\rm otherwise})\end{cases},\end{split}\]</div>
<p>but in the backward pass, a straight-through approximation of the gradient
is used, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial f(x)}{\partial x} =
\begin{cases}
    0 &amp; (|x| \geq 1) \\
    \frac{1}{2} &amp; ({\rm otherwise})
\end{cases}.\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1602.02830">Courbariaux, Matthieu, and Yoshua Bengio. Binarynet: Training deep
neural networks with weights and activations constrained to+ 1 or-1.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_tanh">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_tanh" title="Permalink to this definition"></a></dt>
<dd><p>Element-wise binary tanh function. In the forward pass, it computes</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = \begin{cases}
    1 &amp; (x &gt; 0) \\
    -1 &amp; ({\rm otherwise})
\end{cases},\end{split}\]</div>
<p>but in the backward pass, a straight-through approximation of the gradient
is used, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial f(x)}{\partial x} =
\begin{cases}
    0 &amp; (|x| \geq 1) \\
    1 &amp; ({\rm otherwise}) \end{cases}.\end{split}\]</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1602.02830">Courbariaux, Matthieu, and Yoshua Bengio. Binarynet: Training deep
neural networks with weights and activations constrained to+ 1 or-1.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_connect_affine">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_connect_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize_zero_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_connect_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_connect_affine" title="Permalink to this definition"></a></dt>
<dd><p>This function provides a BinaryConnect affine layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_j = \sum_{i} sign(w_{j,i}) x_i,\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{j,i}\)</span> are binarized to <span class="math notranslate nohighlight">\(sign(w_{j,i})\)</span> and,
hence, each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>. By this weight binarization, the
inner product computations do not require any multiplications anymore as
they turn into additions/subtractions.</p>
<p>This function should be used together with
<a class="reference internal" href="#nnabla.functions.batch_normalization" title="nnabla.functions.batch_normalization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">batch_normalization()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1) If you would like to share the binary weights between other
layers, please use the standard, floating value weights (<code class="xref any docutils literal notranslate"><span class="pre">weight</span></code>)
and not the binary weights (<code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once before
doing so, otherwise the weights and the binary weights will not be in sync.</p>
<p>3) CPU and GPU implementations now use floating values for <code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>,
since this function is for simulation purposes.</p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1511.00363">M. Courbariaux, Y. Bengio, and J.-P. David. BinaryConnect:
Training Deep Neural Networks with binary weights during propagations.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight .
[parameter]</p></li>
<li><p><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight .
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_connect_convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_connect_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize_zero_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_connect_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_connect_convolution" title="Permalink to this definition"></a></dt>
<dd><p>This function provides a BinaryConnect convolution layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_{n, a, b} = \sum_{m} \sum_{i} \sum_{j} sign(w_{n, m, i, j}) x_{m, a + i, b + j},\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{n, m, i, j}\)</span> are binarized to
<span class="math notranslate nohighlight">\(sign(w_{n, m, i, j})\)</span> and, hence,
each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>. By this weight binarization, the
inner product computations do not require any multiplications anymore as
they turn into additions/subtractions.</p>
<p>This function should be used together with <a class="reference internal" href="#nnabla.functions.batch_normalization" title="nnabla.functions.batch_normalization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">batch_normalization()</span></code></a>.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1511.00363">M. Courbariaux, Y. Bengio, and J.-P. David. BinaryConnect:
Training Deep Neural Networks with binary weights during propagations.</a></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1) If you would like to share the binary weights between other
layers, please use the standard, floating value weights (<code class="xref any docutils literal notranslate"><span class="pre">weight</span></code>)
and not the binary weights (<code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once before
doing so, otherwise the weights and the binary weights will not be in sync.</p>
<p>3) CPU and GPU implementations now use floating values for <code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>,
since this function is for simulation purposes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</p></li>
<li><p><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight.
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_weight_affine">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_weight_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize_zero_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_weight_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_weight_affine" title="Permalink to this definition"></a></dt>
<dd><p>This function provides a Binary Weight Network affine layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_j = \frac{1}{\|\mathbf{w}_j\|_{\ell_1}} \sum_{i} sign(w_{j,i}) x_i\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{j,i}\)</span> are binarized to <span class="math notranslate nohighlight">\(sign(w_{j,i})\)</span> and,
hence, each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>. By this weight binarization, the
inner product computations turn into additions/subtractions which are followed
by multiplication with the scaling factor
<span class="math notranslate nohighlight">\(\alpha_j = \frac{1}{\|\mathbf{w}_j\|_{\ell_1}}\)</span>.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1603.05279">Rastegari, Mohammad, et al. XNOR-Net: ImageNet Classification Using
Binary Convolutional Neural Networks.</a></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1) If you would like to share the binary weights with other layers, please
use the standard, floating value weights (<code class="xref any docutils literal notranslate"><span class="pre">weight</span></code>) and not the binary
weights (<code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once before
doing so, otherwise the weights and the binary weights will not be in sync.</p>
<p>3) CPU and GPU implementations now use floating values for <code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>,
since this function is for simulation purposes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</p></li>
<li><p><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight.
[parameter]</p></li>
<li><p><strong>alpha</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Alpha.
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_weight_convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_weight_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize_zero_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_weight_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_weight_convolution" title="Permalink to this definition"></a></dt>
<dd><p>This function provides a Binary Weight Network convolution layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_{n, a, b} = \frac{1}{\|\mathbf{w}_n\|_{\ell_1}} \sum_{m} \sum_{i} \sum_{j} sign(w_{n, m, i, j}) x_{m, a + i, b + j}.\]</div>
<p>i.e., the weights <span class="math notranslate nohighlight">\(w_{n, m, i, j}\)</span> are binarized to
<span class="math notranslate nohighlight">\(sign(w_{n, m, i, j})\)</span> and, hence, each weight is in <span class="math notranslate nohighlight">\(\{-1,\,1\}\)</span>.
By this weight binarization, the inner product computations turn into
additions/subtractions which are followed by multiplication with the scaling
factor <span class="math notranslate nohighlight">\(\alpha_n = \frac{1}{\|\mathbf{w}_n\|_{\ell_1}}\)</span>.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1603.05279">Rastegari, Mohammad, et al. XNOR-Net: ImageNet Classification Using
Binary Convolutional Neural Networks.</a></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1) If you would like to share the binary weights between other standard layers, please
use the standard, floating value weights (<code class="xref any docutils literal notranslate"><span class="pre">weight</span></code>)
and not the binary weights (<code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>).</p>
<p>2) The weights and the binary weights become in sync only after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, and not after a call to
<a class="reference internal" href="variable.html#nnabla.Variable.backward" title="nnabla.Variable.backward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backward()</span></code></a>. If you wish to store the parameters of
the network, remember to call <a class="reference internal" href="variable.html#nnabla.Variable.forward" title="nnabla.Variable.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, once
before doing so, otherwise the weights and the binary weights will not be
in sync.</p>
<p>3) CPU and GPU implementations now use floating values for <code class="xref any docutils literal notranslate"><span class="pre">binary_weight</span></code>,
since this function is for simulation purposes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</p></li>
<li><p><strong>binary_weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Binarized weight.
[parameter]</p></li>
<li><p><strong>alpha</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Alpha.
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>quantize_zero_to</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Input value at zero is quantized to this value.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.fixed_point_quantize">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">fixed_point_quantize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0625</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ste_fine_grained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#fixed_point_quantize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.fixed_point_quantize" title="Permalink to this definition"></a></dt>
<dd><p>Fixed Point Quantize.</p>
<p>This function simulates to uniformly quantize values in fixed-point number representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Indicate the signed number or the unsigned number. Default is true.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Bit width used. Note that <a class="reference internal" href="#nnabla.functions.sign" title="nnabla.functions.sign"><code class="xref any py py-func docutils literal notranslate"><span class="pre">sign</span></code></a> consumes one bit. <span class="math notranslate nohighlight">\(n-1\)</span> is used for number representation in <code class="xref any docutils literal notranslate"><span class="pre">signed</span></code> case.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Step size.</p></li>
<li><p><strong>quantize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, quantize input, otherwise not.</p></li>
<li><p><strong>ste_fine_grained</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, STE is not 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.fixed_point_quantize</span></code>.</p>
</div>
<p>In the forward pass,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
    q_i= \left\{
       \begin{array}{ll}
            max &amp; if \ \ \ x_i &gt; max \\
            sign(x_i) \times floor(|x_i| \delta^{-1} + 2^{-1}) \times \delta &amp; if \ \ min \le x_i \le max \\
            min &amp; if \ \ x_i &lt; min \\
       \end{array} \right.,
\end{equation}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is the step size,
<span class="math notranslate nohighlight">\((min, max) :=(- (2^{n-1} - 1)\delta, (2^{n-1} - 1)\delta)\)</span> if <span class="math notranslate nohighlight">\(sign\)</span> is true,
<span class="math notranslate nohighlight">\((min, max) := (0, (2^n - 1) \delta)\)</span> otherwise, and
<span class="math notranslate nohighlight">\(n\)</span> is the total bit-width used.</p>
<p>In the backward pass when using <code class="xref any docutils literal notranslate"><span class="pre">ste_fine_grained</span></code> as false,</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
    \frac{\partial q_i}{\partial x_i} = 1.
\end{equation}\]</div>
<p>In the backward pass when using <code class="xref any docutils literal notranslate"><span class="pre">ste_fine_grained</span></code> as true,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
    \frac{\partial q_i}{\partial x_i}= \left\{
            \begin{array}{ll}
                        0 &amp; if \ \ \ x_i &gt; max \\
                    1 &amp; if \ \ min \le x_i \le max \\
                    0 &amp; if \ \ x_i &lt; min \\
            \end{array} \right..
\end{equation}\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quantized values are stored as floating point number, since this function is for simulation purposes.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.min_max_quantize">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">min_max_quantize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qr_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qr_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ql_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ql_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ste_fine_grained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#min_max_quantize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.min_max_quantize" title="Permalink to this definition"></a></dt>
<dd><p>Min-max quantization.</p>
<p>This function simulates to uniformly quantize values in fixed-point number representation.</p>
<p>Min-max quantization is defined as the following equation</p>
<div class="math notranslate nohighlight">
\[y = round \left(\frac{\min(\max(x, m), M) - m}{scale} \right) \times scale + m,\]</div>
<p>where the <span class="math notranslate nohighlight">\(scale\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[scale = \frac{M - m}{M_q - m_q},\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}m_q = ql_{min}, \\
M_q = ql_{max}, \\
m = qr_{min}, \\
M = qr_{max}.\end{split}\]</div>
<p>In the backward pass when using <code class="xref any docutils literal notranslate"><span class="pre">ste_fine_grained</span></code> as false,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{\partial q_i}{\partial x_i} = 1.\]</div>
</div></blockquote>
<p>In the backward pass when using <code class="xref any docutils literal notranslate"><span class="pre">ste_fine_grained</span></code> as true,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}  \frac{\partial q_i}{\partial x_i}= \left\{
\begin{array}{ll}
  0 &amp; if \ \ \ x_i &gt; M \\
  1 &amp; if \ \ m \le x_i \le M \\
  0 &amp; if \ \ x_i &lt; m \\
\end{array} \right..\end{split}\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(qr_{min}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}\)</span> are treaded as follows.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">x_min_max</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> and <code class="xref any docutils literal notranslate"><span class="pre">ema</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>:
Exponential moving average are computed for each <span class="math notranslate nohighlight">\(min(x)\)</span> and <span class="math notranslate nohighlight">\(max(x)\)</span>
then stored in <span class="math notranslate nohighlight">\(qr_{min}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}\)</span>.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">x_min_max</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> and <code class="xref any docutils literal notranslate"><span class="pre">ema</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>:
<span class="math notranslate nohighlight">\(min(x)\)</span> and <span class="math notranslate nohighlight">\(max(x)\)</span> are computed then stored in <span class="math notranslate nohighlight">\(qr_{min}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}\)</span>.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">x_min_max</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> and <code class="xref any docutils literal notranslate"><span class="pre">ema</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>:
Exponential moving average stored in <span class="math notranslate nohighlight">\(qr_{min}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}\)</span> are used.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">x_min_max</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a> and <code class="xref any docutils literal notranslate"><span class="pre">ema</span></code> is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>
Gradients of <span class="math notranslate nohighlight">\(qr_{min}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}\)</span> are computed in the backward pass.</p></li>
</ul>
</div></blockquote>
<p>More precisely, in inference of the min-max quantization, one has to consider <em>zero-point (zp)</em>
which corresponds
to the real value 0, and its data type is an integer. <em>zero-point</em> is defined as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}  &amp;&amp; zp_f = ql_{min} -\frac{qr_{min}}{scale}, \\
  &amp;&amp; zp = \left\{
\begin{array}{ll}
  ql_{max} &amp; if \ \ \ zp_f &gt;= ql_{max} \\
  round(zp_f) &amp; if \ \ otherwise \\
  ql_{min}  &amp; if \ \ zp_f &lt;= ql_{min} \\
\end{array} \right..\end{split}\]</div>
</div></blockquote>
<p>Accordingly, in order to simulate quantization effect of <em>zero-point</em>,
during both forward and backward pass, <span class="math notranslate nohighlight">\(qr_{min}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}\)</span> are adjusted as follows,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}qr_{min}^{adj} = ql_{min} - zp * scale, \\
qr_{max}^{adj} = ql_{max} - zp * scale.\end{split}\]</div>
</div></blockquote>
<p>These operations are often called <em>nudge</em>.</p>
<p>Finally, in the formulas of the min-max quantization, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(M\)</span> are replaced by
<span class="math notranslate nohighlight">\(qr_{min}^{adj}\)</span> and <span class="math notranslate nohighlight">\(qr_{max}^{adj}\)</span> respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input N-D array.</p></li>
<li><p><strong>qr_min</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Minimum quantization range (modified during forward execution).</p></li>
<li><p><strong>qr_max</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Maximum quantization range (modified during forward execution).</p></li>
<li><p><strong>ql_min</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Minimum quantization level, typically 0.</p></li>
<li><p><strong>ql_max</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Maximum quantization level, typically 255.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The decay rate for the exponential moving average.</p></li>
<li><p><strong>x_min_max</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use the min and max of x to compute quantization ranges. Default is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>ema</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Use the exponential moving average for the min and max quantization ranges.
Default is <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#False" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>ste_fine_grained</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a>, STE is not 1, the {0, 1}-mask computed from the min-max is
applied to the gradient in the backward; otherwise, STE is 1.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Epsilon, or small value to ensure <span class="math notranslate nohighlight">\(qr_{max} - qr_{min}\)</span> must be greater
than the epsilon.</p></li>
<li><p><strong>quantize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Apply quantization or not.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Benoit Jacob, Skirmantas Kligys, Bo Chen, Menglong Zhu, Matthew Tang, Andrew Howard, Hartwig Adam, and Dmitry Kalenichenko, “Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference”, <a class="reference external" href="https://arxiv.org/abs/1712.05877">https://arxiv.org/abs/1712.05877</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.pow2_quantize">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">pow2_quantize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ste_fine_grained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/functions.html#pow2_quantize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.pow2_quantize" title="Permalink to this definition"></a></dt>
<dd><p>Pow2 Quantize.</p>
<p>This function simulates to uniformly quantize values in fixed-point number representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – An input variable.</p></li>
<li><p><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Indicate the signed number or the unsigned number. Default is true.</p></li>
<li><p><strong>with_zero</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Indicate using zero as a quantized value. Default is true. Note that <a class="reference internal" href="nd_array.html#nnabla.NdArray.zero" title="nnabla.NdArray.zero"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">zero</span></code></a> consumes one bit.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Bit width used. Note that <a class="reference internal" href="#nnabla.functions.sign" title="nnabla.functions.sign"><code class="xref any py py-func docutils literal notranslate"><span class="pre">sign</span></code></a> consumes one bit. <span class="math notranslate nohighlight">\(n-1\)</span> is used for number representation in <code class="xref any docutils literal notranslate"><span class="pre">signed</span></code> case. Default is 8.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – <span class="math notranslate nohighlight">\(2^m\)</span> is the upper bound of the dynamic range and <span class="math notranslate nohighlight">\(-2^m\)</span> is the lower bound, <span class="math notranslate nohighlight">\(m \in \mathcal{Z}\)</span>. Default is 1.</p></li>
<li><p><strong>quantize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, quantize input, otherwise not.</p></li>
<li><p><strong>ste_fine_grained</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, STE is not 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">nnabla.function_bases.pow2_quantize</span></code>.</p>
</div>
<p>In the forward pass of <code class="xref any docutils literal notranslate"><span class="pre">signed</span></code> case,</p>
<div class="math notranslate nohighlight">
\[\begin{split}q_i= \left\{
    \begin{array}{ll}
                 max_{+} &amp; if \ \ \overline{q_i} &gt; max_{+} \\
                 \overline{q_i} &amp; if \ \ min_{+} \le \overline{q_i} \le max_{+} \\
           min_{+} &amp; if \ \ 0 \le \overline{q_i} &lt; min_{+} \\
           min_{-} &amp; if \ \ min_{-} &lt; \overline{q_i} &lt; 0 \\
           \overline{q_i} &amp; if \ \ max_{-} \le \overline{q_i} \le min_{-}\\
         max_{-} &amp; if \ \ \overline{q_i} &lt; max_{-} \\
    \end{array} \right.,\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;&amp; max_{+} = 2^{m}, min_{+} = 2^{m - (2^{n-1} - 1)},\\
&amp;&amp; max_{-} = -2^{m}, min_{-} = -2^{m - (2^{n-1} - 1)},\\
&amp;&amp; \overline{q_i} = sign(x_i) \times 2^{round(\log_2 |x_i|)}.\end{split}\]</div>
<p>This quantization uses the geometric mean between two power-of-two numbers
as quantization threshold.</p>
<p>In the forward pass of <code class="xref any docutils literal notranslate"><span class="pre">unsigned</span></code> case,</p>
<div class="math notranslate nohighlight">
\[\begin{split}q_i= \left\{
    \begin{array}{ll}
                 max &amp; if \ \ \overline{q_i} &gt; max \\
                 \overline{q_i} &amp; if \ \ min \le \overline{q_i} \le max \\
           min &amp; if \ \ 0 &lt; \overline{q_i} &lt; min \\
    \end{array} \right.,\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;&amp; max = 2^{m}, min = 2^{m - (2^{n} - 1)},\\
&amp;&amp; \overline{q_i} = 2^{int(\log_2 |x_i|)}.\end{split}\]</div>
<p>When using <code class="xref any docutils literal notranslate"><span class="pre">with_zero</span></code> as true, a pruning threshold is used to round an input to
0 or <span class="math notranslate nohighlight">\(min\)</span>. The pruning threshold is defined in this function as the following,</p>
<div class="math notranslate nohighlight">
\[pruning\ threshold = min \times 2^{-\frac{1}{2}}.\]</div>
<p>If an absolute value of the input is lesser than this value, the input is rounded to 0, otherwise <span class="math notranslate nohighlight">\(min\)</span>.</p>
<p>In the backward pass when using ste_fine_grained as false,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial q_i}{\partial x_i} = 1.\]</div>
<p>In the backward pass when using ste_fine_grained as true,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial q_i}{\partial x_i}= \left\{
   \begin{array}{ll}
            0 &amp; if \ \ \overline{q_i} &gt; max_{+} \\
                1 &amp; if \ \ otherwise \\
        0 &amp; if \ \ \overline{q_i} &lt; max_{-} \\
   \end{array} \right..\end{split}\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.prune">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#prune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.prune" title="Permalink to this definition"></a></dt>
<dd><p>Prune the input as the following equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}q_i = \left \{
  \begin{array}{ll}
  0   &amp; abs(x_i) &lt; threshold \\
  x_i &amp; otherwise
  \end{array}
  \right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(threshold\)</span> is determined by <code class="xref any docutils literal notranslate"><span class="pre">threshold</span> <span class="pre">=</span> <span class="pre">np.sort(np.abs(x))[int((x.size</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">rate)]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array</p></li>
<li><p><strong>rate</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Sparse rate, or pruning rate.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.9</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array with the same shape as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.inq_affine">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">inq_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicator_fixedweights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inq_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'largest_abs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#inq_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.inq_affine" title="Permalink to this definition"></a></dt>
<dd><p>This function provides a INQ affine layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_j = \sum_{i} w_{j,i} x_i,\]</div>
<p>where the weights <span class="math notranslate nohighlight">\(w_{j,i}\)</span> are quantized sequentially during
training to power-of-two numbers. In the backward pass, only the non-fixed
(i.e., learnable) weights are updated.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1702.03044">Zhou A, Yao A, Guo Y, Xu L, Chen Y. Incremental network quantization:
Towards lossless CNNs with low-precision weights.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input .</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight .
[parameter]</p></li>
<li><p><strong>indicator_fixedweights</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Indicates which weights are already fixed (0 = not fixed, 1 = fixed) .
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>num_bits</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of bits per weight. Needs to be &gt;= 2 as two bits are used to code <a class="reference internal" href="nd_array.html#nnabla.NdArray.zero" title="nnabla.NdArray.zero"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">zero</span></code></a> and sign of weight.
[default= <code class="xref any docutils literal notranslate"><span class="pre">4</span></code> ]</p></li>
<li><p><strong>inq_iterations</strong> (<em>repeated int64</em>) – List which specifies after how many forward passes we fix 50% of the learnable weights. If we have done as many iterations as specified in the last element of <code class="xref any docutils literal notranslate"><span class="pre">inq_iterations</span></code>, then all weights are fixed.
[default= <code class="xref any docutils literal notranslate"><span class="pre">()</span></code> ]</p></li>
<li><p><strong>selection_algorithm</strong> (<em>string</em>) – Chooses algorithm that we use for selecting the weights to fix (“largest_abs” … fix weights with largest absolute value, “random” … fix weights randomly)
[default= <code class="xref any docutils literal notranslate"><span class="pre">'largest_abs'</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.inq_convolution">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">inq_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicator_fixedweights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inq_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'largest_abs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#inq_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.inq_convolution" title="Permalink to this definition"></a></dt>
<dd><p>This function provides a INQ convolution layer. It computes in
the forward pass</p>
<div class="math notranslate nohighlight">
\[y_{n, a, b} = \sum_{m} \sum_{i} \sum_{j} w_{n, m, i, j} x_{m, a + i, b + j},\]</div>
<p>where the weights <span class="math notranslate nohighlight">\(w_{j,i}\)</span> are quantized sequentially during
training to power-of-two numbers. In the backward pass, only the non-fixed
(i.e., learnable) weights are updated.</p>
<p>Reference</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1702.03044">Zhou A, Yao A, Guo Y, Xu L, Chen Y. Incremental network quantization:
Towards lossless CNNs with low-precision weights.</a></p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Input.</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Weight.
[parameter]</p></li>
<li><p><strong>indicator_fixedweights</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Indicates which weights are already fixed (0 = not fixed, 1 = fixed) .
[parameter]</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Bias.
[optional][parameter]</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Padding sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(0,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Stride sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Dilation sizes for dimensions.
[default= <code class="xref any docutils literal notranslate"><span class="pre">(1,)</span> <span class="pre">*</span> <span class="pre">(len(x.shape)</span> <span class="pre">-</span> <span class="pre">(base_axis+1))</span></code> ]</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of groups of channels. This makes the connection across channels sparser, by grouping connections along the mapping direction.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>num_bits</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Number of bits per weight. Needs to be &gt;= 2 as two bits are used to code <a class="reference internal" href="nd_array.html#nnabla.NdArray.zero" title="nnabla.NdArray.zero"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">zero</span></code></a> and sign of weight.
[default= <code class="xref any docutils literal notranslate"><span class="pre">4</span></code> ]</p></li>
<li><p><strong>inq_iterations</strong> (<em>repeated int64</em>) – List which specifies after how many forward passes we fix 50% of the learnable weights. If we have done as many iterations as specified in the last element of <code class="xref any docutils literal notranslate"><span class="pre">inq_iterations</span></code>, then all weights are fixed.
[default= <code class="xref any docutils literal notranslate"><span class="pre">()</span></code> ]</p></li>
<li><p><strong>selection_algorithm</strong> (<em>string</em>) – Chooses algorithm that we use for selecting the weights to fix (“largest_abs” … fix weights with largest absolute value, “random” … fix weights randomly)
[default= <code class="xref any docutils literal notranslate"><span class="pre">'largest_abs'</span></code> ]</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Random seed. When -1, seed is sampled from global random number generator.
[default= <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-1" title="(in NumPy v1.25)"><code class="xref any docutils literal notranslate"><span class="pre">-1</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="unsupported-special-use">
<h3>Unsupported, Special Use<a class="headerlink" href="#unsupported-special-use" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.vat_noise">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">vat_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#vat_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.vat_noise" title="Permalink to this definition"></a></dt>
<dd><p>Noise for virtual adversarial training.</p>
<p>This layer is a special layer for GUI network designing, specialized for getting
the noise of virtual adversarial training.</p>
<p>In the backward process, the weight parameter will be replaced with the gradient.</p>
<p>Forward</p>
<div class="math notranslate nohighlight">
\[y_i = \frac{\epsilon x_i}{\sqrt{\sum_k x_k^2 + c}}\]</div>
<p>Backward</p>
<div class="math notranslate nohighlight">
\[\delta x_i = 0\]</div>
<div class="math notranslate nohighlight">
\[w_i = \epsilon \delta y_i\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This layer is a special layer for GUI network designing.</p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1507.00677">Miyato et.al, Distributional Smoothing with Virtual Adversarial Training.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of noise input. Noise is standard Gaussian noise initially, but the next step, fed back gradient variable.</p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array for keep gradient values.</p></li>
<li><p><strong>base_axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Dimensions up to base_axis is treated as sample dimension.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Noise norm (l2) factor.
[default= <code class="xref any docutils literal notranslate"><span class="pre">1.0</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.unlink">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">unlink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#unlink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.unlink" title="Permalink to this definition"></a></dt>
<dd><p>This function behaves as an identity function on the forward pass,
and deletes the gradient for the background pass.</p>
<p>This layer is a special layer for GUI network designing, used for getting
zero backward operation by adding this layer.</p>
<p>Forward</p>
<div class="math notranslate nohighlight">
\[y_i = x_i\]</div>
<p>Backward</p>
<div class="math notranslate nohighlight">
\[\delta x_i = 0\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This layer is a special layer for GUI network designing.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.sink">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">sink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#sink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.sink" title="Permalink to this definition"></a></dt>
<dd><p>Creates a dummy variable used to call forward or backward function
of multiple variables at one place.</p>
<p>This takes any numbers of input variables with any shape,
and creates a single 0-shape outputs.
The forward pass does nothing. The backward pass set ones
to the input grads if one_input_grad is set as true.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">sink</span></code> can only be called at the very end of the graph, and
<code class="docutils literal notranslate"><span class="pre">grad</span></code> of input variables are cleared</p>
<blockquote>
<div><p>when <code class="docutils literal notranslate"><span class="pre">y.backward(clear_buffer=True)</span></code> is called.</p>
</div></blockquote>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Any number of inputs with any shape.
[variadic]</p></li>
<li><p><strong>one_input_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Set grads of inputs as one during backward. It is useful to set false if you want to set external gradients to the input variables.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dummy variable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.confusion_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Confusion matrix.
The return value is already summed over samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Probabilities N-D array. (<span class="math notranslate nohighlight">\(D_1 \times ... \times D_i \times ... \times D_N\)</span>)</p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Labels N-D array. (<span class="math notranslate nohighlight">\(D_1 \times ... \times 1 \times ... \times D_N\)</span>)</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis on which the confusion matrix is calculated.
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x.shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Confusion matrix 2-D array. Col index is estimated class. Row index is label class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="image-object-detection">
<h3>Image Object Detection<a class="headerlink" href="#image-object-detection" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.nms_detection2d">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">nms_detection2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nms_per_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#nms_detection2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.nms_detection2d" title="Permalink to this definition"></a></dt>
<dd><p>Non-Maximum Suppression (NMS) to 2D Object detector output.
The input is a 3-dimensional tensor with shape of <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">N,</span> <span class="pre">5</span> <span class="pre">+</span> <span class="pre">C)</span></code>
where <code class="docutils literal notranslate"><span class="pre">B</span></code> denotes batch size, <code class="docutils literal notranslate"><span class="pre">N</span></code> denotes the number of detection box
candidates, and <code class="docutils literal notranslate"><span class="pre">C</span></code> denotes the number of classes of object detection.
<code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">+</span> <span class="pre">C</span></code> consists of the box coordinates <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">w,</span> <span class="pre">h</span></code> in normalized
coordinates (size of each x and y are 1.0), objectness
(learned to predict IoU value to ground truth box), and the class probabilities of <code class="docutils literal notranslate"><span class="pre">C</span></code> classes.
It outputs a tensor with the same dimensions as the input, where all
values are copied from the input to the output, except the class
probabilities are multiplied by objectness, and possibly suppressed to 0
by NMS.
During NMS, all of combination of pairs of bounding boxes is compared.
For each pair, the bounding box with a lower detection score
(described below) is suppressed if the overlap ratio (the IoU)
is greater than the value of <code class="docutils literal notranslate"><span class="pre">nms</span></code>.</p>
<p>There are two suppression modes for NMS.</p>
<p>1. Suppress by class probability (<code class="docutils literal notranslate"><span class="pre">nms_per_class</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>):
For each bounding box, the detection score is calculated by
<code class="docutils literal notranslate"><span class="pre">objectness</span> <span class="pre">*</span> <span class="pre">probability[class_id]</span></code> for each class.
The suppression is done for each class independently.</p>
<p>2. Suppress by objectness (<code class="docutils literal notranslate"><span class="pre">nms_per_class</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>):
The suppression is done for each bounding box using <code class="docutils literal notranslate"><span class="pre">objectness</span></code>
as a detection score. All class probabilities becomes 0 for
every suppressed boxes.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1612.08242">Joseph Redmon, Ali Farhadi, YOLO9000: Better, Faster, Stronger.</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – A 3-dimensional array.</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Detection score threshold.
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.5</span></code> ]</p></li>
<li><p><strong>nms</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – IoU threshold for Non-maximum suppression (NMS).
[default= <code class="xref any docutils literal notranslate"><span class="pre">0.45</span></code> ]</p></li>
<li><p><strong>nms_per_class</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, NMS is applied for each class.
[default= <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 3-dim array with the same dimensions with the input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
<section id="validation">
<h3>Validation<a class="headerlink" href="#validation" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.top_n_error">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">top_n_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#top_n_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.top_n_error" title="Permalink to this definition"></a></dt>
<dd><p>Top N error along the dimension specified by the axis, the element of outputs is</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i = \left \{
\begin{array}{l}
1 \ (x_i \ is \ not \ within \ N-th \ place) \\
0 \ (x_i \ is \ within \ N-th \ place)
\end{array}
\right.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Probabilities N-D array. <span class="math notranslate nohighlight">\(D_1 \times ... \times D_i \times ... \times D_N\)</span></p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – N-D array of labels. <span class="math notranslate nohighlight">\(D_1 \times ... \times 1 \times ... \times D_N\)</span></p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Axis on which the top N error is calculated.
[default= <code class="xref any docutils literal notranslate"><span class="pre">len(x.shape)</span> <span class="pre">-</span> <span class="pre">1</span></code> ]</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – top N
[default= <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> ]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise error N-D array. (<span class="math notranslate nohighlight">\(D_1 \times ... \times 1 \times ... \times D_N\)</span>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnabla.functions.binary_error">
<span class="sig-prename descclassname"><span class="pre">nnabla.functions.</span></span><span class="sig-name descname"><span class="pre">binary_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nnabla/function_bases.html#binary_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnabla.functions.binary_error" title="Permalink to this definition"></a></dt>
<dd><p>Elementwise binary error.</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_i = \left \{
\begin{array}{l}
0 ((x^{(0)} \geq 0.5) = (x^{(1)} \geq 0.5)) \\
1 ((x^{(0)} \geq 0.5) \neq (x^{(1)} \geq 0.5))
\end{array}
\right.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Probabilities N-D array. <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>.</p></li>
<li><p><strong>target</strong> (<a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a>) – Labels N-D array. Usually set as 0 or 1, but, it allows probability (0 to 1) as inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise errors N-D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="variable.html#nnabla.Variable" title="nnabla.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nnabla functions in <a class="reference internal" href="#module-nnabla.functions" title="nnabla.functions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.functions</span></code></a> are decorated with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function_bases.function_api</span></code> decorator,
which queries the current context and passes it into the first argument of the
original function. The original function always takes a context as the first argument.</p>
</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="computation_graph.html" class="btn btn-neutral float-left" title="Computation Graph" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parametric_function.html" class="btn btn-neutral float-right" title="Parametric Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Sony Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>