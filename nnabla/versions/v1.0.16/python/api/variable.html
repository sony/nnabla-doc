

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Variable &mdash; Neural Network Libraries 1.0.16 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Functions" href="function.html" />
    <link rel="prev" title="NdArray" href="nd_array.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Neural Network Libraries
          

          
          </a>

          
            
            
              <div class="version">
                1.0.16
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../python.html">Python Package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Python Package Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html">Python API Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command_line_interface.html">Python Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Python API Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">Python API Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="common.html">Common</a></li>
<li class="toctree-l3"><a class="reference internal" href="nd_array.html">NdArray</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="function.html">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="parametric_function.html">Parametric Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="solver.html">Solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="communicator.html">Communicator API</a></li>
<li class="toctree-l3"><a class="reference internal" href="monitor.html">Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="ext.html">Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html">Pretrained Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="experimental.html">Experimental</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_exchange_file_format.html">Data exchange file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_format_converter/file_format_converter.html">File format converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Neural Network Libraries</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../python.html">Python Package</a> &raquo;</li>
        
          <li><a href="../api.html">Python API Reference</a> &raquo;</li>
        
      <li>Variable</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/python/api/variable.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="variable">
<span id="id1"></span><h1>Variable<a class="headerlink" href="#variable" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-nnabla.variable"></span><dl class="class">
<dt id="nnabla.Variable">
<em class="property">class </em><code class="descclassname">nnabla.</code><code class="descname">Variable</code><a class="headerlink" href="#nnabla.Variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p><a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a> is used to construct computation graphs (neural networks) together
with functions in <a class="reference internal" href="function.html#functions"><span class="std std-ref">Functions</span></a>
and <a class="reference internal" href="parametric_function.html#id1"><span class="std std-ref">List of Parametric Functions</span></a> .
It also provides a method to execute forward and backward
propagation of the network.
The <a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a> class holds:</p>
<ul class="simple">
<li>Reference to the parent function in a
computation graph. This provides traceability of all connections in the computation graph.</li>
<li>Both data and error
signal (gradient) containers as <a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">nnabla._nd_array.NdArray</span></code></a> s.</li>
<li>Some additional information of the computation graph.</li>
</ul>
<p><a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a> overrides some arithmetic operators
(<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>, <code class="docutils literal notranslate"><span class="pre">**</span></code>). Operands can be either a scalar number,
<code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code> or <a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a>.
If <code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code> is given as either of left or right operand,
the arithmetic operation returns an <code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code> which stores the
output of the computation immediately invoked. Otherwise, it returns
<a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a> holds the graph connection. The computation
is invoked immediately when <a href="#id2"><span class="problematic" id="id3">:function:`nnabla.auto_forward`</span></a>
or <a href="#id4"><span class="problematic" id="id5">:function:`nnabla.set_auto_forward(True)`</span></a> is used.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="http://nnabla.readthedocs.io/en/latest/python/tutorial/python_api.html">Python API Tutorial</a>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> (<em>Iterable of int</em>) – Shape of variable.</li>
<li><strong>need_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag for backprop or not.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nnabla.Variable.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>self</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for setting property, then return self.</p>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.backward">
<code class="descname">backward</code><span class="sig-paren">(</span><em>self</em>, <em>grad=1</em>, <em>bool clear_buffer=False</em>, <em>communicator_callbacks=None</em>, <em>function_pre_hook=None</em>, <em>function_post_hook=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a backward propagation starting from this variable until
the root variable(s) is/are reached in the function graph.
The propagation will stop at a variable with need_grad=False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grad</strong> (scalar, <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, or <a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla._nd_array.NdArray</span></code></a>) – The gradient signal value(s) of this variable.
The default value 1 is used in an usual neural network
training. This option is useful if you have a gradient
computation module outside NNabla, and want to use it as a
gradient signal of the neural network built in NNabla.
Note that this doesn’t modifies the grad values of this
variable.</li>
<li><strong>clear_buffer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Clears the no longer referenced variables
during backpropagation to save memory.</li>
<li><strong>communicator_callbacks</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.CommunicatorBackwardCallback</span></code> or list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.CommunicatorBackwardCallback</span></code>) – The callback functions invoked when 1) backward computation
of each function is finished and 2) all backward
computation is finished.</li>
<li><strong>function_pre_hook</strong> (<em>callable</em>) – This callable object is called immediately before each function is executed.
It must take <a class="reference internal" href="function.html#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Function</span></code></a> as an input.
The default is None.</li>
<li><strong>function_post_hook</strong> (<em>callable</em>) – This callable object is called immediately after each function is executed.
It must take <a class="reference internal" href="function.html#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Function</span></code></a> as an input.
The default is None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.clear_all_graph_links">
<code class="descname">clear_all_graph_links</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.clear_all_graph_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all intermediate functions and variables.</p>
<p>This method clear all intermediate functions and variables up to this variable
in forward pass and is useful for the truncated backpropagation through time
(truncated BPTT) in dynamic graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.d">
<code class="descname">d</code><a class="headerlink" href="#nnabla.Variable.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the values held by this variable, as a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.
Note that the values are referenced (not copied). Therefore, the
modification of the returned ndarray will affect the data of the
NNabla array.
This method can be called as a setter to set the value held by this variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) (optional) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.data">
<code class="descname">data</code><a class="headerlink" href="#nnabla.Variable.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data held by this variable, as a
<a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code></a>. This can also be used as a setter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ndarray</strong> (<a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><em>NdArray</em></a>) – NdArray object. Size must
be the same as this Variable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>self</em>, <em>bool clear_buffer=False</em>, <em>bool clear_no_need_grad=False</em>, <em>function_pre_hook=None</em>, <em>function_post_hook=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a forward propagation from the root node to this variable.
The forward propagation is performed on a subset of variables
determined by the dependency of this variable.
The subset is recursively constructed by tracking variables that the
variables in the subset depend on, starting from this variable,
until it reaches the root variable(s) in the function graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>clear_buffer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Clear the no longer referenced variables
during forward propagation to save memory.
This is usually set as True in an inference
or a validation phase. Default is False.</li>
<li><strong>clear_no_need_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Clear the unreferenced variables with
need_grad=False during forward propagation.
True is usually used when calling this during training.
This is ignored when clear_buffer=True.</li>
<li><strong>function_pre_hook</strong> (<em>callable</em>) – This callable object is called immediately before each function is executed.
It must take <a class="reference internal" href="function.html#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Function</span></code></a> as an input.
The default is None.</li>
<li><strong>function_post_hook</strong> (<em>callable</em>) – This callable object is called immediately after each function is executed.
It must take <a class="reference internal" href="function.html#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Function</span></code></a> as an input.
The default is None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="nnabla.Variable.from_numpy_array">
<em class="property">static </em><code class="descname">from_numpy_array</code><span class="sig-paren">(</span><em>data</em>, <em>grad=None</em>, <em>need_grad=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.from_numpy_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Variable object from Numpy array(s).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> is initialized with the given Numpy array, as well as
<code class="docutils literal notranslate"><span class="pre">grad</span></code> if given.</p>
<p>The shape is also determined by the given array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>ndarray</em></a>) – Values copied to the <code class="docutils literal notranslate"><span class="pre">data</span></code> of the created
Variable.</li>
<li><strong>grad</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>ndarray</em></a>) – Values copied to the <code class="docutils literal notranslate"><span class="pre">grad</span></code> of the created
Variable.</li>
<li><strong>need_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag for backprop or not.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: ~nnabla.Variable</p>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.function_references">
<code class="descname">function_references</code><a class="headerlink" href="#nnabla.Variable.function_references" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of functions which take this variable as an input.
This method can be called only as a getter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of <cite>nnabla.function.Function</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.g">
<code class="descname">g</code><a class="headerlink" href="#nnabla.Variable.g" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the gradient values held by this variable, as a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.
Note that the values are referenced (not copied). Therefore, the
modification of the returned ndarray will affect the data of the
NNabla array.
This method can be called as a setter to set the gradient held by this variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.get_unlinked_variable">
<code class="descname">get_unlinked_variable</code><span class="sig-paren">(</span><em>self</em>, <em>need_grad=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.get_unlinked_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets an unlinked (forgetting parent) variable that shares a Variable buffer
instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>need_grad</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – By default, the unlinked variable will have the same need_grad
flag with this variable instance. By specifying a boolean value,
the new need_grad flags will be set to the unlinked variable.
It is recommended to explicitly specify this option to avoid an
unintended behavior.</td>
</tr>
</tbody>
</table>
<p>Returns: nnabla._variable.Variable</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.parametric_functions</span> <span class="kn">as</span> <span class="nn">PF</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="c1"># Create a new variable of which graph connection is unlinked.</span>
<span class="c1"># Recommend to specify need_grad option explicitly .</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">get_unlinked_variable</span><span class="p">(</span><span class="n">need_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span class="c1"># Affine</span>
<span class="k">print</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># z is unlinked from the parent x but shares the buffers of y.</span>
<span class="c1"># None</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.grad">
<code class="descname">grad</code><a class="headerlink" href="#nnabla.Variable.grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the gradient held by this variable, as a
<a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code></a>. This can also be used as a setter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ndarray</strong> (<a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><em>NdArray</em></a>) – NdArray object. Size must
be the same as this Variable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="nd_array.html#nnabla._nd_array.NdArray" title="nnabla._nd_array.NdArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NdArray</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.info">
<code class="descname">info</code><a class="headerlink" href="#nnabla.Variable.info" title="Permalink to this definition">¶</a></dt>
<dd><p>object</p>
<p>Information of the variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">info</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#nnabla.Variable.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the number of dimensions of this variable.</p>
<p>Returns: int</p>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.need_grad">
<code class="descname">need_grad</code><a class="headerlink" href="#nnabla.Variable.need_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets or sets a boolean indicating whether backpropagation is performed at this variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether backpropagation is performed at this variable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Whether this variable requires gradient or not.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.parent">
<code class="descname">parent</code><a class="headerlink" href="#nnabla.Variable.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the parent function of this variable.
This method can also be called as a setter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> (<a class="reference internal" href="function.html#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function.Function</span></code></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="function.html#nnabla.function.Function" title="nnabla.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.function.Function</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.persistent">
<code class="descname">persistent</code><a class="headerlink" href="#nnabla.Variable.persistent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the persistent flag of this variable. If True, the variable
is not cleared even if clear options in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">nnabla._variable.Variable.forward()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">nnabla._variable.Variable.backward()</span></code> are enabled.
This is useful when you debug the variable values, or log them.
This method can also be called as a setter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – </td>
</tr>
</tbody>
</table>
<p>Returns: bool</p>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.reset_shape">
<code class="descname">reset_shape</code><span class="sig-paren">(</span><em>self</em>, <em>shape</em>, <em>force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.reset_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes the shape of the variable to a specified shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> (<em>Iterable of int</em>) – Target shape.</li>
<li><strong>force</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Flag to force reshape.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method destructively changes the shape of the target variable. For safety, <a class="reference internal" href="function.html#nnabla.functions.reshape" title="nnabla.functions.reshape"><code class="xref py py-func docutils literal notranslate"><span class="pre">reshape()</span></code></a> should be used instead.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.reshape">
<code class="descname">reshape</code><span class="sig-paren">(</span><em>self</em>, <em>shape</em>, <em>unlink=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new variable, where this variable is reshaped to a specified shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shape</strong> (<em>Iterable of int</em>) – Target shape.</li>
<li><strong>unlink</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Unlink graph connection. Or, keep graph connection, i.e.
the gradient will be backprop-ed to the original variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.rewire_on">
<code class="descname">rewire_on</code><span class="sig-paren">(</span><em>self</em>, <em>var</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.rewire_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Rewire a successor graph of this variable on top of <code class="docutils literal notranslate"><span class="pre">var</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>var</strong> (<a class="reference internal" href="#nnabla.Variable" title="nnabla.Variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla.Variable</span></code></a>) – The array elements and the parent function of <code class="docutils literal notranslate"><span class="pre">var</span></code> is
copied to <code class="docutils literal notranslate"><span class="pre">`self</span></code> as references.
Note that the parent function of <code class="docutils literal notranslate"><span class="pre">var</span></code> is removed.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># A. Create a graph A.</span>
<span class="n">xa</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">need_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ya</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>

<span class="c1"># B. Create a graph B.</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">need_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">yb</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span>
    <span class="n">F</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;b1&#39;</span><span class="p">)),</span>
    <span class="mi">8</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;b2&#39;</span><span class="p">))</span>

<span class="c1"># C. Rewire the graph A on top of B such that</span>
<span class="c1">#    `xb-&gt;B-&gt;(yb-&gt;)xa-&gt;A-&gt;ya`. Note `yb` is gone.</span>
<span class="n">xa</span><span class="o">.</span><span class="n">rewire_on</span><span class="p">(</span><span class="n">yb</span><span class="p">)</span>

<span class="c1"># D. Execute the rewired graph.</span>
<span class="n">xb</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ya</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="n">ya</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.shape">
<code class="descname">shape</code><a class="headerlink" href="#nnabla.Variable.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the shape of the variable.</p>
<p>Returns: tuple of <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="nnabla.Variable.size">
<code class="descname">size</code><a class="headerlink" href="#nnabla.Variable.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the size of the variable.</p>
<p>Returns: <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.size_from_axis">
<code class="descname">size_from_axis</code><span class="sig-paren">(</span><em>self</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.size_from_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the size followed by the provided axis.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">nnabla</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">size_from_axis</span><span class="p">()</span>
<span class="c1"># ==&gt; 90</span>
<span class="n">a</span><span class="o">.</span><span class="n">size_from_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># ==&gt; 90</span>
<span class="n">a</span><span class="o">.</span><span class="n">size_from_axis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># ==&gt; 9</span>
<span class="n">a</span><span class="o">.</span><span class="n">size_from_axis</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># ==&gt; 1</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – -1 as default</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.unlinked">
<code class="descname">unlinked</code><span class="sig-paren">(</span><em>self</em>, <em>need_grad=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.unlinked" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is <cite>deprecated</cite>, use get_unlinked_variable instead.</p>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.visit">
<code class="descname">visit</code><span class="sig-paren">(</span><em>self</em>, <em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.visit" title="Permalink to this definition">¶</a></dt>
<dd><p>Visit functions recursively in forward order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> (<em>function</em>) – Function object which takes
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla._function.Function</span></code> object as an argument.</td>
</tr>
</tbody>
</table>
<p>Returns: None</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nnabla</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">nnabla.functions</span> <span class="kn">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">nnabla.parametric_functions</span> <span class="kn">as</span> <span class="nn">PF</span>

<span class="c1"># Define a simple network-graph</span>
<span class="k">def</span> <span class="nf">network_graph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">maps</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">maps</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;first-conv&quot;</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">average_pooling</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pred</span>

<span class="c1"># You can modify this PrintFunc to get the other informations like inputs(nnabla_func.inputs), outputs and arguments(nnabla_func.info.args) of nnabla functions.</span>
<span class="k">class</span> <span class="nc">PrintFunc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nnabla_func</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">nnabla_func</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">type_name</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">network_graph</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">PrintFunc</span><span class="p">())</span>
</pre></div>
</div>
<p>Output :</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>Convolution
AveragePooling
Affine
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="nnabla.Variable.visit_check">
<code class="descname">visit_check</code><span class="sig-paren">(</span><em>self</em>, <em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#nnabla.Variable.visit_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Visit functions recursively in forward order.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If any of evaluation of the function object returns True,
the visit propagation will stop immediately,
and will return True.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> (<em>function</em>) – Function object which takes
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nnabla._function.Function</span></code> object as an argument.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: bool</dt>
<dd>Returns True if any of the function object call returns True.</dd>
</dl>
<p class="rubric">Example</p>
<p>Define a simple network-graph where AveragePooling function can be added explicitly as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">network_graph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">add_avg_pool</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">maps</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">maps</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;first-conv&quot;</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">add_avg_pool</span> <span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">average_pooling</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">PF</span><span class="o">.</span><span class="n">affine</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pred</span>

<span class="c1"># Define &#39;PrintFunc()&#39; to check whether &quot;AveragePooling&quot; function exists in the network-graph</span>
<span class="k">class</span> <span class="nc">PrintFunc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nnabla_func</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nnabla_func</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">type_name</span> <span class="o">==</span><span class="s2">&quot;AveragePooling&quot;</span> <span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} exists in the graph&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nnabla_func</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">type_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</pre></div>
</div>
<p>Create a network-graph which has AveragePooling function and call visit_check() method :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">network_graph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">add_avg_pool</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1">#Adding AveragePooling function to the graph</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;The return value of visit_check() method is : {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">visit_check</span><span class="p">(</span><span class="n">PrintFunc</span><span class="p">())))</span>
</pre></div>
</div>
<p>Output :</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>AveragePooling exists in the graph
The return value of visit_check() method is : True
</pre></div>
</div>
<p>Create a network-graph which doesn’t have AveragePooling function and call visit_check() method :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nn</span><span class="o">.</span><span class="n">clear_parameters</span><span class="p">()</span>                         <span class="c1"># call this in case you want to run the following code agian</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">network_graph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">add_avg_pool</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># Exclusion of AveragePooling function in the graph</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;The return value of visit_check() method is : {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">visit_check</span><span class="p">(</span><span class="n">PrintFunc</span><span class="p">())))</span>
</pre></div>
</div>
<p>Output :</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>The return value of visit_check() method is : False
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="function.html" class="btn btn-neutral float-right" title="Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="nd_array.html" class="btn btn-neutral float-left" title="NdArray" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Sony Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>