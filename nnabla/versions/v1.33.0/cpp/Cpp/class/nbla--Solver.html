<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>class nbla::Solver &mdash; Neural Network Libraries 1.33.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="class nbla::Sort" href="nbla--Sort.html" />
    <link rel="prev" title="class SoftSign" href="SoftSign.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Neural Network Libraries
          </a>
              <div class="version">
                1.33.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../python.html">Python Package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../cpp.html">C++ API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation.html">Build C++ libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../command_line_interface.html">C++ Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html">C++ API Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../doc.html">C++ API Document</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../cpp_api.html">NNABLA C++ API Document</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../class.html">NNABLA Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../struct.html">NNABLA Struct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../namespace.html">NNABLA Namespace</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_exchange_file_format.html">Data exchange file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/file_format_converter/file_format_converter.html">File format converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support_status.html">Support Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Neural Network Libraries</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../cpp.html">C++ API</a></li>
          <li class="breadcrumb-item"><a href="../../doc.html">C++ API Document</a></li>
          <li class="breadcrumb-item"><a href="../../cpp_api.html">NNABLA C++ API Document</a></li>
          <li class="breadcrumb-item"><a href="../class.html">NNABLA Class</a></li>
      <li class="breadcrumb-item active">class nbla::Solver</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/cpp/Cpp/class/nbla--Solver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="class-nbla-solver">
<h1>class nbla::Solver<a class="headerlink" href="#class-nbla-solver" title="Permalink to this headline"></a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6SolverE">
<span id="_CPPv3N4nbla6SolverE"></span><span id="_CPPv2N4nbla6SolverE"></span><span id="nbla::Solver"></span><span class="target" id="classnbla_1_1Solver"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Solver</span></span></span><a class="headerlink" href="#_CPPv4N4nbla6SolverE" title="Permalink to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Solver"><span class="std std-ref">Solver</span></a> interface which is extended to implement a new <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Solver"><span class="std std-ref">Solver</span></a> class. </p>
<p><a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Solver"><span class="std std-ref">Solver</span></a> takes care of update rule given gradients of parameters.</p>
<p><div class="math notranslate nohighlight">
\[ w_{t+1} \leftarrow w_t - g_t(\Delta w_t) \]</div>
</p>
<p>The function <span class="math notranslate nohighlight">\(g_t(\cdot)\)</span> can have an internal state that is updated when it is called (e.g. <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Adam"><span class="std std-ref">Adam</span></a>). </p>
<p>Subclassed by <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1AdaBelief"><span class="std std-ref">nbla::AdaBelief&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1AdaBound"><span class="std std-ref">nbla::AdaBound&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Adadelta"><span class="std std-ref">nbla::Adadelta&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Adagrad"><span class="std std-ref">nbla::Adagrad&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Adam"><span class="std std-ref">nbla::Adam&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Adamax"><span class="std std-ref">nbla::Adamax&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1AdamW"><span class="std std-ref">nbla::AdamW&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1AMSBound"><span class="std std-ref">nbla::AMSBound&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1AMSGRAD"><span class="std std-ref">nbla::AMSGRAD&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Lamb"><span class="std std-ref">nbla::Lamb&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Lars"><span class="std std-ref">nbla::Lars&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Momentum"><span class="std std-ref">nbla::Momentum&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Nesterov"><span class="std std-ref">nbla::Nesterov&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1RMSprop"><span class="std std-ref">nbla::RMSprop&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1RMSpropGraves"><span class="std std-ref">nbla::RMSpropGraves&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Sgd"><span class="std std-ref">nbla::Sgd&lt; T &gt;</span></a>, <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1SgdW"><span class="std std-ref">nbla::SgdW&lt; T &gt;</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6SolverD0Ev">
<span id="_CPPv3N4nbla6SolverD0Ev"></span><span id="_CPPv2N4nbla6SolverD0Ev"></span><span id="nbla::Solver::~Solver"></span><span class="target" id="classnbla_1_1Solver_1a21676af28ad8fd05e8d10b7b248a0289"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~Solver</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4nbla6SolverD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Name of <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Solver"><span class="std std-ref">Solver</span></a> class, usually class name. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver13learning_rateEv">
<span id="_CPPv3N4nbla6Solver13learning_rateEv"></span><span id="_CPPv2N4nbla6Solver13learning_rateEv"></span><span id="nbla::Solver::learning_rate"></span><span class="target" id="classnbla_1_1Solver_1a3ce6df32cced883987398f680d8ee173"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">learning_rate</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4nbla6Solver13learning_rateEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set learning rate. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4nbla6Solver21weight_decay_is_fusedEv">
<span id="_CPPv3NK4nbla6Solver21weight_decay_is_fusedEv"></span><span id="_CPPv2NK4nbla6Solver21weight_decay_is_fusedEv"></span><span id="nbla::Solver::weight_decay_is_fusedC"></span><span class="target" id="classnbla_1_1Solver_1ae069dd975a6f39eae308a248c7cb3dd4"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">weight_decay_is_fused</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4nbla6Solver21weight_decay_is_fusedEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Whether the weight decay is lazily evaluated at update_impl. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver9zero_gradEv">
<span id="_CPPv3N4nbla6Solver9zero_gradEv"></span><span id="_CPPv2N4nbla6Solver9zero_gradEv"></span><span id="nbla::Solver::zero_grad"></span><span class="target" id="classnbla_1_1Solver_1a43dbb9bca041d933229757582bd11615"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">zero_grad</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver9zero_gradEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Zeroing grads for all params_. </p>
<p>This is usually called before running a sequence of <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Function_1a2062f16de445fc0d1d5fe4ded349933a"><span class="std std-ref">Function::backward()</span></a> for propagating whole computation graph. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver14set_parametersERK6vectorI4pairI6string11VariablePtrEEbb">
<span id="_CPPv3N4nbla6Solver14set_parametersERK6vectorI4pairI6string11VariablePtrEEbb"></span><span id="_CPPv2N4nbla6Solver14set_parametersERK6vectorI4pairI6string11VariablePtrEEbb"></span><span id="nbla::Solver::set_parameters__vector:pair:string.VariablePtr::CR.b.b"></span><span class="target" id="classnbla_1_1Solver_1a8925d571088cf017682800fdafece787"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_parameters</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla11VariablePtrE" title="nbla::VariablePtr"><span class="n"><span class="pre">VariablePtr</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">reset</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">retain_state</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver14set_parametersERK6vectorI4pairI6string11VariablePtrEEbb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Adding parameters to be optimized via solver. </p>
<p>It calls set_impl().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – Shared pointers of <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Variable"><span class="std std-ref">Variable</span></a>s </p></li>
<li><p><strong>reset</strong> – Reset all parameters registered. </p></li>
<li><p><strong>retain_state</strong> – Try to retain state (e.g. momentum) if a parameter is overwritten. Note that this will be ignored if reset=true. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver17remove_parametersERK6vectorI6stringE">
<span id="_CPPv3N4nbla6Solver17remove_parametersERK6vectorI6stringE"></span><span id="_CPPv2N4nbla6Solver17remove_parametersERK6vectorI6stringE"></span><span id="nbla::Solver::remove_parameters__vector:string:CR"></span><span class="target" id="classnbla_1_1Solver_1adc209367f4dbb057f2b159682a3ca21a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">remove_parameters</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">keys</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver17remove_parametersERK6vectorI6stringE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Remove previously registered parameters by keys. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver16clear_parametersEv">
<span id="_CPPv3N4nbla6Solver16clear_parametersEv"></span><span id="_CPPv2N4nbla6Solver16clear_parametersEv"></span><span id="nbla::Solver::clear_parameters"></span><span class="target" id="classnbla_1_1Solver_1a6301c16b6dc0ae0acc971e8cd402061b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clear_parameters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver16clear_parametersEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clear all parameters. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver14get_parametersEv">
<span id="_CPPv3N4nbla6Solver14get_parametersEv"></span><span id="_CPPv2N4nbla6Solver14get_parametersEv"></span><span id="nbla::Solver::get_parameters"></span><span class="target" id="classnbla_1_1Solver_1a66c164ecad8dc4aa549ad1c744d3ca96"></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla11VariablePtrE" title="nbla::VariablePtr"><span class="n"><span class="pre">VariablePtr</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_parameters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver14get_parametersEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get all parameters. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver10get_statesEv">
<span id="_CPPv3N4nbla6Solver10get_statesEv"></span><span id="_CPPv2N4nbla6Solver10get_statesEv"></span><span id="nbla::Solver::get_states"></span><span class="target" id="classnbla_1_1Solver_1a1e427918ee9b1c555d929dc4194126c7"></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4nbla6Solver11SolverStateE" title="nbla::Solver::SolverState"><span class="n"><span class="pre">SolverState</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_states</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver10get_statesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get all states. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver10set_statesERK6vectorI4pairI6string11SolverStateEE">
<span id="_CPPv3N4nbla6Solver10set_statesERK6vectorI4pairI6string11SolverStateEE"></span><span id="_CPPv2N4nbla6Solver10set_statesERK6vectorI4pairI6string11SolverStateEE"></span><span id="nbla::Solver::set_states__vector:pair:string.SolverState::CR"></span><span class="target" id="classnbla_1_1Solver_1a5dc368bf54d048e2be8d00b8ebf4f527"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_states</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4nbla6Solver11SolverStateE" title="nbla::Solver::SolverState"><span class="n"><span class="pre">SolverState</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver10set_statesERK6vectorI4pairI6string11SolverStateEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set states. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver11clear_stateERK6string">
<span id="_CPPv3N4nbla6Solver11clear_stateERK6string"></span><span id="_CPPv2N4nbla6Solver11clear_stateERK6string"></span><span id="nbla::Solver::clear_state__stringCR"></span><span class="target" id="classnbla_1_1Solver_1a61f48a5ec0e58b756eaf4dab936b9f0a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clear_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">key</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver11clear_stateERK6string" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clear states. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver6updateE16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver6updateE16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver6updateE16update_hook_type16update_hook_type"></span><span id="nbla::Solver::update__update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1a176a54840b48c08236ce0a2d8ec4572e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver6updateE16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Update all params using stored grads in params_ by backpropagation. </p>
<p>This internally calls update_impl() which must be implemented in a derived class. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver12weight_decayEf16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver12weight_decayEf16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver12weight_decayEf16update_hook_type16update_hook_type"></span><span id="nbla::Solver::weight_decay__float.update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1a5a7665f7e8d4374af18fd2c21c36271a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">weight_decay</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">decay_rate</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver12weight_decayEf16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply weight decay to raw gradient. </p>
<p>It must be called before running <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Solver_1a176a54840b48c08236ce0a2d8ec4572e"><span class="std std-ref">update()</span></a> if necessary. This internally calls weight_decay_impl() which must be implemented in a derived class.</p>
<p>It is equivalent to add a squared sum of weight vectors to original loss function.</p>
<p><div class="math notranslate nohighlight">
\[ L_{\rm R}({\mathbf w}) = L_{\rm orig}({\mathbf w}) + {\rm decay\_rate } \times ||{\mathbf w}||_2^2 \]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decay_rate</strong> – Coefficient of weight decay. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver17clip_grad_by_normEf16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver17clip_grad_by_normEf16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver17clip_grad_by_normEf16update_hook_type16update_hook_type"></span><span id="nbla::Solver::clip_grad_by_norm__float.update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1ad95cee79e3ce733db0bea9a6151775a2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clip_grad_by_norm</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">norm</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver17clip_grad_by_normEf16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clip gradients by norm. </p>
<p>The norm is calculated at each variable. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver14check_inf_gradE16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver14check_inf_gradE16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver14check_inf_gradE16update_hook_type16update_hook_type"></span><span id="nbla::Solver::check_inf_grad__update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1a7405dc2456aa389568c41b019ceccff1"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_inf_grad</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver14check_inf_gradE16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if there is any inf on the gradients which were setup. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver14check_nan_gradE16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver14check_nan_gradE16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver14check_nan_gradE16update_hook_type16update_hook_type"></span><span id="nbla::Solver::check_nan_grad__update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1a373958ae2a0d07c82e4daf1ce10861a8"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_nan_grad</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver14check_nan_gradE16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if there is any nan on the gradients which were setup. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver21check_inf_or_nan_gradE16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver21check_inf_or_nan_gradE16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver21check_inf_or_nan_gradE16update_hook_type16update_hook_type"></span><span id="nbla::Solver::check_inf_or_nan_grad__update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1a835339753ae3c17ee076ecfcddaf951e"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_inf_or_nan_grad</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver21check_inf_or_nan_gradE16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if there is any inf or nan on the gradients which were setup. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver10scale_gradEf16update_hook_type16update_hook_type">
<span id="_CPPv3N4nbla6Solver10scale_gradEf16update_hook_type16update_hook_type"></span><span id="_CPPv2N4nbla6Solver10scale_gradEf16update_hook_type16update_hook_type"></span><span id="nbla::Solver::scale_grad__float.update_hook_type.update_hook_type"></span><span class="target" id="classnbla_1_1Solver_1aa0523e376ef7fba9508f13fd396d7e8d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scale_grad</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pre_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla16update_hook_typeE" title="nbla::update_hook_type"><span class="n"><span class="pre">update_hook_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">post_callback</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver10scale_gradEf16update_hook_type16update_hook_type" title="Permalink to this definition"></a><br /></dt>
<dd><p>Scale gradients,then increase the loss scale. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver21allowed_array_classesEv">
<span id="_CPPv3N4nbla6Solver21allowed_array_classesEv"></span><span id="_CPPv2N4nbla6Solver21allowed_array_classesEv"></span><span id="nbla::Solver::allowed_array_classes"></span><span class="target" id="classnbla_1_1Solver_1abef31845976e4a7511f6f8c141d53f12"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allowed_array_classes</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4nbla6Solver21allowed_array_classesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get array classes that are allowed to be specified by <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Context"><span class="std std-ref">Context</span></a>. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver11SolverStateE">
<span id="_CPPv3N4nbla6Solver11SolverStateE"></span><span id="_CPPv2N4nbla6Solver11SolverStateE"></span><span id="nbla::Solver::SolverState"></span><span class="target" id="structnbla_1_1Solver_1_1SolverState"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SolverState</span></span></span><a class="headerlink" href="#_CPPv4N4nbla6Solver11SolverStateE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Struct for storing both parameter state <a class="reference internal" href="../namespace/nbla.html#classnbla_1_1Variable"><span class="std std-ref">Variable</span></a> and iteration. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver11SolverState6pstateE">
<span id="_CPPv3N4nbla6Solver11SolverState6pstateE"></span><span id="_CPPv2N4nbla6Solver11SolverState6pstateE"></span><span id="nbla::Solver::SolverState::pstate__unordered_map:string.VariablePtr:"></span><span class="target" id="structnbla_1_1Solver_1_1SolverState_1aef6aa7347f1efba6f5b5e50e328b2fba"></span><span class="n"><span class="pre">unordered_map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../namespace/nbla.html#_CPPv4N4nbla11VariablePtrE" title="nbla::VariablePtr"><span class="n"><span class="pre">VariablePtr</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pstate</span></span></span><a class="headerlink" href="#_CPPv4N4nbla6Solver11SolverState6pstateE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Parameter state maps. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4nbla6Solver11SolverState1tE">
<span id="_CPPv3N4nbla6Solver11SolverState1tE"></span><span id="_CPPv2N4nbla6Solver11SolverState1tE"></span><span id="nbla::Solver::SolverState::t__uint32_t"></span><span class="target" id="structnbla_1_1Solver_1_1SolverState_1a8216302df1ce6d0e57d2024542a9d981"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">t</span></span></span><a class="headerlink" href="#_CPPv4N4nbla6Solver11SolverState1tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Iteration as state. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="SoftSign.html" class="btn btn-neutral float-left" title="class SoftSign" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nbla--Sort.html" class="btn btn-neutral float-right" title="class nbla::Sort" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Sony Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>